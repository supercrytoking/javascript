!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PUBNUB=t():e.PUBNUB=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(){return"onLine"in navigator?navigator.onLine:null}function u(e){return!(!navigator||!navigator.sendBeacon)&&void navigator.sendBeacon(e)}Object.defineProperty(t,"__esModule",{value:!0});var c=n(1),l=r(c),h=n(36),f=r(h),p=(n(14),{get:function(e){return localStorage.getItem(e)},set:function(e,t){return localStorage.setItem(e,t)}}),d=function(e){function t(e){return i(this,t),e.db=p,e.navigatorOnlineCheck=a,e.sendBeacon=u,e.params={pnsdk:"PubNub-JS-Web/"+f["default"].version},s(this,Object.getPrototypeOf(t).call(this,e))}return o(t,e),t}(l["default"]);t["default"]=d,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),u=i(a),c=n(11),l=i(c),h=n(10),f=i(h),p=n(16),d=i(p),y=n(21),g=i(y),b=n(24),v=i(b),_=n(25),m=r(_),k=n(26),w=r(k),O=n(27),P=r(O),E=n(28),C=r(E),S=n(29),x=r(S),M=n(30),T=r(M),j=n(31),K=r(j),B=n(32),R=r(B),D=n(33),I=r(D),U=n(34),G=r(U),H=n(35),A=r(H),L=n(20),N=r(L),q=n(36),z=i(q),F=n(19),X=i(F),W=n(37),V=i(W),J=n(17),$=i(J),Q=(n(14),function(){function e(t){var n=this;s(this,e);var r=t.sendBeacon,i=t.db,o=new l["default"]({setup:t,db:i}),a=new f["default"]({config:o}),c=new u["default"]({config:o,crypto:a,sendBeacon:r}),h={config:o,networking:c,crypto:a},p=new $["default"]({networking:h.networking,config:h.config}),y=new X["default"]({networking:h.networking,config:h.config}),b=new V["default"]({config:h.config,networking:h.networking,crypto:h.crypto}),_=new g["default"],k=v["default"].bind(this,h,N),O=new d["default"]({config:h.config,listenerManager:_,subscribeEndpoints:p,presenceEndpoints:y,timeEndpoints:k});this.addListener=_.addListener.bind(_),this.removeListener=_.removeListener.bind(_),this.channelGroups={listGroups:v["default"].bind(this,h,C),listChannels:v["default"].bind(this,h,x),addChannels:v["default"].bind(this,h,m),removeChannels:v["default"].bind(this,h,w),deleteGroup:v["default"].bind(this,h,P)},this.push={addChannels:v["default"].bind(this,h,T),removeChannels:v["default"].bind(this,h,K),deleteDevice:v["default"].bind(this,h,I),listChannels:v["default"].bind(this,h,R)},this.hereNow=y.hereNow.bind(y),this.whereNow=y.whereNow.bind(y),this.getState=y.getState.bind(y),this.setState=O.adaptStateChange.bind(O),this.grant=b.grant.bind(b),this.audit=b.audit.bind(b),this.publish=v["default"].bind(this,h,G),this.fire=function(e,t){e.replicate=!1,e.storeInHistory=!1,n.publish(e,t)},this.history=v["default"].bind(this,h,A),this.time=k,this.subscribe=O.adaptSubscribeChange.bind(O),this.unsubscribe=O.adaptUnsubscribeChange.bind(O),this.reconnect=O.reconnect.bind(O),this.stop=O.disconnect.bind(O),this.getAuthKey=h.config.getAuthKey.bind(h.config),this.setAuthKey=h.config.setAuthKey.bind(h.config),this.setCipherKey=h.config.setCipherKey.bind(h.config),this.getUUID=h.config.getUUID.bind(h.config),this.setUUID=h.config.setUUID.bind(h.config),this.getFilterExpression=h.config.getFilterExpression.bind(h.config),this.setFilterExpression=h.config.setFilterExpression.bind(h.config)}return o(e,[{key:"getVersion",value:function(){return z["default"].version}}]),e}());t["default"]=Q,e.exports=t["default"]},function(e,t,n){(function(r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(4),u=i(a),c=n(10),l=(i(c),n(11)),h=(i(l),n(14),function(){function e(t){var n=t.config,r=t.crypto,i=t.sendBeacon;s(this,e),this._config=n,this._crypto=r,this._sendBeacon=i,this._maxSubDomain=20,this._currentSubDomain=Math.floor(Math.random()*this._maxSubDomain),this._providedFQDN=(this._config.secure?"https://":"http://")+this._config.origin,this._coreParams={},this.shiftStandardOrigin()}return o(e,[{key:"nextOrigin",value:function(){if(this._providedFQDN.indexOf("pubsub.")===-1)return this._providedFQDN;var e=void 0;return this._currentSubDomain=this._currentSubDomain+1,this._currentSubDomain>=this._maxSubDomain&&(this._currentSubDomain=1),e=this._currentSubDomain.toString(),this._providedFQDN.replace("pubsub","ps"+e)}},{key:"shiftStandardOrigin",value:function(){var e=!(arguments.length<=0||void 0===arguments[0])&&arguments[0];return this._standardOrigin=this.nextOrigin(e),this._standardOrigin}},{key:"getStandardOrigin",value:function(){return this._standardOrigin}},{key:"POST",value:function(e,t,n,r){var i=u["default"].post(this.getStandardOrigin()+n.url).query(e).send(t);return this._abstractedXDR(i,n,r)}},{key:"GET",value:function(e,t,n){var r=u["default"].get(this.getStandardOrigin()+t.url).query(e);return this._abstractedXDR(r,t,n)}},{key:"_abstractedXDR",value:function(e,t,n){var r=this;return this._config.logVerbosity&&(e=e.use(this._logger())),e.type("json").timeout(t.timeout||this._config.getTransactionTimeout()).end(function(e,i){var s={};if(s.error=null!==e,s.operation=t.operation,i&&i.status&&(s.statusCode=i.status),e)return s.errorData=e,s.category=r._detectErrorCategory(e),n(s,null);var o=JSON.parse(i.text);return n(s,o)})}},{key:"_detectErrorCategory",value:function(e){if("ENOTFOUND"===e.code)return"PNNetworkIssuesCategory";if(e.timeout)return"PNTimeoutCategory";if(e.response){if(e.response.badRequest)return"PNBadRequestCategory";if(e.response.forbidden)return"PNAccessDeniedCategory"}return"PNUnknownCategory"}},{key:"_logger",value:function(e){return e||(e={}),this._attachSuperagentLogger.bind(null,e)}},{key:"_attachSuperagentLogger",value:function(e,t){var n=(new Date).getTime(),i=(new Date).toISOString();r.log("<<<<<"),r.log("["+i+"]","\n",t.url,"\n",t.qs),r.log("-----"),t.on("response",function(e){var i=(new Date).getTime(),s=i-n,o=(new Date).toISOString();r.log(">>>>>>"),r.log("["+o+" / "+s+"]","\n",t.url,"\n",t.qs,"\n",e.text),r.log("-----")})}}]),e}());t["default"]=h,e.exports=t["default"]}).call(t,n(3))},function(e,t){},function(e,t,n){function r(){}function i(e){if(!v(e))return e;var t=[];for(var n in e)null!=e[n]&&s(t,n,e[n]);return t.join("&")}function s(e,t,n){if(Array.isArray(n))return n.forEach(function(n){s(e,t,n)});if(v(n))for(var r in n)s(e,t+"["+r+"]",n[r]);else e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}function o(e){for(var t,n,r={},i=e.split("&"),s=0,o=i.length;s<o;++s)t=i[s],n=t.indexOf("="),n==-1?r[decodeURIComponent(t)]="":r[decodeURIComponent(t.slice(0,n))]=decodeURIComponent(t.slice(n+1));return r}function a(e){var t,n,r,i,s=e.split(/\r?\n/),o={};s.pop();for(var a=0,u=s.length;a<u;++a)n=s[a],t=n.indexOf(":"),r=n.slice(0,t).toLowerCase(),i=m(n.slice(t+1)),o[r]=i;return o}function u(e){return/[\/+]json\b/.test(e)}function c(e){return e.split(/ *; */).shift()}function l(e){return g(e.split(/ *; */),function(e,t){var n=t.split(/ *= */),r=n.shift(),i=n.shift();return r&&i&&(e[r]=i),e},{})}function h(e,t){t=t||{},this.req=e,this.xhr=this.req.xhr,this.text="HEAD"!=this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||"undefined"==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this._setStatusProperties(this.xhr.status),this.header=this.headers=a(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this._setHeaderProperties(this.header),this.body="HEAD"!=this.req.method?this._parseBody(this.text?this.text:this.xhr.response):null}function f(e,t){var n=this;this._query=this._query||[],this.method=e,this.url=t,this.header={},this._header={},this.on("end",function(){var e=null,t=null;try{t=new h(n)}catch(r){return e=new Error("Parser is unable to parse the response"),e.parse=!0,e.original=r,e.rawResponse=n.xhr&&n.xhr.responseText?n.xhr.responseText:null,e.statusCode=n.xhr&&n.xhr.status?n.xhr.status:null,n.callback(e)}if(n.emit("response",t),e)return n.callback(e,t);try{if(t.status>=200&&t.status<300)return n.callback(e,t);var i=new Error(t.statusText||"Unsuccessful HTTP response");i.original=e,i.response=t,i.status=t.status,n.callback(i,t)}catch(r){n.callback(r)}})}function p(e,t){var n=_("DELETE",e);return t&&n.end(t),n}var d,y=n(5),g=n(6),b=n(7),v=n(8);d="undefined"!=typeof window?window:"undefined"!=typeof self?self:this;var _=e.exports=n(9).bind(null,f);_.getXHR=function(){if(!(!d.XMLHttpRequest||d.location&&"file:"==d.location.protocol&&d.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}return!1};var m="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};_.serializeObject=i,_.parseString=o,_.types={html:"text/html",json:"application/json",xml:"application/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"},_.serialize={"application/x-www-form-urlencoded":i,"application/json":JSON.stringify},_.parse={"application/x-www-form-urlencoded":o,"application/json":JSON.parse},h.prototype.get=function(e){return this.header[e.toLowerCase()]},h.prototype._setHeaderProperties=function(e){var t=this.header["content-type"]||"";this.type=c(t);var n=l(t);for(var r in n)this[r]=n[r]},h.prototype._parseBody=function(e){var t=_.parse[this.type];return!t&&u(this.type)&&(t=_.parse["application/json"]),t&&e&&(e.length||e instanceof Object)?t(e):null},h.prototype._setStatusProperties=function(e){1223===e&&(e=204);var t=e/100|0;this.status=this.statusCode=e,this.statusType=t,this.info=1==t,this.ok=2==t,this.clientError=4==t,this.serverError=5==t,this.error=(4==t||5==t)&&this.toError(),this.accepted=202==e,this.noContent=204==e,this.badRequest=400==e,this.unauthorized=401==e,this.notAcceptable=406==e,this.notFound=404==e,this.forbidden=403==e},h.prototype.toError=function(){var e=this.req,t=e.method,n=e.url,r="cannot "+t+" "+n+" ("+this.status+")",i=new Error(r);return i.status=this.status,i.method=t,i.url=n,i},_.Response=h,y(f.prototype);for(var k in b)f.prototype[k]=b[k];f.prototype.type=function(e){return this.set("Content-Type",_.types[e]||e),this},f.prototype.responseType=function(e){return this._responseType=e,this},f.prototype.accept=function(e){return this.set("Accept",_.types[e]||e),this},f.prototype.auth=function(e,t,n){switch(n||(n={type:"basic"}),n.type){case"basic":var r=btoa(e+":"+t);this.set("Authorization","Basic "+r);break;case"auto":this.username=e,this.password=t}return this},f.prototype.query=function(e){return"string"!=typeof e&&(e=i(e)),e&&this._query.push(e),this},f.prototype.attach=function(e,t,n){return this._getFormData().append(e,t,n||t.name),this},f.prototype._getFormData=function(){return this._formData||(this._formData=new d.FormData),this._formData},f.prototype.callback=function(e,t){var n=this._callback;this.clearTimeout(),n(e,t)},f.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=!0,e.status=this.status,e.method=this.method,e.url=this.url,this.callback(e)},f.prototype._timeoutError=function(){var e=this._timeout,t=new Error("timeout of "+e+"ms exceeded");t.timeout=e,this.callback(t)},f.prototype._appendQueryString=function(){var e=this._query.join("&");e&&(this.url+=~this.url.indexOf("?")?"&"+e:"?"+e)},f.prototype.end=function(e){var t=this,n=this.xhr=_.getXHR(),i=this._timeout,s=this._formData||this._data;this._callback=e||r,n.onreadystatechange=function(){if(4==n.readyState){var e;try{e=n.status}catch(r){e=0}if(0==e){if(t.timedout)return t._timeoutError();if(t._aborted)return;return t.crossDomainError()}t.emit("end")}};var o=function(e){e.total>0&&(e.percent=e.loaded/e.total*100),e.direction="download",t.emit("progress",e)};this.hasListeners("progress")&&(n.onprogress=o);try{n.upload&&this.hasListeners("progress")&&(n.upload.onprogress=o)}catch(a){}if(i&&!this._timer&&(this._timer=setTimeout(function(){t.timedout=!0,t.abort()},i)),this._appendQueryString(),this.username&&this.password?n.open(this.method,this.url,!0,this.username,this.password):n.open(this.method,this.url,!0),this._withCredentials&&(n.withCredentials=!0),"GET"!=this.method&&"HEAD"!=this.method&&"string"!=typeof s&&!this._isHost(s)){var c=this._header["content-type"],l=this._serializer||_.serialize[c?c.split(";")[0]:""];!l&&u(c)&&(l=_.serialize["application/json"]),l&&(s=l(s))}for(var h in this.header)null!=this.header[h]&&n.setRequestHeader(h,this.header[h]);return this._responseType&&(n.responseType=this._responseType),this.emit("request",this),n.send("undefined"!=typeof s?s:null),this},_.Request=f,_.get=function(e,t,n){var r=_("GET",e);return"function"==typeof t&&(n=t,t=null),t&&r.query(t),n&&r.end(n),r},_.head=function(e,t,n){var r=_("HEAD",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},_.options=function(e,t,n){var r=_("OPTIONS",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},_.del=p,_["delete"]=p,_.patch=function(e,t,n){var r=_("PATCH",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},_.post=function(e,t,n){var r=_("POST",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r},_.put=function(e,t,n){var r=_("PUT",e);return"function"==typeof t&&(n=t,t=null),t&&r.send(t),n&&r.end(n),r}},function(e,t,n){function r(e){if(e)return i(e)}function i(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if(r=n[i],r===t||r.fn===t){n.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t){e.exports=function(e,t,n){for(var r=0,i=e.length,s=3==arguments.length?n:e[r++];r<i;)s=t.call(null,s,e[r],++r,e);return s}},function(e,t,n){var r=n(8);t.clearTimeout=function(){return this._timeout=0,clearTimeout(this._timer),this},t.parse=function(e){return this._parser=e,this},t.serialize=function(e){return this._serializer=e,this},t.timeout=function(e){return this._timeout=e,this},t.then=function(e,t){if(!this._fullfilledPromise){var n=this;this._fullfilledPromise=new Promise(function(e,t){n.end(function(n,r){n?t(n):e(r)})})}return this._fullfilledPromise.then(e,t)},t.use=function(e){return e(this),this},t.get=function(e){return this._header[e.toLowerCase()]},t.getHeader=t.get,t.set=function(e,t){if(r(e)){for(var n in e)this.set(n,e[n]);return this}return this._header[e.toLowerCase()]=t,this.header[e]=t,this},t.unset=function(e){return delete this._header[e.toLowerCase()],delete this.header[e],this},t.field=function(e,t){return this._getFormData().append(e,t),this},t.abort=function(){return this._aborted?this:(this._aborted=!0,this.xhr&&this.xhr.abort(),this.req&&this.req.abort(),this.clearTimeout(),this.emit("abort"),this)},t.withCredentials=function(){return this._withCredentials=!0,this},t.redirects=function(e){return this._maxRedirects=e,this},t.toJSON=function(){return{method:this.method,url:this.url,data:this._data}},t._isHost=function(e){var t={}.toString.call(e);switch(t){case"[object File]":case"[object Blob]":case"[object FormData]":return!0;default:return!1}},t.send=function(e){var t=r(e),n=this._header["content-type"];if(t&&r(this._data))for(var i in e)this._data[i]=e[i];else"string"==typeof e?(n||this.type("form"),n=this._header["content-type"],"application/x-www-form-urlencoded"==n?this._data=this._data?this._data+"&"+e:e:this._data=(this._data||"")+e):this._data=e;return!t||this._isHost(e)?this:(n||this.type("json"),this)}},function(e,t){function n(e){return null!==e&&"object"==typeof e}e.exports=n},function(e,t){function n(e,t,n){return"function"==typeof n?new e("GET",t).end(n):2==arguments.length?new e("GET",t):new e(t,n)}e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(11),a=(r(o),n(15)),u=r(a),c=function(){function e(t){var n=t.config;i(this,e),this._config=n,this._iv="0123456789012345",this._allowedKeyEncodings=["hex","utf8","base64","binary"],this._allowedKeyLengths=[128,256],this._allowedModes=["ecb","cbc"],this._defaultOptions={encryptKey:!0,keyEncoding:"utf8",keyLength:256,mode:"cbc"}}return s(e,[{key:"HMACSHA256",value:function(e){var t=u["default"].HmacSHA256(e,this._config.secretKey);return t.toString(u["default"].enc.Base64)}},{key:"SHA256",value:function(e){return u["default"].SHA256(e).toString(u["default"].enc.Hex)}},{key:"_parseOptions",value:function(e){var t=e||{};return t.hasOwnProperty("encryptKey")||(t.encryptKey=this._defaultOptions.encryptKey),t.hasOwnProperty("keyEncoding")||(t.keyEncoding=this._defaultOptions.keyEncoding),t.hasOwnProperty("keyLength")||(t.keyLength=this._defaultOptions.keyLength),t.hasOwnProperty("mode")||(t.mode=this._defaultOptions.mode),this._allowedKeyEncodings.indexOf(t.keyEncoding.toLowerCase())===-1&&(t.keyEncoding=this._defaultOptions.keyEncoding),this._allowedKeyLengths.indexOf(parseInt(t.keyLength,10))===-1&&(t.keyLength=this._defaultOptions.keyLength),this._allowedModes.indexOf(t.mode.toLowerCase())===-1&&(t.mode=this._defaultOptions.mode),t}},{key:"_decodeKey",value:function(e,t){return"base64"===t.keyEncoding?u["default"].enc.Base64.parse(e):"hex"===t.keyEncoding?u["default"].enc.Hex.parse(e):e}},{key:"_getPaddedKey",value:function(e,t){return e=this._decodeKey(e,t),t.encryptKey?u["default"].enc.Utf8.parse(this.SHA256(e).slice(0,32)):e}},{key:"_getMode",value:function(e){return"ecb"===e.mode?u["default"].mode.ECB:u["default"].mode.CBC}},{key:"_getIV",value:function(e){return"cbc"===e.mode?u["default"].enc.Utf8.parse(this._iv):null}},{key:"encrypt",value:function(e,t){if(!this._config.cipherKey)return e;t=this._parseOptions(t);var n=this._getIV(t),r=this._getMode(t),i=this._getPaddedKey(this._config.cipherKey,t),s=u["default"].AES.encrypt(e,i,{iv:n,mode:r}).ciphertext,o=s.toString(u["default"].enc.Base64);return o||e}},{key:"decrypt",value:function(e,t){if(!this._config.cipherKey)return e;t=this._parseOptions(t);var n=this._getIV(t),r=this._getMode(t),i=this._getPaddedKey(this._config.cipherKey,t);try{var s=u["default"].enc.Base64.parse(e),o=u["default"].AES.decrypt({ciphertext:s},i,{iv:n,mode:r}).toString(u["default"].enc.Utf8),a=JSON.parse(o);return a}catch(c){return null}}}]),e}();t["default"]=c,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(12),a=r(o),u=(n(14),function(){function e(t){var n=t.setup,r=t.db;i(this,e),this._db=r,this.instanceId=a["default"].v4(),this.secretKey=n.secretKey,this.subscribeKey=n.subscribeKey,this.publishKey=n.publishKey,this.setAuthKey(n.authKey),this.setCipherKey(n.cipherKey),this.baseParams=n.params||{},this.setFilterExpression(n.filterExpression),this.origin=n.origin||"pubsub.pubnub.com",this.secure=n.ssl||!1,"undefined"!=typeof location&&"https:"===location.protocol&&(this.secure=!0),this.logVerbosity=n.logVerbosity||!1,this.suppressLeaveEvents=n.suppressLeaveEvents||!1,this.announceFailedHeartbeats=n.announceFailedHeartbeats||!0,this.announceSuccessfulHeartbeats=n.announceSuccessfulHeartbeats||!1,this.useInstanceId=n.useInstanceId||!1,this.useRequestId=n.useRequestId||!1,this.setTransactionTimeout(n.transactionalRequestTimeout||15e3),this.setSubscribeTimeout(n.subscribeRequestTimeout||31e4),this.setSendBeaconConfig(n.useSendBeacon||!0),this.setPresenceTimeout(n.presenceTimeout||300),n.heartbeatInterval&&this.setHeartbeatInterval(n.heartbeatInterval),this.setUUID(this._decideUUID(n.uuid))}return s(e,[{key:"getAuthKey",value:function(){return this.authKey}},{key:"setAuthKey",value:function(e){return this.authKey=e,this}},{key:"setCipherKey",value:function(e){return this.cipherKey=e,this}},{key:"getUUID",value:function(){return this.UUID}},{key:"setUUID",value:function(e){return this._db&&this._db.set&&this._db.set(this.subscribeKey+"uuid",e),this.UUID=e,this}},{key:"getFilterExpression",value:function(){return this.filterExpression}},{key:"setFilterExpression",value:function(e){return this.filterExpression=e,this}},{key:"getPresenceTimeout",value:function(){return this._presenceTimeout}},{key:"setPresenceTimeout",value:function(e){return this._presenceTimeout=e,this.setHeartbeatInterval(this._presenceTimeout/2-1),this}},{key:"getHeartbeatInterval",value:function(){return this._heartbeatInterval}},{key:"setHeartbeatInterval",value:function(e){return this._heartbeatInterval=e,this}},{key:"getSubscribeTimeout",value:function(){return this._subscribeRequestTimeout}},{key:"setSubscribeTimeout",value:function(e){return this._subscribeRequestTimeout=e,this}},{key:"getTransactionTimeout",value:function(){return this._transactionalRequestTimeout}},{key:"setTransactionTimeout",value:function(e){return this._transactionalRequestTimeout=e,this}},{key:"isSendBeaconEnabled",value:function(){return this._useSendBeacon}},{key:"setSendBeaconConfig",value:function(e){return this._useSendBeacon=e,this}},{key:"_decideUUID",value:function(e){return e?e:this._db&&this._db.get&&this._db.get(this.subscribeKey+"uuid")?this._db.get(this.subscribeKey+"uuid"):a["default"].v4()}}]),e}());t["default"]=u,e.exports=t["default"]},function(e,t,n){function r(e,t,n){var r=t&&n||0,i=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){i<16&&(t[r+i++]=c[e])});i<16;)t[r+i++]=0;return t}function i(e,t){var n=t||0,r=u;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}function s(e,t,n){var r=t&&n||0,s=t||[];e=e||{};var o=void 0!==e.clockseq?e.clockseq:p,a=void 0!==e.msecs?e.msecs:(new Date).getTime(),u=void 0!==e.nsecs?e.nsecs:y+1,c=a-d+(u-y)/1e4;if(c<0&&void 0===e.clockseq&&(o=o+1&16383),(c<0||a>d)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");d=a,y=u,p=o,a+=122192928e5;var l=(1e4*(268435455&a)+u)%4294967296;s[r++]=l>>>24&255,s[r++]=l>>>16&255,s[r++]=l>>>8&255,s[r++]=255&l;var h=a/4294967296*1e4&268435455;s[r++]=h>>>8&255,s[r++]=255&h,s[r++]=h>>>24&15|16,s[r++]=h>>>16&255,s[r++]=o>>>8|128,s[r++]=255&o;for(var g=e.node||f,b=0;b<6;b++)s[r+b]=g[b];return t?t:i(s)}function o(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"==e?new Array(16):null,e=null),e=e||{};var s=e.random||(e.rng||a)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var o=0;o<16;o++)t[r+o]=s[o];return t||i(s)}for(var a=n(13),u=[],c={},l=0;l<256;l++)u[l]=(l+256).toString(16).substr(1),c[u[l]]=l;var h=a(),f=[1|h[0],h[1],h[2],h[3],h[4],h[5]],p=16383&(h[6]<<8|h[7]),d=0,y=0,g=o;g.v1=s,g.v4=o,g.parse=r,g.unparse=i,e.exports=g},function(e,t){(function(t){var n;if(t.crypto&&crypto.getRandomValues){var r=new Uint8Array(16);n=function(){return crypto.getRandomValues(r),r}}if(!n){var i=new Array(16);n=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}e.exports=n}).call(t,function(){return this}())},function(e,t){"use strict";e.exports={}},function(e,t){"use strict";var n=n||function(e,t){var n={},r=n.lib={},i=function(){},s=r.Base={extend:function(e){i.prototype=this;var t=new i;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=s.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-8*(i%4)&255)<<24-8*((r+i)%4);else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4),t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new o.init(n,t)}}),a=n.enc={},u=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-8*(r%4)&255;n.push((i>>>4).toString(16)),n.push((15&i).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-4*(r%8);return new o.init(n,t/2)}},c=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-8*(r%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-8*(r%4);return new o.init(n,t)}},l=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},h=r.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,s=this.blockSize,a=i/(4*s),a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0);if(t=a*s,i=e.min(4*t,i),t){for(var u=0;u<t;u+=s)this._doProcessBlock(r,u);u=r.splice(0,t),n.sigBytes-=i}return new o.init(u,i)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=h.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}});var f=n.algo={};return n}(Math);!function(e){for(var t=n,r=t.lib,i=r.WordArray,s=r.Hasher,r=t.algo,o=[],a=[],u=function(e){return 4294967296*(e-(0|e))|0},c=2,l=0;64>l;){var h;e:{h=c;for(var f=e.sqrt(h),p=2;p<=f;p++)if(!(h%p)){h=!1;break e}h=!0}h&&(8>l&&(o[l]=u(e.pow(c,.5))),a[l]=u(e.pow(c,1/3)),l++),c++}var d=[],r=r.SHA256=s.extend({_doReset:function(){this._hash=new i.init(o.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],o=n[3],u=n[4],c=n[5],l=n[6],h=n[7],f=0;64>f;f++){if(16>f)d[f]=0|e[t+f];else{var p=d[f-15],y=d[f-2];d[f]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+d[f-7]+((y<<15|y>>>17)^(y<<13|y>>>19)^y>>>10)+d[f-16]}p=h+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&l)+a[f]+d[f],y=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&s^i&s),h=l,l=c,c=u,u=o+p|0,o=s,s=i,i=r,r=p+y|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+u|0,n[5]=n[5]+c|0,n[6]=n[6]+l|0,n[7]=n[7]+h|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;return n[i>>>5]|=128<<24-i%32,n[(i+64>>>9<<4)+14]=e.floor(r/4294967296),n[(i+64>>>9<<4)+15]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=s._createHelper(r),t.HmacSHA256=s._createHmacHelper(r)}(Math),function(){var e=n,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,n){e=this._hasher=new e.init,"string"==typeof n&&(n=t.parse(n));var r=e.blockSize,i=4*r;n.sigBytes>i&&(n=e.finalize(n)),n.clamp();for(var s=this._oKey=n.clone(),o=this._iKey=n.clone(),a=s.words,u=o.words,c=0;c<r;c++)a[c]^=1549556828,u[c]^=909522486;s.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=n,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp(),e=[];for(var i=0;i<n;i+=3)for(var s=(t[i>>>2]>>>24-8*(i%4)&255)<<16|(t[i+1>>>2]>>>24-8*((i+1)%4)&255)<<8|t[i+2>>>2]>>>24-8*((i+2)%4)&255,o=0;4>o&&i+.75*o<n;o++)e.push(r.charAt(s>>>6*(3-o)&63));if(t=r.charAt(64))for(;e.length%4;)e.push(t);return e.join("");
},parse:function(e){var n=e.length,r=this._map,i=r.charAt(64);i&&(i=e.indexOf(i),-1!=i&&(n=i));for(var i=[],s=0,o=0;o<n;o++)if(o%4){var a=r.indexOf(e.charAt(o-1))<<2*(o%4),u=r.indexOf(e.charAt(o))>>>6-2*(o%4);i[s>>>2]|=(a|u)<<24-8*(s%4),s++}return t.create(i,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,n,r,i,s,o){return e=e+(t&n|~t&r)+i+o,(e<<s|e>>>32-s)+t}function r(e,t,n,r,i,s,o){return e=e+(t&r|n&~r)+i+o,(e<<s|e>>>32-s)+t}function i(e,t,n,r,i,s,o){return e=e+(t^n^r)+i+o,(e<<s|e>>>32-s)+t}function s(e,t,n,r,i,s,o){return e=e+(n^(t|~r))+i+o,(e<<s|e>>>32-s)+t}for(var o=n,a=o.lib,u=a.WordArray,c=a.Hasher,a=o.algo,l=[],h=0;64>h;h++)l[h]=4294967296*e.abs(e.sin(h+1))|0;a=a.MD5=c.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,n){for(var o=0;16>o;o++){var a=n+o,u=e[a];e[a]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}var o=this._hash.words,a=e[n+0],u=e[n+1],c=e[n+2],h=e[n+3],f=e[n+4],p=e[n+5],d=e[n+6],y=e[n+7],g=e[n+8],b=e[n+9],v=e[n+10],_=e[n+11],m=e[n+12],k=e[n+13],w=e[n+14],O=e[n+15],P=o[0],E=o[1],C=o[2],S=o[3],P=t(P,E,C,S,a,7,l[0]),S=t(S,P,E,C,u,12,l[1]),C=t(C,S,P,E,c,17,l[2]),E=t(E,C,S,P,h,22,l[3]),P=t(P,E,C,S,f,7,l[4]),S=t(S,P,E,C,p,12,l[5]),C=t(C,S,P,E,d,17,l[6]),E=t(E,C,S,P,y,22,l[7]),P=t(P,E,C,S,g,7,l[8]),S=t(S,P,E,C,b,12,l[9]),C=t(C,S,P,E,v,17,l[10]),E=t(E,C,S,P,_,22,l[11]),P=t(P,E,C,S,m,7,l[12]),S=t(S,P,E,C,k,12,l[13]),C=t(C,S,P,E,w,17,l[14]),E=t(E,C,S,P,O,22,l[15]),P=r(P,E,C,S,u,5,l[16]),S=r(S,P,E,C,d,9,l[17]),C=r(C,S,P,E,_,14,l[18]),E=r(E,C,S,P,a,20,l[19]),P=r(P,E,C,S,p,5,l[20]),S=r(S,P,E,C,v,9,l[21]),C=r(C,S,P,E,O,14,l[22]),E=r(E,C,S,P,f,20,l[23]),P=r(P,E,C,S,b,5,l[24]),S=r(S,P,E,C,w,9,l[25]),C=r(C,S,P,E,h,14,l[26]),E=r(E,C,S,P,g,20,l[27]),P=r(P,E,C,S,k,5,l[28]),S=r(S,P,E,C,c,9,l[29]),C=r(C,S,P,E,y,14,l[30]),E=r(E,C,S,P,m,20,l[31]),P=i(P,E,C,S,p,4,l[32]),S=i(S,P,E,C,g,11,l[33]),C=i(C,S,P,E,_,16,l[34]),E=i(E,C,S,P,w,23,l[35]),P=i(P,E,C,S,u,4,l[36]),S=i(S,P,E,C,f,11,l[37]),C=i(C,S,P,E,y,16,l[38]),E=i(E,C,S,P,v,23,l[39]),P=i(P,E,C,S,k,4,l[40]),S=i(S,P,E,C,a,11,l[41]),C=i(C,S,P,E,h,16,l[42]),E=i(E,C,S,P,d,23,l[43]),P=i(P,E,C,S,b,4,l[44]),S=i(S,P,E,C,m,11,l[45]),C=i(C,S,P,E,O,16,l[46]),E=i(E,C,S,P,c,23,l[47]),P=s(P,E,C,S,a,6,l[48]),S=s(S,P,E,C,y,10,l[49]),C=s(C,S,P,E,w,15,l[50]),E=s(E,C,S,P,p,21,l[51]),P=s(P,E,C,S,m,6,l[52]),S=s(S,P,E,C,h,10,l[53]),C=s(C,S,P,E,v,15,l[54]),E=s(E,C,S,P,u,21,l[55]),P=s(P,E,C,S,g,6,l[56]),S=s(S,P,E,C,O,10,l[57]),C=s(C,S,P,E,d,15,l[58]),E=s(E,C,S,P,k,21,l[59]),P=s(P,E,C,S,f,6,l[60]),S=s(S,P,E,C,_,10,l[61]),C=s(C,S,P,E,c,15,l[62]),E=s(E,C,S,P,b,21,l[63]);o[0]=o[0]+P|0,o[1]=o[1]+E|0,o[2]=o[2]+C|0,o[3]=o[3]+S|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,i=8*t.sigBytes;n[i>>>5]|=128<<24-i%32;var s=e.floor(r/4294967296);for(n[(i+64>>>9<<4)+15]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),n[(i+64>>>9<<4)+14]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process(),t=this._hash,n=t.words,r=0;4>r;r++)i=n[r],n[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return t},clone:function(){var e=c.clone.call(this);return e._hash=this._hash.clone(),e}}),o.MD5=c._createHelper(a),o.HmacMD5=c._createHmacHelper(a)}(Math),function(){var e=n,t=e.lib,r=t.Base,i=t.WordArray,t=e.algo,s=t.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,r=n.hasher.create(),s=i.create(),o=s.words,a=n.keySize,n=n.iterations;o.length<a;){u&&r.update(u);var u=r.update(e).finalize(t);r.reset();for(var c=1;c<n;c++)u=r.finalize(u),r.reset();s.concat(u)}return s.sigBytes=4*a,s}});e.EvpKDF=function(e,t,n){return s.create(n).compute(e,t)}}(),n.lib.Cipher||function(e){var t=n,r=t.lib,i=r.Base,s=r.WordArray,o=r.BufferedBlockAlgorithm,a=t.enc.Base64,u=t.algo.EvpKDF,c=r.Cipher=o.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,n,r){return("string"==typeof n?y:d).encrypt(e,t,n,r)},decrypt:function(t,n,r){return("string"==typeof n?y:d).decrypt(e,t,n,r)}}}});r.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var l=t.mode={},h=function(t,n,r){var i=this._iv;i?this._iv=e:i=this._prevBlock;for(var s=0;s<r;s++)t[n+s]^=i[s]},f=(r.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();f.Encryptor=f.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize;h.call(this,e,t,r),n.encryptBlock(e,t),this._prevBlock=e.slice(t,t+r)}}),f.Decryptor=f.extend({processBlock:function(e,t){var n=this._cipher,r=n.blockSize,i=e.slice(t,t+r);n.decryptBlock(e,t),h.call(this,e,t,r),this._prevBlock=i}}),l=l.CBC=f,f=(t.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,n=n-e.sigBytes%n,r=n<<24|n<<16|n<<8|n,i=[],o=0;o<n;o+=4)i.push(r);n=s.create(i,n),e.concat(n)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},r.BlockCipher=c.extend({cfg:c.cfg.extend({mode:l,padding:f}),reset:function(){c.reset.call(this);var e=this.cfg,t=e.iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=e.createEncryptor;else n=e.createDecryptor,this._minBufferSize=1;this._mode=n.call(e,this,t&&t.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var p=r.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),l=(t.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return e=e.salt,(e?s.create([1398893684,1701076831]).concat(e).concat(t):t).toString(a)},parse:function(e){e=a.parse(e);var t=e.words;if(1398893684==t[0]&&1701076831==t[1]){var n=s.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return p.create({ciphertext:e,salt:n})}},d=r.SerializableCipher=i.extend({cfg:i.extend({format:l}),encrypt:function(e,t,n,r){r=this.cfg.extend(r);var i=e.createEncryptor(n,r);return t=i.finalize(t),i=i.cfg,p.create({ciphertext:t,key:n,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),e.createDecryptor(n,r).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),t=(t.kdf={}).OpenSSL={execute:function(e,t,n,r){return r||(r=s.random(8)),e=u.create({keySize:t+n}).compute(e,r),n=s.create(e.words.slice(t),4*n),e.sigBytes=4*t,p.create({key:e,iv:n,salt:r})}},y=r.PasswordBasedCipher=d.extend({cfg:d.cfg.extend({kdf:t}),encrypt:function(e,t,n,r){return r=this.cfg.extend(r),n=r.kdf.execute(n,e.keySize,e.ivSize),r.iv=n.iv,e=d.encrypt.call(this,e,t,n.key,r),e.mixIn(n),e},decrypt:function(e,t,n,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n=r.kdf.execute(n,e.keySize,e.ivSize,t.salt),r.iv=n.iv,d.decrypt.call(this,e,t,n.key,r)}})}(),function(){for(var e=n,t=e.lib.BlockCipher,r=e.algo,i=[],s=[],o=[],a=[],u=[],c=[],l=[],h=[],f=[],p=[],d=[],y=0;256>y;y++)d[y]=128>y?y<<1:y<<1^283;for(var g=0,b=0,y=0;256>y;y++){var v=b^b<<1^b<<2^b<<3^b<<4,v=v>>>8^255&v^99;i[g]=v,s[v]=g;var _=d[g],m=d[_],k=d[m],w=257*d[v]^16843008*v;o[g]=w<<24|w>>>8,a[g]=w<<16|w>>>16,u[g]=w<<8|w>>>24,c[g]=w,w=16843009*k^65537*m^257*_^16843008*g,l[v]=w<<24|w>>>8,h[v]=w<<16|w>>>16,f[v]=w<<8|w>>>24,p[v]=w,g?(g=_^d[d[d[k^_]]],b^=d[d[b]]):g=b=1}var O=[0,1,2,4,8,16,32,64,128,27,54],r=r.AES=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes/4,e=4*((this._nRounds=n+6)+1),r=this._keySchedule=[],s=0;s<e;s++)if(s<n)r[s]=t[s];else{var o=r[s-1];s%n?6<n&&4==s%n&&(o=i[o>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o]):(o=o<<8|o>>>24,o=i[o>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o],o^=O[s/n|0]<<24),r[s]=r[s-n]^o}for(t=this._invKeySchedule=[],n=0;n<e;n++)s=e-n,o=n%4?r[s]:r[s-4],t[n]=4>n||4>=s?o:l[i[o>>>24]]^h[i[o>>>16&255]]^f[i[o>>>8&255]]^p[i[255&o]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,o,a,u,c,i)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,l,h,f,p,s),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,r,i,s,o,a){for(var u=this._nRounds,c=e[t]^n[0],l=e[t+1]^n[1],h=e[t+2]^n[2],f=e[t+3]^n[3],p=4,d=1;d<u;d++)var y=r[c>>>24]^i[l>>>16&255]^s[h>>>8&255]^o[255&f]^n[p++],g=r[l>>>24]^i[h>>>16&255]^s[f>>>8&255]^o[255&c]^n[p++],b=r[h>>>24]^i[f>>>16&255]^s[c>>>8&255]^o[255&l]^n[p++],f=r[f>>>24]^i[c>>>16&255]^s[l>>>8&255]^o[255&h]^n[p++],c=y,l=g,h=b;y=(a[c>>>24]<<24|a[l>>>16&255]<<16|a[h>>>8&255]<<8|a[255&f])^n[p++],g=(a[l>>>24]<<24|a[h>>>16&255]<<16|a[f>>>8&255]<<8|a[255&c])^n[p++],b=(a[h>>>24]<<24|a[f>>>16&255]<<16|a[c>>>8&255]<<8|a[255&l])^n[p++],f=(a[f>>>24]<<24|a[c>>>16&255]<<16|a[l>>>8&255]<<8|a[255&h])^n[p++],e[t]=y,e[t+1]=g,e[t+2]=b,e[t+3]=f},keySize:8});e.AES=t._createHelper(r)}(),n.mode.ECB=function(){var e=n.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),e.Decryptor=e.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),e}(),e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(17),a=(r(o),n(19)),u=(r(a),n(20)),c=(r(u),n(10)),l=(r(c),n(11)),h=(r(l),n(21)),f=(r(h),n(22)),p=r(f),d=n(23),y=r(d),g=(n(14),function(){function e(t){var n=this,r=t.subscribeEndpoints,s=t.presenceEndpoints,o=t.timeEndpoints,a=t.config,u=t.crypto,c=t.listenerManager;i(this,e),this._listenerManager=c,this._config=a,this._subscribeEndpoints=r,this._presenceEndpoints=s,this._timeEndpoints=o,this._crypto=u,this._channels={},this._presenceChannels={},this._channelGroups={},this._presenceChannelGroups={},this._timetoken=0,this._subscriptionStatusAnnounced=!1,this._reconnectionManager=new p["default"]({timeEndpoints:o}),this._reconnectionManager.onReconnection(function(){n.reconnect();var e={};e.category="PNReconnectedCategory",n._subscriptionStatusAnnounced=!0,n._listenerManager.announceStatus(status)})}return s(e,[{key:"adaptStateChange",value:function(e,t){var n=this,r=e.state,i=e.channels,s=void 0===i?[]:i,o=e.channelGroups,a=void 0===o?[]:o;s.forEach(function(e){e in n._channels&&(n._channels[e].state=r)}),a.forEach(function(e){e in n._channelGroups&&(n._channelGroups[e].state=r)}),this._presenceEndpoints.setState({state:r,channels:s,channelGroups:a},t)}},{key:"adaptSubscribeChange",value:function(e){var t=this,n=e.timetoken,r=e.channels,i=void 0===r?[]:r,s=e.channelGroups,o=void 0===s?[]:s,a=e.withPresence,u=void 0!==a&&a;n&&(this._timetoken=n),i.forEach(function(e){t._channels[e]={state:{}},u&&(t._presenceChannels[e]={})}),o.forEach(function(e){t._channelGroups[e]={state:{}},u&&(t._presenceChannelGroups[e]={})}),this._subscriptionStatusAnnounced=!1,this.reconnect()}},{key:"adaptUnsubscribeChange",value:function(e){var t=this,n=e.channels,r=void 0===n?[]:n,i=e.channelGroups,s=void 0===i?[]:i;r.forEach(function(e){e in t._channels&&delete t._channels[e],e in t._presenceChannels&&delete t._presenceChannels[e]}),s.forEach(function(e){e in t._channelGroups&&delete t._channelGroups[e],e in t._presenceChannelGroups&&delete t._channelGroups[e]}),this._config.suppressLeaveEvents===!1&&this._presenceEndpoints.leave({channels:r,channelGroups:s},function(e){t._listenerManager.announceStatus(e)}),this.reconnect()}},{key:"reconnect",value:function(){this._startSubscribeLoop(),this._registerHeartbeatTimer()}},{key:"disconnect",value:function(){this._stopSubscribeLoop(),this._stopHeartbeatTimer()}},{key:"_registerHeartbeatTimer",value:function(){this._stopHeartbeatTimer(),this._performHeartbeatLoop(),this._heartbeatTimer=setInterval(this._performHeartbeatLoop.bind(this),1e3*this._config.getHeartbeatInterval())}},{key:"_stopHeartbeatTimer",value:function(){this._heartbeatTimer&&(clearInterval(this._heartbeatTimer),this._heartbeatTimer=null)}},{key:"_performHeartbeatLoop",value:function(){var e=this,t=Object.keys(this._channels),n=Object.keys(this._channelGroups),r={};if(0!==t.length||0!==n.length){t.forEach(function(t){var n=e._channels[t].state;Object.keys(n).length&&(r[t]=n)}),n.forEach(function(t){var n=e._channelGroups[t].state;Object.keys(n).length&&(r[t]=n)});var i=function(t){t.error&&e._config.announceFailedHeartbeats&&e._listenerManager.announceStatus(t),!t.error&&e._config.announceSuccessfulHeartbeats&&e._listenerManager.announceStatus(t)};this._presenceEndpoints.heartbeat({channels:t,channelGroups:n,state:r},i.bind(this))}}},{key:"_startSubscribeLoop",value:function(){this._stopSubscribeLoop();var e=[],t=[];if(Object.keys(this._channels).forEach(function(t){return e.push(t)}),Object.keys(this._presenceChannels).forEach(function(t){return e.push(t+"-pnpres")}),Object.keys(this._channelGroups).forEach(function(e){return t.push(e)}),Object.keys(this._presenceChannelGroups).forEach(function(e){return t.push(e+"-pnpres")}),0!==e.length||0!==t.length){var n={channels:e,channelGroups:t,timetoken:this._timetoken,filterExpression:this._config.filterExpression,region:this._region};this._subscribeCall=this._subscribeEndpoints.subscribe(n,this._processSubscribeResponse.bind(this))}}},{key:"_processSubscribeResponse",value:function(e,t){var n=this;if(e.error)return"PNTimeoutCategory"===e.category&&this._startSubscribeLoop(),void("PNNetworkIssuesCategory"===e.category&&(this.disconnect(),this._reconnectionManager.startPolling()));if(!this._subscriptionStatusAnnounced){var r={};r.category="PNConnectedCategory",r.operation=e.operation,this._subscriptionStatusAnnounced=!0,this._listenerManager.announceStatus(r)}t.messages.forEach(function(e){var t=e.channel,r=e.subscriptionMatch,i=e.publishMetaData;if(t===r&&(r=null),y["default"].endsWith(e.channel,"-pnpres")){var s={};s.actualChannel=null!=r?t:null,s.subscribedChannel=null!=r?r:t,s.timetoken=i.publishTimetoken,s.occupancy=e.payload.occupancy,s.uuid=e.payload.uuid,s.timestamp=e.payload.timestamp,n._listenerManager.announcePresence(s)}else{var o={};o.actualChannel=null!=r?t:null,o.subscribedChannel=null!=r?r:t,o.timetoken=i.publishTimetoken,n._config.cipherKey?o.message=n._crypto.decrypt(e.payload):o.message=e.payload,n._listenerManager.announceMessage(o)}}),this._region=t.metadata.region,this._timetoken=t.metadata.timetoken,this._startSubscribeLoop()}},{key:"_stopSubscribeLoop",value:function(){this._subscribeCall&&(this._subscribeCall.abort(),this._subscribeCall=null)}}]),e}());t["default"]=g,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(2),c=(r(u),n(11)),l=(r(c),n(18)),h=r(l),f=(n(14),function(e){function t(e){var n=e.networking,r=e.config;i(this,t);var o=s(this,Object.getPrototypeOf(t).call(this,{config:r}));return o._networking=n,o._config=r,o}return o(t,e),a(t,[{key:"subscribe",value:function(e,t){var n=e.channels,r=void 0===n?[]:n,i=e.channelGroups,s=void 0===i?[]:i,o=e.timetoken,a=e.filterExpression,u=e.region,c=r.length>0?r.join(","):",",l={params:{authKey:{required:!1},subscribeKey:{required:!0}},timeout:this._config.getSubscribeTimeout(),url:"/v2/subscribe/"+this._config.subscribeKey+"/"+encodeURIComponent(c)+"/0",operation:"PNSubscribeOperation"};if(this.validateEndpointConfig(l)){var h=this.createBaseParams(l);return s.length>0&&(h["channel-group"]=encodeURIComponent(s.join(","))),a&&a.length>0&&(h["filter-expr"]=encodeURIComponent(a)),o&&(h.tt=o),u&&(h.tr=u),this._networking.GET(h,l,function(e,n){if(e.error)return t(e);var r=[];n.m.forEach(function(e){var t={publishTimetoken:e.p.t,region:e.p.r},n={shard:parseInt(e.a,10),subscriptionMatch:e.b,channel:e.c,payload:e.d,flags:e.f,issuingClientId:e.i,subscribeKey:e.k,originationTimetoken:e.o,publishMetaData:t};r.push(n)});var i={timetoken:n.t.t,region:n.t.r},s={messages:r,metadata:i};t(e,s)})}}}]),t}(h["default"]));t["default"]=f,e.exports=t["default"]},function(e,t,n){(function(r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(2),u=(i(a),n(11)),c=(i(u),n(14),n(12)),l=i(c),h=function(){function e(t){var n=t.config;s(this,e),this._config=n}return o(e,[{key:"validateEndpointConfig",value:function(e){return!!e}},{key:"createBaseParams",value:function(e){var t=this,n={uuid:this._config.UUID};return Object.keys(this._config.baseParams).forEach(function(e){var r=t._config.baseParams[e];e in n||(n[e]=r)}),this._config.useInstanceId&&(n.instanceid=this._config.instanceId),this._config.useRequestId&&(n.requestid=l["default"].v4()),e.params&&e.params.authKey&&this._config.authKey&&(n.auth=this._config.authKey),n}},{key:"createValidationError",value:function(e){return this._createError({message:e},"validationError")}},{key:"_createError",value:function(e,t){return e.type=t,e}},{key:"log",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];r.log.apply(r,t)}}]),e}();t["default"]=h,e.exports=t["default"]}).call(t,n(3))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(2),c=(r(u),n(11)),l=(r(c),n(18)),h=r(l),f=(n(14),function(e){function t(e){var n=e.networking,r=e.config;i(this,t);var o=s(this,Object.getPrototypeOf(t).call(this,{config:r}));return o.networking=n,o.config=r,o}return o(t,e),a(t,[{key:"whereNow",value:function(e,t){var n=e.uuid,r=void 0===n?this.config.UUID:n,i={params:{authKey:{required:!1}},url:"/v2/presence/sub-key/"+this.config.subscribeKey+"/uuid/"+r,operation:"PNWhereNowOperation"};if(!t)return this.log("Missing Callback");if(this.validateEndpointConfig(i)){var s=this.createBaseParams(i);this.networking.GET(s,i,function(e,n){if(e.error)return t(e);var r={channels:n.payload.channels};t(e,r)})}}},{key:"getState",value:function(e,t){var n=e.uuid,r=void 0===n?this.config.UUID:n,i=e.channels,s=void 0===i?[]:i,o=e.channelGroups,a=void 0===o?[]:o,u=s.length>0?s.join(","):",",c={params:{authKey:{required:!1}},url:"/v2/presence/sub-key/"+this.config.subscribeKey+"/channel/"+u+"/uuid/"+r,operation:"PNGetStateOperation"};if(!t)return this.log("Missing Callback");if(0===s.length&&0===a.length)return t(this.createValidationError("Channel or Channel Group must be supplied"));if(this.validateEndpointConfig(c)){var l=this.createBaseParams(c);a.length>0&&(l["channel-group"]=a.join(",")),this.networking.GET(l,c,function(e,n){if(e.error)return t(e);var r={};1===s.length&&0===a.length?r[s[0]]=n.payload:r=n.payload;var i={channels:r};t(e,i)})}}},{key:"setState",value:function(e,t){var n=e.state,r=e.channels,i=void 0===r?[]:r,s=e.channelGroups,o=void 0===s?[]:s,a=i.length>0?i.join(","):",",u={params:{authKey:{required:!1}},url:"/v2/presence/sub-key/"+this.config.subscribeKey+"/channel/"+a+"/uuid/"+this.config.UUID+"/data",operation:"PNSetStateOperation"};if(!t)return this.log("Missing Callback");if(0===i.length&&0===o.length)return t(this.createValidationError("Channel or Channel Group must be supplied"));if(!n)return t(this.createValidationError("State must be supplied"));if(this.validateEndpointConfig(u)){var c=this.createBaseParams(u);c.state=encodeURIComponent(JSON.stringify(n)),o.length>0&&(c["channel-group"]=o.join(",")),this.networking.GET(c,u,function(e,n){if(e.error)return t(e);var r={state:n.payload};t(e,r)})}}},{key:"leave",value:function(e,t){var n=e.channels,r=void 0===n?[]:n,i=e.channelGroups,s=void 0===i?[]:i,o=r.length>0?r.join(","):",",a={params:{authKey:{required:!1}},url:"/v2/presence/sub-key/"+this.config.subscribeKey+"/channel/"+encodeURIComponent(o)+"/leave",operation:"PNUnsubscribeOperation"};if(this.validateEndpointConfig(a)){var u=this.createBaseParams(a);s.length>0&&(u["channel-group"]=encodeURIComponent(s.join(","))),this.networking.GET(u,a,function(e){return t(e)})}}},{key:"hereNow",value:function(e,t){var n=e.channels,r=void 0===n?[]:n,i=e.channelGroups,s=void 0===i?[]:i,o=e.includeUUIDs,a=void 0===o||o,u=e.includeState,c=void 0!==u&&u,l={params:{authKey:{required:!1}},url:"/v2/presence/sub-key/"+this.config.subscribeKey,operation:"PNHereNowOperation"};if(r.length>0||s.length>0){var h=r.length>0?r.join(","):",";l.url+="/channel/"+encodeURIComponent(h)}if(this.validateEndpointConfig(l)){var f=this.createBaseParams(l);if(a||(f.disable_uuids=1),c&&(f.state=1),!t)return this.log("Missing Callback");s.length>0&&(f["channel-group"]=s.join(",")),this.networking.GET(f,l,function(e,n){if(e.error)return t(e);var i=function(){var e={},t=[];return e.totalChannels=1,e.totalOccupancy=n.occupancy,e.channels={},e.channels[r[0]]={occupants:t,name:r[0],occupancy:n.occupancy},a&&n.uuids.forEach(function(e){c?t.push({state:e.state,uuid:e.uuid}):t.push({state:null,uuid:e})}),e},o=function(){var e={};return e.totalChannels=n.payload.total_channels,e.totalOccupancy=n.payload.total_occupancy,e.channels={},Object.keys(n.payload.channels).forEach(function(t){var r=n.payload.channels[t],i=[];return e.channels[t]={occupants:i,name:t,occupancy:r.occupancy},a&&r.uuids.forEach(function(e){c?i.push({state:e.state,uuid:e.uuid}):i.push({state:null,uuid:e})}),e}),e},u=void 0;u=r.length>1||s.length>0?o():i(),t(e,u)})}}},{key:"heartbeat",value:function(e,t){var n=e.channels,r=void 0===n?[]:n,i=e.channelGroups,s=void 0===i?[]:i,o=e.state,a=void 0===o?{}:o,u=r.length>0?r.join(","):",",c={params:{authKey:{required:!1}},url:"/v2/presence/sub-key/"+this.config.subscribeKey+"/channel/"+encodeURIComponent(u)+"/heartbeat",operation:"PNHeartbeatOperation"};if(this.validateEndpointConfig(c)){var l=this.createBaseParams(c);s.length>0&&(l["channel-group"]=encodeURIComponent(s.join(","))),l.state=JSON.stringify(a),l.heartbeat=this.config.getPresenceTimeout(),this.networking.GET(l,c,function(e){t(e)})}}}]),t}(h["default"]));t["default"]=f,e.exports=t["default"]},function(e,t,n){"use strict";function r(){return"PNTimeOperation"}function i(){return"/time/0"}function s(){return{}}function o(e,t){return{timetoken:t[0]}}function a(){}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.getURL=i,t.prepareParams=s,t.handleResponse=o,t.validateParams=a;n(14)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=(n(14),function(){function e(){r(this,e),this._listeners=[]}return i(e,[{key:"addListener",value:function(e){this._listeners.push(e)}},{key:"removeListener",value:function(e){var t=[];this._listeners.forEach(function(n){n!==e&&t.push(n)}),this._listeners=t}},{key:"announcePresence",value:function(e){this._listeners.forEach(function(t){t.presence&&t.presence(e)})}},{key:"announceStatus",value:function(e){this._listeners.forEach(function(t){t.status&&t.status(e)})}},{key:"announceMessage",value:function(e){this._listeners.forEach(function(t){t.message&&t.message(e)})}}]),e}());t["default"]=s,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(20),a=(r(o),n(14),function(){function e(t){var n=t.timeEndpoints;i(this,e),this._timeEndpoints=n}return s(e,[{key:"onReconnection",value:function(e){this._reconnectionCallback=e}},{key:"startPolling",value:function(){this._timeTimer=setInterval(this._performTimeLoop.bind(this),3e3)}},{key:"_performTimeLoop",value:function(){var e=this;this._timeEndpoints.fetch(function(t){t.error||(clearInterval(e._timeTimer),e._reconnectionCallback())})}}]),e}());t["default"]=a,e.exports=t["default"]},function(e,t){"use strict";function n(e){return encodeURIComponent(e).replace(/[!'()*~]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function r(e){var t=[];return Object.keys(e).forEach(function(e){return t.push(e)}),t}function i(e){return r(e).sort()}function s(e){var t=i(e);return t.map(function(t){return t+"="+n(e[t])}).join("&")}e.exports={signPamFromParams:s,endsWith:function(e,t){return e.indexOf(t,this.length-t.length)!==-1}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){return e.type=t,e}function s(e){return i({message:e},"validationError")}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){var n=e.networking,r=e.config,i=null,o={};"PNTimeOperation"===t.getOperation()||"PNChannelGroupsOperation"===t.getOperation()?i=arguments.length<=2?void 0:arguments[2]:(o=arguments.length<=2?void 0:arguments[2],i=arguments.length<=3?void 0:arguments[3]);var u=t.validateParams(e,o);if(u)return void i(s(u));var c=t.prepareParams(e,o);c.uuid=r.UUID,Object.keys(r.baseParams).forEach(function(e){var t=r.baseParams[e];e in c||(c[e]=t)}),r.useInstanceId&&(c.instanceid=r.instanceId),r.useRequestId&&(c.requestid=a["default"].v4());var l=function(n,r){return n.error?i(n):void i(n,t.handleResponse(e,r))};if(t.usePost&&t.usePost(e,o)){var h=t.postURL(e,o),f=t.postPayload(e,o);n.POST(c,f,{url:h},l)}else{var p=t.getURL(e,o);n.GET(c,{url:p},l)}};var o=(n(14),n(12)),a=r(o);e.exports=t["default"]},function(e,t,n){"use strict";function r(){return"PNAddChannelsToGroupOperation"}function i(e,t){var n=t.channels,r=t.channelGroup,i=e.config;return r?n&&0!==n.length?i.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing Channel Group"}function s(e,t){var n=t.channelGroup,r=e.config;return"/v1/channel-registration/sub-key/"+r.subscribeKey+"/channel-group/"+n}function o(e,t){var n=t.channels,r=void 0===n?[]:n;return{add:r.join(",")}}function a(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.prepareParams=o,t.handleResponse=a;n(14)},function(e,t,n){"use strict";function r(){return"PNRemoveChannelsFromGroupOperation"}function i(e,t){var n=t.channels,r=t.channelGroup,i=e.config;return r?n&&0!==n.length?i.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing Channel Group"}function s(e,t){var n=t.channelGroup,r=e.config;return"/v1/channel-registration/sub-key/"+r.subscribeKey+"/channel-group/"+n}function o(e,t){var n=t.channels,r=void 0===n?[]:n;return{remove:r.join(",")}}function a(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.prepareParams=o,t.handleResponse=a;n(14)},function(e,t,n){"use strict";function r(){return"PNRemoveGroupOperation"}function i(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channel Group"}function s(e,t){var n=t.channelGroup,r=e.config;return"/v1/channel-registration/sub-key/"+r.subscribeKey+"/channel-group/"+n+"/remove"}function o(){return{}}function a(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.prepareParams=o,t.handleResponse=a;n(14)},function(e,t,n){"use strict";function r(){return"PNChannelGroupsOperation"}function i(e){var t=e.config;if(!t.subscribeKey)return"Missing Subscribe Key"}function s(e){var t=e.config;return"/v1/channel-registration/sub-key/"+t.subscribeKey+"/channel-group"}function o(){return{}}function a(e,t){return{groups:t.payload.groups}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.prepareParams=o,t.handleResponse=a;n(14)},function(e,t,n){"use strict";function r(){return"PNChannelsForGroupOperation"}function i(e,t){var n=t.channelGroup,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channel Group"}function s(e,t){var n=t.channelGroup,r=e.config;return"/v1/channel-registration/sub-key/"+r.subscribeKey+"/channel-group/"+n}function o(){return{}}function a(e,t){return{channels:t.payload.channels}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.prepareParams=o,t.handleResponse=a;n(14)},function(e,t,n){"use strict";function r(){return"PNPushNotificationEnabledChannelsOperation"}function i(e,t){var n=t.device,r=t.pushGateway,i=t.channels,s=e.config;return n?r?i&&0!==i.length?s.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"}function s(e,t){var n=t.device,r=e.config;return"/v1/push/sub-key/"+r.subscribeKey+"/devices/"+n}function o(e,t){var n=t.pushGateway,r=t.channels,i=void 0===r?[]:r;return{type:n,add:encodeURIComponent(i.join(","))
}}function a(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.prepareParams=o,t.handleResponse=a;n(14)},function(e,t,n){"use strict";function r(){return"PNPushNotificationEnabledChannelsOperation"}function i(e,t){var n=t.device,r=t.pushGateway,i=t.channels,s=e.config;return n?r?i&&0!==i.length?s.subscribeKey?void 0:"Missing Subscribe Key":"Missing Channels":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"}function s(e,t){var n=t.device,r=e.config;return"/v1/push/sub-key/"+r.subscribeKey+"/devices/"+n}function o(e,t){var n=t.pushGateway,r=t.channels,i=void 0===r?[]:r;return{type:n,remove:encodeURIComponent(i.join(","))}}function a(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.prepareParams=o,t.handleResponse=a;n(14)},function(e,t,n){"use strict";function r(){return"PNPushNotificationEnabledChannelsOperation"}function i(e,t){var n=t.device,r=t.pushGateway,i=e.config;return n?r?i.subscribeKey?void 0:"Missing Subscribe Key":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"}function s(e,t){var n=t.device,r=e.config;return"/v1/push/sub-key/"+r.subscribeKey+"/devices/"+n}function o(e,t){var n=t.pushGateway;return{type:n}}function a(e,t){return{channels:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.prepareParams=o,t.handleResponse=a;n(14)},function(e,t,n){"use strict";function r(){return"PNRemoveAllPushNotificationsOperation"}function i(e,t){var n=t.device,r=t.pushGateway,i=e.config;return n?r?i.subscribeKey?void 0:"Missing Subscribe Key":"Missing GW Type (pushGateway: gcm or apns)":"Missing Device ID (device)"}function s(e,t){var n=t.device,r=e.config;return"/v1/push/sub-key/"+r.subscribeKey+"/devices/"+n+"/remove"}function o(e,t){var n=t.pushGateway;return{type:n}}function a(){return{}}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=r,t.validateParams=i,t.getURL=s,t.prepareParams=o,t.handleResponse=a;n(14)},function(e,t,n){(function(e){"use strict";function r(t,n){var r=t.crypto,i=t.config,s=JSON.stringify(n);return i.cipherKey&&(s=r.encrypt(s),s=JSON.stringify(s)),e.log("prepareMessagePayload",s),s}function i(){return"PNPublishOperation"}function s(e,t){var n=t.message,r=t.channel,i=e.config;return r?n?i.subscribeKey?void 0:"Missing Subscribe Key":"Missing Message":"Missing Channel"}function o(e,t){var n=t.sendByPost,r=void 0!==n&&n;return r}function a(e,t){var n=e.config,i=t.channel,s=t.message,o=r(e,s);return"/publish/"+n.publishKey+"/"+n.subscribeKey+"/0/"+encodeURIComponent(i)+"/0/"+encodeURIComponent(o)}function u(e,t){var n=e.config,r=t.channel;return"/publish/"+n.publishKey+"/"+n.subscribeKey+"/0/"+encodeURIComponent(r)+"/0"}function c(e,t){var n=t.message;return r(e,n)}function l(e,t){var n=t.meta,r=t.replicate,i=void 0===r||r,s=t.storeInHistory,o={};return null!=s&&(s?o.store="1":o.store="0"),i===!1&&(o.norep="true"),n&&"object"===("undefined"==typeof n?"undefined":f(n))&&(o.meta=JSON.stringify(n)),o}function h(e,t){return{timetoken:t[2]}}Object.defineProperty(t,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t.getOperation=i,t.validateParams=s,t.usePost=o,t.getURL=a,t.postURL=u,t.postPayload=c,t.prepareParams=l,t.handleResponse=h;n(14)}).call(t,n(3))},function(e,t,n){"use strict";function r(e,t){var n=e.config,r=e.crypto;if(!n.cipherKey)return t;try{return r.decrypt(t)}catch(i){return t}}function i(){return"PNHistoryOperation"}function s(e,t){var n=t.channel,r=e.config;return n?r.subscribeKey?void 0:"Missing Subscribe Key":"Missing channel"}function o(e,t){var n=t.channel,r=e.config;return"/v2/history/sub-key/"+r.subscribeKey+"/channel/"+encodeURIComponent(n)}function a(e,t){var n=t.start,r=t.end,i=t.includeTimetoken,s=t.reverse,o=t.count,a=void 0===o?100:o,u={};return u.count=a,n&&(u.start=n),r&&(u.end=r),null!=i&&(u.include_token=i.toString()),null!=s&&(u.reverse=s.toString()),u}function u(e,t){var n={messages:[],startTimeToken:parseInt(t[1],10),endTimeToken:parseInt(t[2],10)};return t[0].forEach(function(t){var i={timetoken:null,entry:null};t.timetoken?(i.timetoken=t.timetoken,i.entry=r(e,t.message)):i.entry=r(e,t),n.messages.push(i)}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.getOperation=i,t.validateParams=s,t.getURL=o,t.prepareParams=a,t.handleResponse=u;n(14)},function(e,t){e.exports={name:"pubnub",preferGlobal:!1,version:"4.0.0-beta1",author:"PubNub <support@pubnub.com>",description:"Publish & Subscribe Real-time Messaging with PubNub",contributors:[{name:"Stephen Blum",email:"stephen@pubnub.com"}],bin:{},scripts:{codecov:"cat coverage/*/lcov.info | codecov"},main:"./node/pubnub.js",browser:"./modern/dist/pubnub.js",repository:{type:"git",url:"git://github.com/pubnub/javascript.git"},keywords:["cloud","publish","subscribe","websockets","comet","bosh","xmpp","real-time","messaging"],dependencies:{superagent:"^2.0.0",uuid:"^2.0.2"},noAnalyze:!1,devDependencies:{"babel-core":"^6.10.4","babel-eslint":"6.1.0","babel-plugin-add-module-exports":"^0.2.1","babel-plugin-transform-class-properties":"^6.10.2","babel-plugin-transform-flow-strip-types":"^6.8.0","babel-preset-es2015":"^6.9.0","babel-register":"^6.9.0",chai:"^3.5.0","eslint-config-airbnb":"9.0.1","eslint-plugin-flowtype":"2.3.0","eslint-plugin-import":"^1.9.2","eslint-plugin-mocha":"3.0.0","eslint-plugin-react":"5.2.2","flow-bin":"^0.27.0",gulp:"^3.9.1","gulp-babel":"^6.1.2","gulp-clean":"^0.3.2","gulp-eslint":"^2.0.0","gulp-exec":"^2.1.2","gulp-flowtype":"^0.4.9","gulp-istanbul":"^1.0.0","gulp-mocha":"^2.2.0","gulp-rename":"^1.2.2","gulp-sourcemaps":"^1.6.0","gulp-uglify":"^1.5.4","gulp-webpack":"^1.5.0","imports-loader":"0.6.5",isparta:"^4.0.0","json-loader":"0.5.4",karma:"1.1.0","karma-babel-preprocessor":"^6.0.1","karma-chai":"0.1.0","karma-chrome-launcher":"^1.0.1","karma-mocha":"^1.1.1","karma-phantomjs-launcher":"1.0.1","karma-spec-reporter":"0.0.26",mocha:"2.5.3",nock:"^8.0.0","phantomjs-prebuilt":"2.1.7","remap-istanbul":"^0.6.4","run-sequence":"^1.2.1",sinon:"^1.17.4","stats-webpack-plugin":"^0.3.1","uglify-js":"^2.6.4",webpack:"^1.13.1","webpack-dev-server":"1.14.1"},bundleDependencies:[],license:"MIT",engine:{node:">=0.8"}}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(2),c=(r(u),n(11)),l=(r(c),n(10)),h=(r(l),n(18)),f=r(h),p=n(23),d=r(p),y=(n(14),function(e){function t(e){var n=e.networking,r=e.config,o=e.crypto;i(this,t);var a=s(this,Object.getPrototypeOf(t).call(this,{config:r}));return a._networking=n,a._config=r,a._crypto=o,a}return o(t,e),a(t,[{key:"grant",value:function(e,t){var n=e.channels,r=void 0===n?[]:n,i=e.channelGroups,s=void 0===i?[]:i,o=e.ttl,a=e.read,u=void 0!==a&&a,c=e.write,l=void 0!==c&&c,h=e.manage,f=void 0!==h&&h,p=e.authKeys,y=void 0===p?[]:p,g={params:{subscribeKey:{required:!0},publishKey:{required:!0}},url:"/v1/auth/grant/sub-key/"+this._config.subscribeKey,operation:"PNAccessManagerGrant"};if(!t)return this.log("Missing Callback");if(this.validateEndpointConfig(g)){var b=this.createBaseParams(g);b.r=u?"1":"0",b.w=l?"1":"0",b.m=f?"1":"0",b.timestamp=Math.floor((new Date).getTime()/1e3),r.length>0&&(b.channel=r.join(",")),s.length>0&&(b["channel-group"]=s.join(",")),y.length>0&&(b.auth=y.join(",")),(o||0===o)&&(b.ttl=o);var v=this._config.subscribeKey+"\n"+this._config.publishKey+"\ngrant\n";v+=d["default"].signPamFromParams(b),b.signature=this._crypto.HMACSHA256(v),this._networking.GET(b,g,function(e,n){return e.error?t(e):void t(e,n.payload)})}}},{key:"audit",value:function(e,t){var n=e.channel,r=e.channelGroup,i=e.authKeys,s=void 0===i?[]:i,o={params:{subscribeKey:{required:!0},publishKey:{required:!0}},url:"/v1/auth/audit/sub-key/"+this._config.subscribeKey,operation:"PNAccessManagerAudit"};if(!t)return this.log("Missing Callback");if(this.validateEndpointConfig(o)){var a=this.createBaseParams(o);a.timestamp=Math.floor((new Date).getTime()/1e3),n&&(a.channel=n),r&&(a["channel-group"]=r),s.length>0&&(a.auth=s.join(","));var u=this._config.subscribeKey+"\n"+this._config.publishKey+"\naudit\n";u+=d["default"].signPamFromParams(a),a.signature=this._crypto.HMACSHA256(u),this._networking.GET(a,o,function(e,n){return e.error?t(e):void t(e,n.payload)})}}}]),t}(f["default"]));t["default"]=y,e.exports=t["default"]}])});