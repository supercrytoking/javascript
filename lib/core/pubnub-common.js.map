{"version":3,"sources":["core/pubnub-common.js"],"names":["setup","db","networking","config","_config","Config","crypto","Crypto","init","modules","timeEndpoint","endpointCreator","bind","timeEndpointConfig","leaveEndpoint","presenceLeaveEndpointConfig","heartbeatEndpoint","presenceHeartbeatEndpointConfig","setStateEndpoint","presenceSetStateConfig","subscribeEndpoint","subscribeEndpointConfig","listenerManager","_listenerManager","ListenerManager","subscriptionManager","SubscriptionManager","addListener","removeListener","removeAllListeners","channelGroups","listGroups","listChannelGroupsConfig","listChannels","listChannelsInChannelGroupConfig","addChannels","addChannelsChannelGroupConfig","removeChannels","removeChannelsChannelGroupConfig","deleteGroup","deleteChannelGroupConfig","push","addPushChannelsConfig","removePushChannelsConfig","deleteDevice","removeDevicePushConfig","listPushChannelsConfig","hereNow","presenceHereNowConfig","whereNow","presenceWhereNowEndpointConfig","getState","presenceGetStateConfig","setState","adaptStateChange","grant","grantEndpointConfig","audit","auditEndpointConfig","publish","publishEndpointConfig","fire","args","callback","replicate","storeInHistory","signal","signalEndpointConfig","history","historyEndpointConfig","deleteMessages","deleteMessagesEndpointConfig","messageCounts","messageCountsEndpointConfig","fetchMessages","fetchMessagesEndpointConfig","createUser","createUserEndpointConfig","updateUser","updateUserEndpointConfig","deleteUser","deleteUserEndpointConfig","getUser","getUserEndpointConfig","getUsers","getUsersEndpointConfig","createSpace","createSpaceEndpointConfig","updateSpace","updateSpaceEndpointConfig","deleteSpace","deleteSpaceEndpointConfig","getSpaces","getSpacesEndpointConfig","getSpace","getSpaceEndpointConfig","addMembers","addMembersEndpointConfig","updateMembers","updateMembersEndpointConfig","removeMembers","removeMembersEndpointConfig","getMembers","getMembersEndpointConfig","getMemberships","getMembershipsEndpointConfig","joinSpaces","joinSpacesEndpointConfig","updateMemberships","updateMembershipsEndpointConfig","leaveSpaces","leaveSpacesEndpointConfig","time","subscribe","adaptSubscribeChange","presence","adaptPresenceChange","unsubscribe","adaptUnsubscribeChange","disconnect","reconnect","destroy","isOffline","unsubscribeAll","stop","getSubscribedChannels","getSubscribedChannelGroups","encrypt","decrypt","getAuthKey","setAuthKey","setCipherKey","getUUID","setUUID","getFilterExpression","setFilterExpression","setHeartbeatInterval","hasModule","setProxy","proxy","getVersion","announceNetworkDown","restore","announceNetworkUp","uuidGenerator","createUUID","OPERATIONS","CATEGORIES"],"mappings":"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","sourcesContent":["/* @flow */\n\nimport Config from './components/config';\nimport Crypto from './components/cryptography/index';\nimport SubscriptionManager from './components/subscription_manager';\nimport ListenerManager from './components/listener_manager';\n\nimport endpointCreator from './components/endpoint';\n\nimport * as addChannelsChannelGroupConfig from './endpoints/channel_groups/add_channels';\nimport * as removeChannelsChannelGroupConfig from './endpoints/channel_groups/remove_channels';\nimport * as deleteChannelGroupConfig from './endpoints/channel_groups/delete_group';\nimport * as listChannelGroupsConfig from './endpoints/channel_groups/list_groups';\nimport * as listChannelsInChannelGroupConfig from './endpoints/channel_groups/list_channels';\n\nimport * as addPushChannelsConfig from './endpoints/push/add_push_channels';\nimport * as removePushChannelsConfig from './endpoints/push/remove_push_channels';\nimport * as listPushChannelsConfig from './endpoints/push/list_push_channels';\nimport * as removeDevicePushConfig from './endpoints/push/remove_device';\n\nimport * as presenceLeaveEndpointConfig from './endpoints/presence/leave';\nimport * as presenceWhereNowEndpointConfig from './endpoints/presence/where_now';\nimport * as presenceHeartbeatEndpointConfig from './endpoints/presence/heartbeat';\nimport * as presenceGetStateConfig from './endpoints/presence/get_state';\nimport * as presenceSetStateConfig from './endpoints/presence/set_state';\nimport * as presenceHereNowConfig from './endpoints/presence/here_now';\n\n// Objects API\n\nimport * as createUserEndpointConfig from './endpoints/users/create_user';\nimport * as updateUserEndpointConfig from './endpoints/users/update_user';\nimport * as deleteUserEndpointConfig from './endpoints/users/delete_user';\nimport * as getUserEndpointConfig from './endpoints/users/get_user';\nimport * as getUsersEndpointConfig from './endpoints/users/get_users';\nimport * as createSpaceEndpointConfig from './endpoints/spaces/create_space';\nimport * as updateSpaceEndpointConfig from './endpoints/spaces/update_space';\nimport * as deleteSpaceEndpointConfig from './endpoints/spaces/delete_space';\nimport * as getSpacesEndpointConfig from './endpoints/spaces/get_spaces';\nimport * as getSpaceEndpointConfig from './endpoints/spaces/get_space';\nimport * as getMembersEndpointConfig from './endpoints/memberships/get_members';\nimport * as addMembersEndpointConfig from './endpoints/memberships/add_members';\nimport * as updateMembersEndpointConfig from './endpoints/memberships/update_members';\nimport * as removeMembersEndpointConfig from './endpoints/memberships/remove_members';\nimport * as getMembershipsEndpointConfig from './endpoints/memberships/get_memberships';\nimport * as updateMembershipsEndpointConfig from './endpoints/memberships/update_memberships';\nimport * as joinSpacesEndpointConfig from './endpoints/memberships/join_spaces';\nimport * as leaveSpacesEndpointConfig from './endpoints/memberships/leave_spaces';\n\nimport * as auditEndpointConfig from './endpoints/access_manager/audit';\nimport * as grantEndpointConfig from './endpoints/access_manager/grant';\n\nimport * as publishEndpointConfig from './endpoints/publish';\nimport * as signalEndpointConfig from './endpoints/signal';\nimport * as historyEndpointConfig from './endpoints/history/get_history';\nimport * as deleteMessagesEndpointConfig from './endpoints/history/delete_messages';\nimport * as messageCountsEndpointConfig from './endpoints/history/message_counts';\nimport * as fetchMessagesEndpointConfig from './endpoints/fetch_messages';\nimport * as timeEndpointConfig from './endpoints/time';\nimport * as subscribeEndpointConfig from './endpoints/subscribe';\n\nimport OPERATIONS from './constants/operations';\nimport CATEGORIES from './constants/categories';\n\nimport { InternalSetupStruct } from './flow_interfaces';\nimport uuidGenerator from './components/uuid';\n\nexport default class {\n  _config: Config;\n  _listenerManager: ListenerManager;\n\n  // tell flow about the mounted endpoint\n  time: Function;\n  publish: Function;\n  fire: Function;\n\n  history: Function;\n  deleteMessages: Function;\n  messageCounts: Function;\n  fetchMessages: Function;\n\n  //\n  channelGroups: Object;\n  //\n  push: Object;\n  //\n  hereNow: Function;\n  whereNow: Function;\n  getState: Function;\n  setState: Function;\n  //\n  grant: Function;\n  audit: Function;\n  //\n  subscribe: Function;\n  signal: Function;\n  presence: Function;\n  unsubscribe: Function;\n  unsubscribeAll: Function;\n\n  // Objects API\n\n  createUser: Function;\n  updateUser: Function;\n  deleteUser: Function;\n  getUser: Function;\n  getUsers: Function;\n  createSpace: Function;\n  updateSpace: Function;\n  deleteSpace: Function;\n  getSpaces: Function;\n  getSpace: Function;\n  getMembers: Function;\n  addMembers: Function;\n  updateMembers: Function;\n  removeMembers: Function;\n  getMemberships: Function;\n  joinSpaces: Function;\n  updateMemberships: Function;\n  leaveSpaces: Function;\n\n  disconnect: Function;\n  reconnect: Function;\n\n  destroy: Function;\n  stop: Function;\n\n  getSubscribedChannels: Function;\n  getSubscribedChannelGroups: Function;\n\n  addListener: Function;\n  removeListener: Function;\n  removeAllListeners: Function;\n\n  getAuthKey: Function;\n  setAuthKey: Function;\n\n  setCipherKey: Function;\n  setUUID: Function;\n  getUUID: Function;\n\n  getFilterExpression: Function;\n  setFilterExpression: Function;\n\n  setHeartbeatInterval: Function;\n\n  setProxy: Function;\n\n  encrypt: Function;\n  decrypt: Function;\n\n  //\n\n  constructor(setup: InternalSetupStruct) {\n    let { db, networking } = setup;\n\n    const config = (this._config = new Config({ setup, db }));\n    const crypto = new Crypto({ config });\n\n    networking.init(config);\n\n    let modules = { config, networking, crypto };\n\n    const timeEndpoint = endpointCreator.bind(\n      this,\n      modules,\n      timeEndpointConfig\n    );\n    const leaveEndpoint = endpointCreator.bind(\n      this,\n      modules,\n      presenceLeaveEndpointConfig\n    );\n    const heartbeatEndpoint = endpointCreator.bind(\n      this,\n      modules,\n      presenceHeartbeatEndpointConfig\n    );\n    const setStateEndpoint = endpointCreator.bind(\n      this,\n      modules,\n      presenceSetStateConfig\n    );\n    const subscribeEndpoint = endpointCreator.bind(\n      this,\n      modules,\n      subscribeEndpointConfig\n    );\n\n    // managers\n    const listenerManager = (this._listenerManager = new ListenerManager());\n\n    const subscriptionManager = new SubscriptionManager({\n      timeEndpoint,\n      leaveEndpoint,\n      heartbeatEndpoint,\n      setStateEndpoint,\n      subscribeEndpoint,\n      crypto: modules.crypto,\n      config: modules.config,\n      listenerManager,\n    });\n\n    this.addListener = listenerManager.addListener.bind(listenerManager);\n    this.removeListener = listenerManager.removeListener.bind(listenerManager);\n    this.removeAllListeners = listenerManager.removeAllListeners.bind(\n      listenerManager\n    );\n\n    /* channel groups */\n    this.channelGroups = {\n      listGroups: endpointCreator.bind(this, modules, listChannelGroupsConfig),\n      listChannels: endpointCreator.bind(\n        this,\n        modules,\n        listChannelsInChannelGroupConfig\n      ),\n      addChannels: endpointCreator.bind(\n        this,\n        modules,\n        addChannelsChannelGroupConfig\n      ),\n      removeChannels: endpointCreator.bind(\n        this,\n        modules,\n        removeChannelsChannelGroupConfig\n      ),\n      deleteGroup: endpointCreator.bind(\n        this,\n        modules,\n        deleteChannelGroupConfig\n      ),\n    };\n    /* push */\n    this.push = {\n      addChannels: endpointCreator.bind(this, modules, addPushChannelsConfig),\n      removeChannels: endpointCreator.bind(\n        this,\n        modules,\n        removePushChannelsConfig\n      ),\n      deleteDevice: endpointCreator.bind(this, modules, removeDevicePushConfig),\n      listChannels: endpointCreator.bind(this, modules, listPushChannelsConfig),\n    };\n    /* presence */\n    this.hereNow = endpointCreator.bind(this, modules, presenceHereNowConfig);\n    this.whereNow = endpointCreator.bind(\n      this,\n      modules,\n      presenceWhereNowEndpointConfig\n    );\n    this.getState = endpointCreator.bind(this, modules, presenceGetStateConfig);\n    this.setState = subscriptionManager.adaptStateChange.bind(\n      subscriptionManager\n    );\n    /* PAM */\n    this.grant = endpointCreator.bind(this, modules, grantEndpointConfig);\n    this.audit = endpointCreator.bind(this, modules, auditEndpointConfig);\n    //\n    this.publish = endpointCreator.bind(this, modules, publishEndpointConfig);\n\n    this.fire = (args, callback) => {\n      args.replicate = false;\n      args.storeInHistory = false;\n      return this.publish(args, callback);\n    };\n\n    this.signal = endpointCreator.bind(this, modules, signalEndpointConfig);\n\n    this.history = endpointCreator.bind(this, modules, historyEndpointConfig);\n    this.deleteMessages = endpointCreator.bind(\n      this,\n      modules,\n      deleteMessagesEndpointConfig\n    );\n    this.messageCounts = endpointCreator.bind(\n      this,\n      modules,\n      messageCountsEndpointConfig\n    );\n    this.fetchMessages = endpointCreator.bind(\n      this,\n      modules,\n      fetchMessagesEndpointConfig\n    );\n\n    // Objects API\n\n    this.createUser = endpointCreator.bind(\n      this,\n      modules,\n      createUserEndpointConfig\n    );\n\n    this.updateUser = endpointCreator.bind(\n      this,\n      modules,\n      updateUserEndpointConfig\n    );\n\n    this.deleteUser = endpointCreator.bind(\n      this,\n      modules,\n      deleteUserEndpointConfig\n    );\n\n    this.getUser = endpointCreator.bind(\n      this,\n      modules,\n      getUserEndpointConfig\n    );\n\n    this.getUsers = endpointCreator.bind(\n      this,\n      modules,\n      getUsersEndpointConfig\n    );\n\n    this.createSpace = endpointCreator.bind(\n      this,\n      modules,\n      createSpaceEndpointConfig\n    );\n\n    this.updateSpace = endpointCreator.bind(\n      this,\n      modules,\n      updateSpaceEndpointConfig\n    );\n\n    this.deleteSpace = endpointCreator.bind(\n      this,\n      modules,\n      deleteSpaceEndpointConfig\n    );\n\n    this.getSpaces = endpointCreator.bind(\n      this,\n      modules,\n      getSpacesEndpointConfig\n    );\n\n    this.getSpace = endpointCreator.bind(\n      this,\n      modules,\n      getSpaceEndpointConfig\n    );\n\n    this.addMembers = endpointCreator.bind(\n      this,\n      modules,\n      addMembersEndpointConfig\n    );\n\n    this.updateMembers = endpointCreator.bind(\n      this,\n      modules,\n      updateMembersEndpointConfig\n    );\n\n    this.removeMembers = endpointCreator.bind(\n      this,\n      modules,\n      removeMembersEndpointConfig\n    );\n\n    this.getMembers = endpointCreator.bind(\n      this,\n      modules,\n      getMembersEndpointConfig\n    );\n\n    this.getMemberships = endpointCreator.bind(\n      this,\n      modules,\n      getMembershipsEndpointConfig\n    );\n\n    this.joinSpaces = endpointCreator.bind(\n      this,\n      modules,\n      joinSpacesEndpointConfig\n    );\n\n    this.updateMemberships = endpointCreator.bind(\n      this,\n      modules,\n      updateMembershipsEndpointConfig\n    );\n\n    this.leaveSpaces = endpointCreator.bind(\n      this,\n      modules,\n      leaveSpacesEndpointConfig\n    );\n\n    this.time = timeEndpoint;\n\n    // subscription related methods\n    this.subscribe = subscriptionManager.adaptSubscribeChange.bind(\n      subscriptionManager\n    );\n    this.presence = subscriptionManager.adaptPresenceChange.bind(\n      subscriptionManager\n    );\n    this.unsubscribe = subscriptionManager.adaptUnsubscribeChange.bind(\n      subscriptionManager\n    );\n    this.disconnect = subscriptionManager.disconnect.bind(subscriptionManager);\n    this.reconnect = subscriptionManager.reconnect.bind(subscriptionManager);\n\n    this.destroy = (isOffline: boolean) => {\n      subscriptionManager.unsubscribeAll(isOffline);\n      subscriptionManager.disconnect();\n    };\n\n    // --- deprecated  ------------------\n    this.stop = this.destroy; // --------\n    // --- deprecated  ------------------\n\n    this.unsubscribeAll = subscriptionManager.unsubscribeAll.bind(\n      subscriptionManager\n    );\n\n    this.getSubscribedChannels = subscriptionManager.getSubscribedChannels.bind(\n      subscriptionManager\n    );\n    this.getSubscribedChannelGroups = subscriptionManager.getSubscribedChannelGroups.bind(\n      subscriptionManager\n    );\n\n    // mount crypto\n    this.encrypt = crypto.encrypt.bind(crypto);\n    this.decrypt = crypto.decrypt.bind(crypto);\n\n    /* config */\n    this.getAuthKey = modules.config.getAuthKey.bind(modules.config);\n    this.setAuthKey = modules.config.setAuthKey.bind(modules.config);\n    this.setCipherKey = modules.config.setCipherKey.bind(modules.config);\n    this.getUUID = modules.config.getUUID.bind(modules.config);\n    this.setUUID = modules.config.setUUID.bind(modules.config);\n    this.getFilterExpression = modules.config.getFilterExpression.bind(\n      modules.config\n    );\n    this.setFilterExpression = modules.config.setFilterExpression.bind(\n      modules.config\n    );\n\n    this.setHeartbeatInterval = modules.config.setHeartbeatInterval.bind(\n      modules.config\n    );\n\n    if (networking.hasModule('proxy')) {\n      this.setProxy = (proxy) => {\n        modules.config.setProxy(proxy);\n        this.reconnect();\n      };\n    }\n  }\n\n  getVersion(): string {\n    return this._config.getVersion();\n  }\n\n  // network hooks to indicate network changes\n  networkDownDetected() {\n    this._listenerManager.announceNetworkDown();\n\n    if (this._config.restore) {\n      this.disconnect();\n    } else {\n      this.destroy(true);\n    }\n  }\n\n  networkUpDetected() {\n    this._listenerManager.announceNetworkUp();\n    this.reconnect();\n  }\n\n  static generateUUID(): string {\n    return uuidGenerator.createUUID();\n  }\n\n  static OPERATIONS = OPERATIONS;\n  static CATEGORIES = CATEGORIES;\n}\n"],"file":"pubnub-common.js"}