!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports.PUBNUB=b():a.PUBNUB=b()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){function d(a){function b(){Ti.Stream.read(c,g,function(a){if(+a.bytesProcessed>-1)return d=Ti.Codec.decodeString({source:g,length:+a.bytesProcessed}),f.push(d),g.clear(),i.timeout(b,1);try{d=JSON.parse(f.join("").split("\r\n").slice(-1))}catch(e){return l()}c.close(),m(d)})}var c,d=a.data||{};d.pnsdk=j;var e=i.build_url(a.url,d),f=[],d="",g=Ti.createBuffer({length:2048}),h=Ti.createBuffer({value:"GET "+e+" HTTP/1.0\n\n"}),k=0,l=function(){k||(k=1,(a.fail||function(){})())},m=a.success||function(){};c=Ti.Network.Socket.createTCP({host:e.split(i.URLBIT)[2],port:80,mode:Ti.Network.READ_WRITE_MODE,timeout:i.XHRTME,error:l,connected:function(){c.write(h),b()}});try{c.connect()}catch(n){return l()}}function e(a){var b=a.data||{};b.pnsdk=j;var c,d,e=i.build_url(a.url,b),f=0,g=0,h=a.fail||function(){},k=a.success||function(){},l=function(a){f||(f=1,clearTimeout(d),c&&(c.onerror=c.onload=null,c.abort&&c.abort(),c=null),a&&h())},m=function(){var a;if(!g){g=1,clearTimeout(d);try{a=JSON.parse(c.responseText)}catch(b){return l(1)}k(a)}};d=i.timeout(function(){l(1)},i.XHRTME);try{c=Ti.Network.createHTTPClient(),c.onerror=function(){l(1)},c.onload=m,c.timeout=i.XHRTME,c.open("GET",e,!0),c.send()}catch(n){l(1,{error:"XHR Failed",stacktrace:n})}return l}function f(a){a.db=k,a.xdr=a.native_tcp_socket?d:e,a.crypto_obj=g(),a.params={pnsdk:j};var b=function(a){return f(a)},c=i.PN_API(a);for(var h in c)c.hasOwnProperty(h)&&(b[h]=c[h]);return b.init=b,b.crypto_obj=g(),a.notest?b:(b.ready(),b)}c(1);var g=c(2),h=c(4),i=c(5),j="PubNub-JS-Titanium/"+h.version,k=function(){return{get:function(a){Ti.App.Properties.getString(""+a)},set:function(a,b){Ti.App.Properties.setString(""+a,""+b)}}}();f.init=f,f.crypto_obj=g(),a.exports=f},function(module,exports){(function(){window.JSON&&window.JSON.stringify||function(){function toJSON(a){try{return this.valueOf()}catch(b){return null}}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&(i=toJSON.call(i,a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)d=rep[c],"string"==typeof d&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}window.JSON||(window.JSON={});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text){return eval("("+text+")")})}()}).call(window)},function(a,b,c){function d(){function a(a){return e.SHA256(a).toString(e.enc.Hex)}function b(a){return a=a||{},a.hasOwnProperty("encryptKey")||(a.encryptKey=l.encryptKey),a.hasOwnProperty("keyEncoding")||(a.keyEncoding=l.keyEncoding),a.hasOwnProperty("keyLength")||(a.keyLength=l.keyLength),a.hasOwnProperty("mode")||(a.mode=l.mode),-1==i.indexOf(a.keyEncoding.toLowerCase())&&(a.keyEncoding=l.keyEncoding),-1==j.indexOf(parseInt(a.keyLength,10))&&(a.keyLength=l.keyLength),-1==k.indexOf(a.mode.toLowerCase())&&(a.mode=l.mode),a}function c(a,b){return"base64"===b.keyEncoding?e.enc.Base64.parse(a):"hex"===b.keyEncoding?e.enc.Hex.parse(a):a}function d(b,d){return b=c(b,d),d.encryptKey?e.enc.Utf8.parse(a(b).slice(0,32)):b}function f(a){return"ecb"===a.mode?e.mode.ECB:e.mode.CBC}function g(a){return"cbc"===a.mode?e.enc.Utf8.parse(h):null}var h="0123456789012345",i=["hex","utf8","base64","binary"],j=[128,256],k=["ecb","cbc"],l={encryptKey:!0,keyEncoding:"utf8",keyLength:256,mode:"cbc"};return{encrypt:function(a,c,h){if(!c)return a;h=b(h);var i=g(h),j=f(h),k=d(c,h),l=JSON.stringify(a),m=e.AES.encrypt(l,k,{iv:i,mode:j}).ciphertext,n=m.toString(e.enc.Base64);return n||a},decrypt:function(a,c,h){if(!c)return a;h=b(h);var i=g(h),j=f(h),k=d(c,h);try{var l=e.enc.Base64.parse(a),m=e.AES.decrypt({ciphertext:l},k,{iv:i,mode:j}).toString(e.enc.Utf8),n=JSON.parse(m);return n}catch(o){return}}}}var e=c(3);a.exports=d},function(a,b){var c=c||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},g=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var e=0;a>e;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;a>e;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new g.init(c,b)}}),h=c.enc={},i=h.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-8*(d%4);return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=e/(4*f),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0);if(b=h*f,e=a.min(4*b,e),b){for(var i=0;b>i;i+=f)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return new g.init(i,e)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}});var m=c.algo={};return c}(Math);!function(a){for(var b=c,d=b.lib,e=d.WordArray,f=d.Hasher,d=b.algo,g=[],h=[],i=function(a){return 4294967296*(a-(0|a))|0},j=2,k=0;64>k;){var l;a:{l=j;for(var m=a.sqrt(l),n=2;m>=n;n++)if(!(l%n)){l=!1;break a}l=!0}l&&(8>k&&(g[k]=i(a.pow(j,.5))),h[k]=i(a.pow(j,1/3)),k++),j++}var o=[],d=d.SHA256=f.extend({_doReset:function(){this._hash=new e.init(g.slice(0))},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],g=c[3],i=c[4],j=c[5],k=c[6],l=c[7],m=0;64>m;m++){if(16>m)o[m]=0|a[b+m];else{var n=o[m-15],p=o[m-2];o[m]=((n<<25|n>>>7)^(n<<14|n>>>18)^n>>>3)+o[m-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+o[m-16]}n=l+((i<<26|i>>>6)^(i<<21|i>>>11)^(i<<7|i>>>25))+(i&j^~i&k)+h[m]+o[m],p=((d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22))+(d&e^d&f^e&f),l=k,k=j,j=i,i=g+n|0,g=f,f=e,e=d,d=n+p|0}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+g|0,c[4]=c[4]+i|0,c[5]=c[5]+j|0,c[6]=c[6]+k|0,c[7]=c[7]+l|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;return c[e>>>5]|=128<<24-e%32,c[(e+64>>>9<<4)+14]=a.floor(d/4294967296),c[(e+64>>>9<<4)+15]=d,b.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var a=f.clone.call(this);return a._hash=this._hash.clone(),a}});b.SHA256=f._createHelper(d),b.HmacSHA256=f._createHmacHelper(d)}(Math),function(){var a=c,b=a.enc.Utf8;a.algo.HMAC=a.lib.Base.extend({init:function(a,c){a=this._hasher=new a.init,"string"==typeof c&&(c=b.parse(c));var d=a.blockSize,e=4*d;c.sigBytes>e&&(c=a.finalize(c)),c.clamp();for(var f=this._oKey=c.clone(),g=this._iKey=c.clone(),h=f.words,i=g.words,j=0;d>j;j++)h[j]^=1549556828,i[j]^=909522486;f.sigBytes=g.sigBytes=e,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var b=this._hasher;return a=b.finalize(a),b.reset(),b.finalize(this._oKey.clone().concat(a))}})}(),function(){var a=c,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp(),a=[];for(var e=0;c>e;e+=3)for(var f=(b[e>>>2]>>>24-8*(e%4)&255)<<16|(b[e+1>>>2]>>>24-8*((e+1)%4)&255)<<8|b[e+2>>>2]>>>24-8*((e+2)%4)&255,g=0;4>g&&c>e+.75*g;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var c=a.length,d=this._map,e=d.charAt(64);e&&(e=a.indexOf(e),-1!=e&&(c=e));for(var e=[],f=0,g=0;c>g;g++)if(g%4){var h=d.indexOf(a.charAt(g-1))<<2*(g%4),i=d.indexOf(a.charAt(g))>>>6-2*(g%4);e[f>>>2]|=(h|i)<<24-8*(f%4),f++}return b.create(e,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(a){function b(a,b,c,d,e,f,g){return a=a+(b&c|~b&d)+e+g,(a<<f|a>>>32-f)+b}function d(a,b,c,d,e,f,g){return a=a+(b&d|c&~d)+e+g,(a<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){return a=a+(b^c^d)+e+g,(a<<f|a>>>32-f)+b}function f(a,b,c,d,e,f,g){return a=a+(c^(b|~d))+e+g,(a<<f|a>>>32-f)+b}for(var g=c,h=g.lib,i=h.WordArray,j=h.Hasher,h=g.algo,k=[],l=0;64>l;l++)k[l]=4294967296*a.abs(a.sin(l+1))|0;h=h.MD5=j.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,c){for(var g=0;16>g;g++){var h=c+g,i=a[h];a[h]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var g=this._hash.words,h=a[c+0],i=a[c+1],j=a[c+2],l=a[c+3],m=a[c+4],n=a[c+5],o=a[c+6],p=a[c+7],q=a[c+8],r=a[c+9],s=a[c+10],t=a[c+11],u=a[c+12],v=a[c+13],w=a[c+14],x=a[c+15],y=g[0],z=g[1],A=g[2],B=g[3],y=b(y,z,A,B,h,7,k[0]),B=b(B,y,z,A,i,12,k[1]),A=b(A,B,y,z,j,17,k[2]),z=b(z,A,B,y,l,22,k[3]),y=b(y,z,A,B,m,7,k[4]),B=b(B,y,z,A,n,12,k[5]),A=b(A,B,y,z,o,17,k[6]),z=b(z,A,B,y,p,22,k[7]),y=b(y,z,A,B,q,7,k[8]),B=b(B,y,z,A,r,12,k[9]),A=b(A,B,y,z,s,17,k[10]),z=b(z,A,B,y,t,22,k[11]),y=b(y,z,A,B,u,7,k[12]),B=b(B,y,z,A,v,12,k[13]),A=b(A,B,y,z,w,17,k[14]),z=b(z,A,B,y,x,22,k[15]),y=d(y,z,A,B,i,5,k[16]),B=d(B,y,z,A,o,9,k[17]),A=d(A,B,y,z,t,14,k[18]),z=d(z,A,B,y,h,20,k[19]),y=d(y,z,A,B,n,5,k[20]),B=d(B,y,z,A,s,9,k[21]),A=d(A,B,y,z,x,14,k[22]),z=d(z,A,B,y,m,20,k[23]),y=d(y,z,A,B,r,5,k[24]),B=d(B,y,z,A,w,9,k[25]),A=d(A,B,y,z,l,14,k[26]),z=d(z,A,B,y,q,20,k[27]),y=d(y,z,A,B,v,5,k[28]),B=d(B,y,z,A,j,9,k[29]),A=d(A,B,y,z,p,14,k[30]),z=d(z,A,B,y,u,20,k[31]),y=e(y,z,A,B,n,4,k[32]),B=e(B,y,z,A,q,11,k[33]),A=e(A,B,y,z,t,16,k[34]),z=e(z,A,B,y,w,23,k[35]),y=e(y,z,A,B,i,4,k[36]),B=e(B,y,z,A,m,11,k[37]),A=e(A,B,y,z,p,16,k[38]),z=e(z,A,B,y,s,23,k[39]),y=e(y,z,A,B,v,4,k[40]),B=e(B,y,z,A,h,11,k[41]),A=e(A,B,y,z,l,16,k[42]),z=e(z,A,B,y,o,23,k[43]),y=e(y,z,A,B,r,4,k[44]),B=e(B,y,z,A,u,11,k[45]),A=e(A,B,y,z,x,16,k[46]),z=e(z,A,B,y,j,23,k[47]),y=f(y,z,A,B,h,6,k[48]),B=f(B,y,z,A,p,10,k[49]),A=f(A,B,y,z,w,15,k[50]),z=f(z,A,B,y,n,21,k[51]),y=f(y,z,A,B,u,6,k[52]),B=f(B,y,z,A,l,10,k[53]),A=f(A,B,y,z,s,15,k[54]),z=f(z,A,B,y,i,21,k[55]),y=f(y,z,A,B,q,6,k[56]),B=f(B,y,z,A,x,10,k[57]),A=f(A,B,y,z,o,15,k[58]),z=f(z,A,B,y,v,21,k[59]),y=f(y,z,A,B,m,6,k[60]),B=f(B,y,z,A,t,10,k[61]),A=f(A,B,y,z,j,15,k[62]),z=f(z,A,B,y,r,21,k[63]);g[0]=g[0]+y|0,g[1]=g[1]+z|0,g[2]=g[2]+A|0,g[3]=g[3]+B|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/4294967296);for(c[(e+64>>>9<<4)+15]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c[(e+64>>>9<<4)+14]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),b.sigBytes=4*(c.length+1),this._process(),b=this._hash,c=b.words,d=0;4>d;d++)e=c[d],c[d]=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>8);return b},clone:function(){var a=j.clone.call(this);return a._hash=this._hash.clone(),a}}),g.MD5=j._createHelper(h),g.HmacMD5=j._createHmacHelper(h)}(Math),function(){var a=c,b=a.lib,d=b.Base,e=b.WordArray,b=a.algo,f=b.EvpKDF=d.extend({cfg:d.extend({keySize:4,hasher:b.MD5,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,d=c.hasher.create(),f=e.create(),g=f.words,h=c.keySize,c=c.iterations;g.length<h;){i&&d.update(i);var i=d.update(a).finalize(b);d.reset();for(var j=1;c>j;j++)i=d.finalize(i),d.reset();f.concat(i)}return f.sigBytes=4*h,f}});a.EvpKDF=function(a,b,c){return f.create(c).compute(a,b)}}(),c.lib.Cipher||function(a){var b=c,d=b.lib,e=d.Base,f=d.WordArray,g=d.BufferedBlockAlgorithm,h=b.enc.Base64,i=b.algo.EvpKDF,j=d.Cipher=g.extend({cfg:e.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){g.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){return a&&this._append(a),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(a){return{encrypt:function(b,c,d){return("string"==typeof c?p:o).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?p:o).decrypt(a,b,c,d)}}}});d.StreamCipher=j.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var k=b.mode={},l=function(b,c,d){var e=this._iv;e?this._iv=a:e=this._prevBlock;for(var f=0;d>f;f++)b[c+f]^=e[f]},m=(d.BlockCipherMode=e.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}})).extend();m.Encryptor=m.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize;l.call(this,a,b,d),c.encryptBlock(a,b),this._prevBlock=a.slice(b,b+d)}}),m.Decryptor=m.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=a.slice(b,b+d);c.decryptBlock(a,b),l.call(this,a,b,d),this._prevBlock=e}}),k=k.CBC=m,m=(b.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,e=[],g=0;c>g;g+=4)e.push(d);c=f.create(e,c),a.concat(c)},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}},d.BlockCipher=j.extend({cfg:j.cfg.extend({mode:k,padding:m}),reset:function(){j.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var n=d.CipherParams=e.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),k=(b.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;return a=a.salt,(a?f.create([1398893684,1701076831]).concat(a).concat(b):b).toString(h)},parse:function(a){a=h.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=f.create(b.slice(2,4));b.splice(0,4),a.sigBytes-=16}return n.create({ciphertext:a,salt:c})}},o=d.SerializableCipher=e.extend({cfg:e.extend({format:k}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);return b=e.finalize(b),e=e.cfg,n.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),b=(b.kdf={}).OpenSSL={execute:function(a,b,c,d){return d||(d=f.random(8)),a=i.create({keySize:b+c}).compute(a,d),c=f.create(a.words.slice(b),4*c),a.sigBytes=4*b,n.create({key:a,iv:c,salt:d})}},p=d.PasswordBasedCipher=o.extend({cfg:o.cfg.extend({kdf:b}),encrypt:function(a,b,c,d){return d=this.cfg.extend(d),c=d.kdf.execute(c,a.keySize,a.ivSize),d.iv=c.iv,a=o.encrypt.call(this,a,b,c.key,d),a.mixIn(c),a},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt),d.iv=c.iv,o.decrypt.call(this,a,b,c.key,d)}})}(),function(){for(var a=c,b=a.lib.BlockCipher,d=a.algo,e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=[],p=0;256>p;p++)o[p]=128>p?p<<1:p<<1^283;for(var q=0,r=0,p=0;256>p;p++){var s=r^r<<1^r<<2^r<<3^r<<4,s=s>>>8^255&s^99;e[q]=s,f[s]=q;var t=o[q],u=o[t],v=o[u],w=257*o[s]^16843008*s;g[q]=w<<24|w>>>8,h[q]=w<<16|w>>>16,i[q]=w<<8|w>>>24,j[q]=w,w=16843009*v^65537*u^257*t^16843008*q,k[s]=w<<24|w>>>8,l[s]=w<<16|w>>>16,m[s]=w<<8|w>>>24,n[s]=w,q?(q=t^o[o[o[v^t]]],r^=o[o[r]]):q=r=1}var x=[0,1,2,4,8,16,32,64,128,27,54],d=d.AES=b.extend({_doReset:function(){for(var a=this._key,b=a.words,c=a.sigBytes/4,a=4*((this._nRounds=c+6)+1),d=this._keySchedule=[],f=0;a>f;f++)if(c>f)d[f]=b[f];else{var g=d[f-1];f%c?c>6&&4==f%c&&(g=e[g>>>24]<<24|e[g>>>16&255]<<16|e[g>>>8&255]<<8|e[255&g]):(g=g<<8|g>>>24,g=e[g>>>24]<<24|e[g>>>16&255]<<16|e[g>>>8&255]<<8|e[255&g],g^=x[f/c|0]<<24),d[f]=d[f-c]^g}for(b=this._invKeySchedule=[],c=0;a>c;c++)f=a-c,g=c%4?d[f]:d[f-4],b[c]=4>c||4>=f?g:k[e[g>>>24]]^l[e[g>>>16&255]]^m[e[g>>>8&255]]^n[e[255&g]]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,g,h,i,j,e)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this._doCryptBlock(a,b,this._invKeySchedule,k,l,m,n,f),c=a[b+1],a[b+1]=a[b+3],a[b+3]=c},_doCryptBlock:function(a,b,c,d,e,f,g,h){for(var i=this._nRounds,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[2],m=a[b+3]^c[3],n=4,o=1;i>o;o++)var p=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],q=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],r=d[l>>>24]^e[m>>>16&255]^f[j>>>8&255]^g[255&k]^c[n++],m=d[m>>>24]^e[j>>>16&255]^f[k>>>8&255]^g[255&l]^c[n++],j=p,k=q,l=r;p=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],q=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],r=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],m=(h[m>>>24]<<24|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++],a[b]=p,a[b+1]=q,a[b+2]=r,a[b+3]=m},keySize:8});a.AES=b._createHelper(d)}(),c.mode.ECB=function(){var a=c.lib.BlockCipherMode.extend();return a.Encryptor=a.extend({processBlock:function(a,b){this._cipher.encryptBlock(a,b)}}),a.Decryptor=a.extend({processBlock:function(a,b){this._cipher.decryptBlock(a,b)}}),a}(),a.exports=c},function(a,b){a.exports={name:"pubnub",preferGlobal:!1,version:"3.15.0",author:"PubNub <support@pubnub.com>",description:"Publish & Subscribe Real-time Messaging with PubNub",contributors:[{name:"Stephen Blum",email:"stephen@pubnub.com"}],bin:{},scripts:{test:"grunt test --force"},main:"./node.js/pubnub.js",browser:"./modern/dist/pubnub.js",repository:{type:"git",url:"git://github.com/pubnub/javascript.git"},keywords:["cloud","publish","subscribe","websockets","comet","bosh","xmpp","real-time","messaging"],dependencies:{agentkeepalive:"~0.2",lodash:"^4.1.0",uuid:"^2.0.1"},noAnalyze:!1,devDependencies:{"babel-core":"^6.6.5","babel-eslint":"5.0.0","babel-plugin-transform-class-properties":"^6.6.0","babel-plugin-transform-flow-strip-types":"^6.6.5","babel-preset-es2015":"^6.6.0",chai:"3.5.0",eslint:"2.2.0","eslint-config-airbnb":"6.0.2","eslint-plugin-flowtype":"2.1.0","eslint-plugin-mocha":"2.0.0","eslint-plugin-react":"4.1.0","flow-bin":"^0.22.1",grunt:"0.4.5","grunt-babel":"6.0.0","grunt-contrib-clean":"1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.0","grunt-env":"0.4.4","grunt-eslint":"18.0.0","grunt-flow":"1.0.3","grunt-karma":"0.12.1","grunt-mocha-istanbul":"3.0.1","grunt-text-replace":"0.4.0","grunt-webpack":"1.0.11","imports-loader":"0.6.5",isparta:"4.0.0","json-loader":"0.5.4",karma:"0.13.21","karma-chai":"0.1.0","karma-mocha":"^0.2.2","karma-phantomjs-launcher":"1.0.0","karma-spec-reporter":"0.0.24","load-grunt-tasks":"^3.4.1",mocha:"2.4.5",nock:"1.1.0","node-uuid":"1.4.7",nodeunit:"0.9.0","phantomjs-prebuilt":"2.1.4",proxyquire:"1.7.4",sinon:"^1.17.3","uglify-js":"^2.6.2",underscore:"1.7.0",webpack:"^1.12.14","webpack-dev-server":"1.14.1"},bundleDependencies:[],license:"MIT",engine:{node:">=0.8"},files:["core","node.js","modern","CHANGELOG","FUTURE.md","LICENSE","README.md"]}},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){return"x"+ ++M+ +new Date}function f(){N||(N=1,L.each(O,function(a){a()}))}function g(a){var b=a||{apns:{}};return b.getPubnubMessage=function(){var a={};if(Object.keys(b.apns).length){a.pn_apns={aps:{alert:b.apns.alert,badge:b.apns.badge}};for(var c in b.apns)a.pn_apns[c]=b.apns[c];var d=["badge","alert"];for(var c in d)delete a.pn_apns[d[c]]}b.gcm&&(a.pn_gcm={data:b.gcm});for(var c in b)a[c]=b[c];var e=["apns","gcm","publish","channel","callback","error"];for(var c in e)delete a[e[c]];return a},b.publish=function(){var a=b.getPubnubMessage();b.pubnub&&b.channel&&b.pubnub.publish({message:a,channel:b.channel,callback:b.callback,error:b.error})},b}function h(a){function b(a,b){return H.encrypt(a,b||J.getCipherKey())||a}function c(a,b){return H.decrypt(a,b||J.getCipherKey())||H.decrypt(a,J.getCipherKey())||a}function d(){return clearTimeout(sa),!K.getHeartbeatInterval()||K.getHeartbeatInterval()>=500||K.getHeartbeatInterval()<1||!W.generate_channel_list(!0).length&&!W.generate_channel_group_list(!0).length?void(ta=!1):(ta=!0,void Aa.presence_heartbeat({callback:function(a){sa=L.timeout(d,K.getHeartbeatInterval()*U)},error:function(a){D&&D("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(a)),sa=L.timeout(d,K.getHeartbeatInterval()*U)}}))}function g(){!ta&&d()}function h(a){if(ua){if(!ka.length)return}else{if(a&&(ka.sending=0),ka.sending||!ka.length)return;ka.sending=1}z(ka.shift())}function j(a){var b=0;return L.each(W.generate_channel_group_list(),function(c){var d=W.getChannelGroup(c);d&&(b++,(a||function(){})(d))}),b}function l(a){var b=0;return L.each(W.generate_channel_list(),function(c){var d=W.getChannel(c);d&&(b++,(a||function(){})(d))}),b}function n(){wa()||r(1,{error:"Offline. Please check your network settings."}),M&&clearTimeout(M),M=L.timeout(n,U)}function p(){ga&&Aa.time(function(a){v(function(){},a),a||r(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),R&&clearTimeout(R),R=L.timeout(p,fa)})}function r(a,b){oa&&oa(a,b),oa=null,clearTimeout(M),clearTimeout(R)}function t(a){var b=L.rnow()-la;return b-a/1e4}function v(a,b){function c(b){if(b){var c=b/1e4,e=(L.rnow()-d)/2;la=L.rnow()-(c+e),a&&a(la)}}var d=L.rnow();b&&c(b)||Aa.time(c)}var x=a.jsonp_cb||function(){return 0},z=a.xdr,B=a.db||{get:function(){},set:function(){}},D=a.error||function(){},F=a.hmac_SHA256,H=a.crypto_obj||{encrypt:function(a,b){return a},decrypt:function(a,b){return a}},J=(new o["default"]).setInstanceId(k["default"].v4()).setAuthKey(a.auth_key||"").setSecretKey(a.secret_key||"").setSubscribeKey(a.subscribe_key).setPublishKey(a.publish_key).setCipherKey(a.cipher_key);J.setUUID(a.uuid||!a.unique_uuid&&B.get(J.getSubscribeKey()+"uuid")||k["default"].v4()),B.set(J.getSubscribeKey()+"uuid",J.getUUID());var K=(new q["default"]).setRequestIdConfig(a.use_request_id||!1).setPresenceTimeout(L.validateHeartbeat(a.heartbeat||a.pnexpires||0,D)).setInstanceIdConfig(a.instance_id||!1);K.setHeartbeatInterval(a.heartbeat_interval||K.getPresenceTimeout()/2-1);var M,R,W=new s["default"],X=new m["default"](a.xdr,J,a.ssl,a.origin).setCoreParams(a.params||{}),Y=new w["default"]({keychain:J,config:K,networking:X,jsonp_cb:x}),Z=new C["default"]({keychain:J,config:K,networking:X,jsonp_cb:x,error:D}),$=new y["default"]({keychain:J,config:K,networking:X,jsonp_cb:x,error:D}),_=new A["default"]({keychain:J,networking:X,jsonp_cb:x,error:D,decrypt:c}),aa=new E["default"]({keychain:J,config:K,networking:X,jsonp_cb:x,error:D,hmac_SHA256:F}),ba=new G["default"]({keychain:J,networking:X,jsonp_cb:x,error:D}),ca=new I["default"]({keychain:J,networking:X,config:K,jsonp_cb:x,error:D}),da=+a.windowing||Q,ea=(+a.timeout||S)*U,fa=(+a.keepalive||T)*U,ga=a.timecheck||0,ha=a.noleave||0,ia=a.ssl?"s":"",ja=function(){},ka=[],la=0,ma=0,na=0,oa=0,pa=a.restore||0,qa=0,ra=!1,sa=null,ta=!1,ua=a.no_wait_for_pending,va=a["compatible_3.5"]||!1,wa=a._is_online||function(){return 1},xa=a.shutdown,ya="undefined"!=typeof a.use_send_beacon?a.use_send_beacon:!0,za=ya?a.sendBeacon:null;2===K.getPresenceTimeout()&&K.setHeartbeatInterval(1);var Aa={history:function(a,b){_.fetchHistory(a,b)},time:function(a){Y.fetchTime(a)},here_now:function(a,b){$.hereNow(a,b)},where_now:function(a,b){$.whereNow(a,b)},presence_heartbeat:function(a){$.heartbeat(a)},state:function(a,b){$.performState(a,b)},grant:function(a,b){aa.performGrant(a,b)},audit:function(a,b){aa.performAudit(a,b)},mobile_gw_provision:function(a){Z.provisionDevice(a)},replay:function(a,b){ba.performReplay(a,b)},channel_group:function(a,b){ca.channelGroup(a,b)},channel_group_list_groups:function(a,b){ca.listGroups(a,b)},channel_group_remove_group:function(a,b){ca.removeGroup(a,b)},channel_group_list_channels:function(a,b){ca.listChannels(a,b)},channel_group_add_channel:function(a,b){ca.addChannel(a,b)},channel_group_remove_channel:function(a,b){ca.removeChannel(a,b)},LEAVE:function(a,b,c,d,e){var f,g,h={uuid:J.getUUID(),auth:c||J.getAuthKey()},i=X.nextOrigin(!1),d=d||function(){},j=e||function(){},k=x();if(a.indexOf(P)>0)return!0;if(va){if(!ia)return!1;if("0"==k)return!1}if(ha)return!1;if("0"!=k&&(h.callback=k),K.isInstanceIdEnabled()&&(h.instanceid=J.getInstanceId()),f=[i,"v2","presence","sub_key",J.getSubscribeKey(),"channel",L.encode(a),"leave"],g=X.prepareParams(h),za){var l=L.buildURL(f,g);if(za(l))return d&&d({status:200,action:"leave",message:"OK",service:"Presence"}),!0}return z({blocking:b||ia,callback:k,data:g,success:function(a){u["default"].callback(a,d,j)},fail:function(a){u["default"].error(a,j)},url:f}),!0},LEAVE_GROUP:function(a,b,c,d,e){var f,g,h={uuid:J.getUUID(),auth:c||J.getAuthKey()},i=X.nextOrigin(!1),d=d||function(){},j=e||function(){},k=x();if(a.indexOf(P)>0)return!0;if(va){if(!ia)return!1;if("0"==k)return!1}if(ha)return!1;if("0"!=k&&(h.callback=k),a&&a.length>0&&(h["channel-group"]=a),K.isInstanceIdEnabled()&&(h.instanceid=J.getInstanceId()),f=[i,"v2","presence","sub_key",J.getSubscribeKey(),"channel",L.encode(","),"leave"],g=X.prepareParams(h),za){var l=L.buildURL(f,g);if(za(l))return d&&d({status:200,action:"leave",message:"OK",service:"Presence"}),!0}return z({blocking:b||ia,callback:k,data:g,success:function(a){u["default"].callback(a,d,j)},fail:function(a){u["default"].error(a,j)},url:f}),!0},set_resumed:function(a){ra=a},get_cipher_key:function(){return J.getCipherKey()},set_cipher_key:function(a){J.setCipherKey(a)},raw_encrypt:function(a,c){return b(a,c)},raw_decrypt:function(a,b){return c(a,b)},get_heartbeat:function(){return K.getPresenceTimeout()},set_heartbeat:function(a,b){K.setPresenceTimeout(L.validateHeartbeat(a,K.getPresenceTimeout(),D)),K.setHeartbeatInterval(b||K.getPresenceTimeout()/2-1),2==K.getPresenceTimeout()&&K.setHeartbeatInterval(1),ja(),d()},get_heartbeat_interval:function(){return K.getHeartbeatInterval()},set_heartbeat_interval:function(a){K.setHeartbeatInterval(a),d()},get_version:function(){return V},getGcmMessageObject:function(a){return{data:a}},getApnsMessageObject:function(a){var b={aps:{badge:1,alert:""}};for(var c in a)c[b]=a[c];return b},_add_param:function(a,b){X.addCoreParam(a,b)},auth:function(a){J.setAuthKey(a),ja()},publish:function(a,c){var d=a.message;if(!d)return D("Missing Message");var e,c=c||a.callback||d.callback||a.success||function(){},f=a.channel||d.channel,g=a.auth_key||J.getAuthKey(),i=a.cipher_key,j=a.error||d.error||function(){},k=a.post||!1,l="store_in_history"in a?a.store_in_history:!0,m=x(),n="push",o={uuid:J.getUUID(),auth:g};return a.prepend&&(n="unshift"),f?J.getPublishKey()?J.getSubscribeKey()?(d.getPubnubMessage&&(d=d.getPubnubMessage()),d=JSON.stringify(b(d,i)),e=[X.getStandardOrigin(),"publish",J.getPublishKey(),J.getSubscribeKey(),0,L.encode(f),m,L.encode(d)],l||(o.store="0"),K.isInstanceIdEnabled()&&(o.instanceid=J.getInstanceId()),ka[n]({callback:m,url:e,data:X.prepareParams(o),fail:function(a){u["default"].error(a,j),h(1)},success:function(a){u["default"].callback(a,c,j),h(1)},mode:k?"POST":"GET"}),void h()):D("Missing Subscribe Key"):D("Missing Publish Key"):D("Missing Channel")},unsubscribe:function(a,b){var c=a.channel,d=a.channel_group,e=a.auth_key||J.getAuthKey(),b=b||a.callback||function(){},f=a.error||function(){};if(qa=0,pa=1,!c&&!d)return D("Missing Channel or Channel Group");if(!J.getSubscribeKey())return D("Missing Subscribe Key");if(c){var g=L.isArray(c)?c:(""+c).split(","),h=[],i=[];if(L.each(g,function(a){W.getChannel(a)&&h.push(a)}),0==h.length)return void b({action:"leave"});L.each(h,function(a){i.push(a+P)}),L.each(h.concat(i),function(a){W.containsChannel(a)&&W.addChannel(a,0),W.isInPresenceState(a)&&W.removeFromPresenceState(a)});var j=!0;N&&(j=Aa.LEAVE(h.join(","),0,e,b,f)),j||b({action:"leave"})}if(d){var k=L.isArray(d)?d:(""+d).split(","),l=[],m=[];if(L.each(k,function(a){W.getChannelGroup(a)&&l.push(a)}),0==l.length)return void b({action:"leave"});L.each(l,function(a){m.push(a+P)}),L.each(l.concat(m),function(a){W.containsChannelGroup(a)&&W.addChannelGroup(a,0),W.isInPresenceState(a)&&W.removeFromPresenceState(a)});var j=!0;N&&(j=Aa.LEAVE_GROUP(l.join(","),0,e,b,f)),j||b({action:"leave"})}ja()},subscribe:function(a,b){function d(a){a?L.timeout(ja,A):(X.shiftStandardOrigin(!0),
X.shiftSubscribeOrigin(!0),L.timeout(function(){Aa.time(d)},U)),l(function(b){return a&&b.disconnected?(b.disconnected=0,b.reconnect(b.name)):void(a||b.disconnected||(b.disconnected=1,b.disconnect(b.name)))}),j(function(b){return a&&b.disconnected?(b.disconnected=0,b.reconnect(b.name)):void(a||b.disconnected||(b.disconnected=1,b.disconnect(b.name)))})}function e(){var a=x(),b=W.generate_channel_list().join(","),f=W.generate_channel_group_list().join(",");if(b||f){b||(b=","),r();var h=X.prepareParams({uuid:J.getUUID(),auth:J.getAuthKey()});f&&(h["channel-group"]=f);var k=JSON.stringify(W.getPresenceState());k.length>2&&(h.state=JSON.stringify(W.getPresenceState())),K.getPresenceTimeout()&&(h.heartbeat=K.getPresenceTimeout()),K.isInstanceIdEnabled()&&(h.instanceid=J.getInstanceId()),g(),oa=z({timeout:y,callback:a,fail:function(a){a&&a.error&&a.service?(u["default"].error(a,o),d(!1)):Aa.time(function(b){!b&&u["default"].error(a,o),d(b)})},data:X.prepareParams(h),url:[X.getSubscribeOrigin(),"subscribe",J.getSubscribeKey(),L.encode(b),a,qa],success:function(a){if(!a||"object"==("undefined"==typeof a?"undefined":i(a))&&"error"in a&&a.error)return o(a),L.timeout(ja,U);if(p(a[1]),qa=!qa&&pa&&B.get(J.getSubscribeKey())||a[1],l(function(a){a.connected||(a.connected=1,a.connect(a.name))}),j(function(a){a.connected||(a.connected=1,a.connect(a.name))}),ra&&!pa)return qa=0,ra=!1,B.set(J.getSubscribeKey(),0),void L.timeout(e,A);v&&(qa=1e4,v=0),B.set(J.getSubscribeKey(),a[1]);var b=function(){var b="",c="";a.length>3?(b=a[3],c=a[2]):b=a.length>2?a[2]:L.map(W.generate_channel_list(),function(b){return L.map(Array(a[0].length).join(",").split(","),function(){return b})}).join(",");var d=b.split(","),e=c?c.split(","):[];return function(){var a=d.shift()||na,b=e.shift(),c={};b?(a&&a.indexOf("-pnpres")>=0&&b.indexOf("-pnpres")<0&&(b+="-pnpres"),c=W.getChannelGroup(b)||W.getChannel(b)||{callback:function(){}}):c=W.getChannel(a);var f=[c.callback||ma,a.split(P)[0]];return b&&f.push(b.split(P)[0]),f}}(),d=t(+a[1]);L.each(a[0],function(e){var f=b(),g=c(e,W.getChannel(f[1])?W.getChannel(f[1]).cipher_key:null);f[0]&&f[0](g,a,f[2]||f[1],d,f[1])}),L.timeout(e,A)}})}}var f=a.channel,h=a.channel_group,b=b||a.callback,b=b||a.message,k=a.connect||function(){},m=a.reconnect||function(){},n=a.disconnect||function(){},o=a.error||o||function(){},p=a.idle||function(){},q=a.presence||0,s=a.noheresync||0,v=a.backfill||0,w=a.timetoken||0,y=a.timeout||ea,A=a.windowing||da,C=a.state,E=a.heartbeat||a.pnexpires,F=a.heartbeat_interval,G=a.restore||pa;return J.setAuthKey(a.auth_key||J.getAuthKey()),pa=G,qa=w,f||h?b?J.getSubscribeKey()?((E||0===E||F||0===F)&&Aa.set_heartbeat(E,F),f&&L.each((f.join?f.join(","):""+f).split(","),function(c){var d=W.getChannel(c)||{};W.addChannel(na=c,{name:c,connected:d.connected,disconnected:d.disconnected,subscribed:1,callback:ma=b,cipher_key:a.cipher_key,connect:k,disconnect:n,reconnect:m}),C&&(c in C?W.addToPresenceState(c,C[c]):W.addToPresenceState(c,C)),q&&(Aa.subscribe({channel:c+P,callback:q,restore:G}),d.subscribed||s||Aa.here_now({channel:c,data:X.prepareParams({uuid:J.getUUID(),auth:J.getAuthKey()}),callback:function(a){L.each("uuids"in a?a.uuids:[],function(b){q({action:"join",uuid:b,timestamp:Math.floor(L.rnow()/1e3),occupancy:a.occupancy||1},a,c)})}}))}),h&&L.each((h.join?h.join(","):""+h).split(","),function(c){var d=W.getChannelGroup(c)||{};W.addChannelGroup(c,{name:c,connected:d.connected,disconnected:d.disconnected,subscribed:1,callback:ma=b,cipher_key:a.cipher_key,connect:k,disconnect:n,reconnect:m}),q&&(Aa.subscribe({channel_group:c+P,callback:q,restore:G,auth_key:J.getAuthKey()}),d.subscribed||s||Aa.here_now({channel_group:c,data:X.prepareParams({uuid:J.getUUID(),auth:J.getAuthKey()}),callback:function(a){L.each("uuids"in a?a.uuids:[],function(b){q({action:"join",uuid:b,timestamp:Math.floor(L.rnow()/1e3),occupancy:a.occupancy||1},a,c)})}}))}),ja=function(){r(),L.timeout(e,A)},N?void ja():O.push(ja)):D("Missing Subscribe Key"):D("Missing Callback"):D("Missing Channel")},revoke:function(a,b){a.read=!1,a.write=!1,Aa.grant(a,b)},set_uuid:function(a){J.setUUID(a),ja()},get_uuid:function(){return J.getUUID()},isArray:function(a){return L.isArray(a)},get_subscribed_channels:function(){return W.generate_channel_list(!0)},stop_timers:function(){clearTimeout(M),clearTimeout(R),clearTimeout(sa)},shutdown:function(){Aa.stop_timers(),xa&&xa()},xdr:z,ready:f,db:B,uuid:L.generateUUID,map:L.map,each:L.each,"each-channel":l,grep:L.grep,offline:function(){r(1,{message:"Offline. Please check your network settings."})},supplant:L.supplant,now:L.rnow,unique:e,updater:L.updater};return M=L.timeout(n,U),R=L.timeout(p,fa),sa=L.timeout(g,(K.getHeartbeatInterval()-3)*U),v(),Aa}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},j=c(6),k=d(j),l=c(8),m=d(l),n=c(9),o=d(n),p=c(12),q=d(p),r=c(13),s=d(r),t=c(14),u=d(t),v=c(34),w=d(v),x=c(35),y=d(x),z=c(36),A=d(z),B=c(37),C=d(B),D=c(38),E=d(D),F=c(39),G=d(F),H=c(40),I=d(H),J=c(4),K=c(11),L=c(10),M=1,N=!1,O=[],P="-pnpres",Q=10,R=15e3,S=310,T=60,U=1e3,V=J.version;a.exports={PN_API:h,unique:e,PNmessage:g,DEF_TIMEOUT:R,timeout:L.timeout,build_url:L.buildURL,each:L.each,uuid:L.generateUUID,URLBIT:K.URLBIT,grep:L.grep,supplant:L.supplant,now:L.rnow,updater:L.updater,map:L.map}},function(a,b,c){function d(a,b,c){var d=b&&c||0,e=0;for(b=b||[],a.toLowerCase().replace(/[0-9a-f]{2}/g,function(a){16>e&&(b[d+e++]=j[a])});16>e;)b[d+e++]=0;return b}function e(a,b){var c=b||0,d=i;return d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]}function f(a,b,c){var d=b&&c||0,f=b||[];a=a||{};var g=void 0!==a.clockseq?a.clockseq:n,h=void 0!==a.msecs?a.msecs:(new Date).getTime(),i=void 0!==a.nsecs?a.nsecs:p+1,j=h-o+(i-p)/1e4;if(0>j&&void 0===a.clockseq&&(g=g+1&16383),(0>j||h>o)&&void 0===a.nsecs&&(i=0),i>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");o=h,p=i,n=g,h+=122192928e5;var k=(1e4*(268435455&h)+i)%4294967296;f[d++]=k>>>24&255,f[d++]=k>>>16&255,f[d++]=k>>>8&255,f[d++]=255&k;var l=h/4294967296*1e4&268435455;f[d++]=l>>>8&255,f[d++]=255&l,f[d++]=l>>>24&15|16,f[d++]=l>>>16&255,f[d++]=g>>>8|128,f[d++]=255&g;for(var q=a.node||m,r=0;6>r;r++)f[d+r]=q[r];return b?b:e(f)}function g(a,b,c){var d=b&&c||0;"string"==typeof a&&(b="binary"==a?new Array(16):null,a=null),a=a||{};var f=a.random||(a.rng||h)();if(f[6]=15&f[6]|64,f[8]=63&f[8]|128,b)for(var g=0;16>g;g++)b[d+g]=f[g];return b||e(f)}for(var h=c(7),i=[],j={},k=0;256>k;k++)i[k]=(k+256).toString(16).substr(1),j[i[k]]=k;var l=h(),m=[1|l[0],l[1],l[2],l[3],l[4],l[5]],n=16383&(l[6]<<8|l[7]),o=0,p=0,q=g;q.v1=f,q.v4=g,q.parse=d,q.unparse=e,a.exports=q},function(a,b){(function(b){var c;if(b.crypto&&crypto.getRandomValues){var d=new Uint8Array(16);c=function(){return crypto.getRandomValues(d),d}}if(!c){var e=new Array(16);c=function(){for(var a,b=0;16>b;b++)0===(3&b)&&(a=4294967296*Math.random()),e[b]=a>>>((3&b)<<3)&255;return e}}a.exports=c}).call(b,function(){return this}())},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(9),h=(d(g),c(10)),i=function(){function a(b,c){var d=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],f=arguments.length<=3||void 0===arguments[3]?"pubsub.pubnub.com":arguments[3];e(this,a),this._xdr=b,this._keychain=c,this._maxSubDomain=20,this._currentSubDomain=Math.floor(Math.random()*this._maxSubDomain),this._providedFQDN=(d?"https://":"http://")+f,this._coreParams={},this.shiftStandardOrigin(!1),this.shiftSubscribeOrigin(!1)}return f(a,[{key:"setCoreParams",value:function(a){return this._coreParams=a,this}},{key:"addCoreParam",value:function(a,b){this._coreParams[a]=b}},{key:"prepareParams",value:function(a){return a||(a={}),h.each(this._coreParams,function(b,c){b in a||(a[b]=c)}),a}},{key:"nextOrigin",value:function(a){if(-1===this._providedFQDN.indexOf("pubsub."))return this._providedFQDN;var b=void 0;return a?b=h.generateUUID().split("-")[0]:(this._currentSubDomain=this._currentSubDomain+1,this._currentSubDomain>=this._maxSubDomain&&(this._currentSubDomain=1),b=this._currentSubDomain.toString()),this._providedFQDN.replace("pubsub","ps"+b)}},{key:"shiftStandardOrigin",value:function(){var a=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];return this._standardOrigin=this.nextOrigin(a),this._standardOrigin}},{key:"shiftSubscribeOrigin",value:function(){var a=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];return this._subscribeOrigin=this.nextOrigin(a),this._subscribeOrigin}},{key:"fetchHistory",value:function(a,b){var c=b.data,d=b.callback,e=b.success,f=b.fail,g=[this.getStandardOrigin(),"v2","history","sub-key",this._keychain.getSubscribeKey(),"channel",h.encode(a)];this._xdr({data:c,callback:d,success:e,fail:f,url:g})}},{key:"performChannelGroupOperation",value:function(a,b,c){var d=c.data,e=c.callback,f=c.success,g=c.fail,h=[this.getStandardOrigin(),"v1","channel-registration","sub-key",this._keychain.getSubscribeKey(),"channel-group"];a&&"*"!==a&&h.push(a),"remove"===b&&h.push("remove"),this._xdr({data:d,callback:e,success:f,fail:g,url:h})}},{key:"provisionDeviceForPush",value:function(a,b){var c=b.data,d=b.callback,e=b.success,f=b.fail,g=[this.getStandardOrigin(),"v1","push","sub-key",this._keychain.getSubscribeKey(),"devices",a];this._xdr({data:c,callback:d,success:e,fail:f,url:g})}},{key:"performGrant",value:function(a){var b=a.data,c=a.callback,d=a.success,e=a.fail,f=[this.getStandardOrigin(),"v1","auth","grant","sub-key",this._keychain.getSubscribeKey()];this._xdr({data:b,callback:c,success:d,fail:e,url:f})}},{key:"performHeartbeat",value:function(a,b){var c=b.data,d=b.callback,e=b.success,f=b.fail,g=[this.getStandardOrigin(),"v2","presence","sub-key",this._keychain.getSubscribeKey(),"channel",a,"heartbeat"];this._xdr({data:c,callback:d,success:e,fail:f,url:g})}},{key:"performState",value:function(a,b,c,d){var e=d.data,f=d.callback,g=d.success,i=d.fail,j=[this.getStandardOrigin(),"v2","presence","sub-key",this._keychain.getSubscribeKey(),"channel",b];a?j.push("uuid",c,"data"):j.push("uuid",h.encode(c)),this._xdr({data:e,callback:f,success:g,fail:i,url:j})}},{key:"performAudit",value:function(a){var b=a.data,c=a.callback,d=a.success,e=a.fail,f=[this.getStandardOrigin(),"v1","auth","audit","sub-key",this._keychain.getSubscribeKey()];this._xdr({data:b,callback:c,success:d,fail:e,url:f})}},{key:"fetchReplay",value:function(a,b,c){var d=c.data,e=c.callback,f=c.success,g=c.fail,h=[this.getStandardOrigin(),"v1","replay",this._keychain.getPublishKey(),this._keychain.getSubscribeKey(),a,b];this._xdr({data:d,callback:e,success:f,fail:g,url:h})}},{key:"fetchTime",value:function(a,b){var c=b.data,d=b.callback,e=b.success,f=b.fail,g=[this.getStandardOrigin(),"time",a];this._xdr({data:c,callback:d,success:e,fail:f,url:g})}},{key:"fetchWhereNow",value:function(a,b){var c=b.data,d=b.callback,e=b.success,f=b.fail,g=[this.getStandardOrigin(),"v2","presence","sub_key",this._keychain.getSubscribeKey(),"uuid",h.encode(a)];this._xdr({data:c,callback:d,success:e,fail:f,url:g})}},{key:"fetchHereNow",value:function(a,b,c){var d=c.data,e=c.callback,f=c.success,g=c.fail,i=[this.getStandardOrigin(),"v2","presence","sub_key",this._keychain.getSubscribeKey()];a&&(i.push("channel"),i.push(h.encode(a))),b&&!a&&(i.push("channel"),i.push(",")),this._xdr({data:d,callback:e,success:f,fail:g,url:i})}},{key:"getOrigin",value:function(){return this._providedFQDN}},{key:"getStandardOrigin",value:function(){return this._standardOrigin}},{key:"getSubscribeOrigin",value:function(){return this._subscribeOrigin}}]),a}();b["default"]=i},function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(){function a(){c(this,a)}return d(a,[{key:"setUUID",value:function(a){return this._UUID=a,this}},{key:"setCipherKey",value:function(a){return this._cipherKey=a,this}},{key:"setSubscribeKey",value:function(a){return this._subscribeKey=a,this}},{key:"setPublishKey",value:function(a){return this._publishKey=a,this}},{key:"setAuthKey",value:function(a){return this._authKey=a,this}},{key:"setInstanceId",value:function(a){return this._instanceId=a,this}},{key:"setSecretKey",value:function(a){return this._secretKey=a,this}},{key:"getCipherKey",value:function(){return this._cipherKey}},{key:"getSubscribeKey",value:function(){return this._subscribeKey}},{key:"getPublishKey",value:function(){return this._publishKey}},{key:"getAuthKey",value:function(){return this._authKey}},{key:"getInstanceId",value:function(){return this._instanceId}},{key:"getSecretKey",value:function(){return this._secretKey}},{key:"getUUID",value:function(){return this._UUID}}]),a}();b["default"]=e},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(){return+new Date}function f(a){return!!a&&"string"!=typeof a&&(Array.isArray&&Array.isArray(a)||"number"==typeof a.length)}function g(a,b){if(a&&b)if(f(a))for(var c=0,d=a.length;d>c;)b.call(a[c],a[c],c++);else for(var c in a)a.hasOwnProperty&&a.hasOwnProperty(c)&&b.call(a[c],c,a[c])}function h(a){return encodeURIComponent(a)}function i(a,b){var c=a.join(x.URLBIT),d=[];return b?(g(b,function(a,b){var c="object"===("undefined"==typeof b?"undefined":u(b))?JSON.stringify(b):b;"undefined"!=typeof b&&null!==b&&h(c).length>0&&d.push(a+"="+h(c))}),c+="?"+d.join(x.PARAMSBIT)):c}function j(a,b){var c,d=0,f=function g(){d+b>e()?(clearTimeout(c),c=setTimeout(g,b)):(d=e(),a())};return f}function k(a,b){var c=[];return g(a||[],function(a){b(a)&&c.push(a)}),c}function l(a,b){return a.replace(y,function(a,c){return b[c]||a})}function m(a,b){return"undefined"!=typeof setTimeout?setTimeout(a,b):void 0}function n(a){var b=w["default"].v4();return a&&a(b),b}function o(a,b){var c=[];return g(a||[],function(a,d){c.push(b(a,d))}),c}function p(a){return encodeURIComponent(a).replace(/[!'()*~]/g,function(a){return"%"+a.charCodeAt(0).toString(16).toUpperCase()})}function q(a){var b=[];return g(a,function(a){b.push(a)}),b}function r(a){return q(a).sort()}function s(a){var b=r(a);return o(b,function(b){return b+"="+p(a[b])}).join("&")}function t(a,b,c){var d=!1;if("undefined"==typeof a)return b;if("number"==typeof a)d=!(a>x._minimumHeartbeatInterval||0===a);else{if("boolean"==typeof a)return a?x._defaultHeartbeatInterval:0;d=!0}if(d){if(c){var e="Presence Heartbeat value invalid. Valid range ( x >";e+=x._minimumHeartbeatInterval+" or x = 0). Current Value : ",e+=b||x._minimumHeartbeatInterval,c(e)}return b||x._minimumHeartbeatInterval}return a}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},v=c(6),w=d(v),x=c(11),y=/{([\w\-]+)}/g;a.exports={buildURL:i,encode:h,each:g,updater:j,rnow:e,isArray:f,map:o,pamEncode:p,generateUUID:n,timeout:m,supplant:l,grep:k,_get_pam_sign_input_from_params:s,_object_to_key_list_sorted:r,_object_to_key_list:q,validateHeartbeat:t}},function(a,b){a.exports={PARAMSBIT:"&",URLBIT:"/",defaultHeartbeatInterval:30,minimumHeartbeatInterval:5}},function(a,b){"use strict";function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(){function a(){c(this,a),this._instanceId=!1,this._requestId=!1}return d(a,[{key:"setInstanceIdConfig",value:function(a){return this._instanceId=a,this}},{key:"setRequestIdConfig",value:function(a){return this._requestId=a,this}},{key:"setHeartbeatInterval",value:function(a){return this._heartbeatInterval=a,this}},{key:"setPresenceTimeout",value:function(a){return this._presenceTimeout=a,this}},{key:"isInstanceIdEnabled",value:function(){return this._instanceId}},{key:"isRequestIdEnabled",value:function(){return this._requestId}},{key:"getHeartbeatInterval",value:function(){return this._heartbeatInterval}},{key:"getPresenceTimeout",value:function(){return this._presenceTimeout}}]),a}();b["default"]=e},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(10),h=d(g),i=function(){function a(){e(this,a),this._channelStorage={},this._channelGroupStorage={},this._presenceState={}}return f(a,[{key:"containsChannel",value:function(a){return a in this._channelStorage}},{key:"containsChannelGroup",value:function(a){return a in this._channelGroupStorage}},{key:"getChannel",value:function(a){return this._channelStorage[a]}},{key:"getChannelGroup",value:function(a){return this._channelGroupStorage[a]}},{key:"addChannel",value:function(a,b){this._channelStorage[a]=b}},{key:"addChannelGroup",value:function(a,b){this._channelGroupStorage[a]=b}},{key:"addToPresenceState",value:function(a,b){this._presenceState[a]=b}},{key:"isInPresenceState",value:function(a){return a in this._presenceState}},{key:"removeFromPresenceState",value:function(a){delete this._presenceState[a]}},{key:"getPresenceState",value:function(){return this._presenceState}},{key:"generate_channel_list",value:function(a){var b=[];return h["default"].each(this._channelStorage,function(c,d){a?c.search("-pnpres")<0&&d.subscribed&&b.push(c):d.subscribed&&b.push(c)}),b.sort()}},{key:"generate_channel_group_list",value:function(a){var b=[];return h["default"].each(this._channelGroupStorage,function(c,d){a?c.search("-pnpres")<0&&d.subscribed&&b.push(c):d.subscribed&&b.push(c)}),b.sort()}}]),a}();b["default"]=i},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c(15),i=d(h),j=function(){function a(){e(this,a)}return g(a,null,[{key:"callback",value:function(a,b,c){if("object"===("undefined"==typeof a?"undefined":f(a))){if(a.error){var d=(0,i["default"])(a,["message","payload"]);return void(c&&c(d))}if(a.payload)return void(a.next_page?b&&b(a.payload,a.next_page):b&&b(a.payload))}b&&b(a)}},{key:"error",value:function(a,b){if("object"===("undefined"==typeof a?"undefined":f(a))&&a.error){var c=(0,i["default"])(a,["message","payload"]);if(b)return b(c)}else if(b)return b(a)}}]),a}();b["default"]=j},function(a,b,c){var d=c(16),e=c(28),f=c(30),g=f(function(a,b){return null==a?{}:e(a,d(b,1))});a.exports=g},function(a,b,c){function d(a,b,c,i){i||(i=[]);for(var j=-1,k=a.length;++j<k;){var l=a[j];b>0&&h(l)&&(c||g(l)||f(l))?b>1?d(l,b-1,c,i):e(i,l):c||(i[i.length]=l)}return i}var e=c(17),f=c(18),g=c(27),h=c(19);a.exports=d},function(a,b){function c(a,b){for(var c=-1,d=b.length,e=a.length;++c<d;)a[e+c]=b[c];return a}a.exports=c},function(a,b,c){function d(a){return e(a)&&h.call(a,"callee")&&(!j.call(a,"callee")||i.call(a)==f)}var e=c(19),f="[object Arguments]",g=Object.prototype,h=g.hasOwnProperty,i=g.toString,j=g.propertyIsEnumerable;a.exports=d},function(a,b,c){function d(a){return f(a)&&e(a)}var e=c(20),f=c(26);a.exports=d},function(a,b,c){function d(a){return null!=a&&g(e(a))&&!f(a)}var e=c(21),f=c(23),g=c(25);a.exports=d},function(a,b,c){var d=c(22),e=d("length");a.exports=e},function(a,b){function c(a){return function(b){return null==b?void 0:b[a]}}a.exports=c},function(a,b,c){function d(a){var b=e(a)?i.call(a):"";return b==f||b==g}var e=c(24),f="[object Function]",g="[object GeneratorFunction]",h=Object.prototype,i=h.toString;a.exports=d},function(a,b){function c(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}a.exports=c},function(a,b){function c(a){return"number"==typeof a&&a>-1&&a%1==0&&d>=a}var d=9007199254740991;a.exports=c},function(a,b){function c(a){return!!a&&"object"==typeof a}a.exports=c},function(a,b){var c=Array.isArray;a.exports=c},function(a,b,c){function d(a,b){return a=Object(a),e(b,function(b,c){return c in a&&(b[c]=a[c]),b},{})}var e=c(29);a.exports=d},function(a,b){function c(a,b,c,d){var e=-1,f=a.length;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}a.exports=c},function(a,b,c){function d(a,b){if("function"!=typeof a)throw new TypeError(g);return b=h(void 0===b?a.length-1:f(b),0),function(){for(var c=arguments,d=-1,f=h(c.length-b,0),g=Array(f);++d<f;)g[d]=c[b+d];switch(b){case 0:return a.call(this,g);case 1:return a.call(this,c[0],g);case 2:return a.call(this,c[0],c[1],g)}var i=Array(b+1);for(d=-1;++d<b;)i[d]=c[d];return i[b]=g,e(a,this,i)}}var e=c(31),f=c(32),g="Expected a function",h=Math.max;a.exports=d},function(a,b){function c(a,b,c){var d=c.length;switch(d){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}a.exports=c},function(a,b,c){function d(a){if(!a)return 0===a?a:0;if(a=e(a),a===f||a===-f){var b=0>a?-1:1;return b*g}var c=a%1;return a===a?c?a-c:a:0}var e=c(33),f=1/0,g=1.7976931348623157e308;a.exports=d},function(a,b,c){function d(a){if(f(a)){var b=e(a.valueOf)?a.valueOf():a;a=f(b)?b+"":b}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(h,"");var c=j.test(a);return c||k.test(a)?l(a.slice(2),c?2:8):i.test(a)?g:+a}var e=c(23),f=c(24),g=NaN,h=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,j=/^0b[01]+$/i,k=/^0o[0-7]+$/i,l=parseInt;a.exports=d},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(8),h=(d(g),c(12)),i=(d(h),c(9)),j=(d(i),function(){function a(b){var c=b.networking,d=b.config,f=b.keychain,g=b.jsonp_cb;e(this,a),this._networking=c,this._config=d,this._keychain=f,this._jsonp_cb=g}return f(a,[{key:"fetchTime",value:function(a){var b=this._jsonp_cb(),c={uuid:this._keychain.getUUID(),auth:this._keychain.getAuthKey()};this._config.isInstanceIdEnabled()&&(c.instanceid=this._keychain.getInstanceId());var d=function(b){a(b[0])},e=function(){a(0)};this._networking.fetchTime(b,{callback:b,data:this._networking.prepareParams(c),success:d,fail:e})}}]),a}());b["default"]=j},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(8),h=(d(g),c(12)),i=(d(h),c(9)),j=(d(i),c(13)),k=(d(j),c(14)),l=d(k),m=c(10),n=d(m),o=function(){function a(b){var c=b.networking,d=b.config,f=b.keychain,g=b.state,h=b.jsonp_cb,i=b.error;e(this,a),this._networking=c,this._config=d,this._keychain=f,this._state=g,this._jsonp_cb=h,this._error=i}return f(a,[{key:"hereNow",value:function(a,b){var c=a.callback||b,d=a.error||function(){},e=a.auth_key||this._keychain.getAuthKey(),f=a.channel,g=a.channel_group,h=this._jsonp_cb(),i="uuids"in a?a.uuids:!0,j=a.state,k={uuid:this._keychain.getUUID(),auth:e};return i||(k.disable_uuids=1),j&&(k.state=1),c?this._keychain.getSubscribeKey()?(0!==h&&(k.callback=h),g&&(k["channel-group"]=g),this._config.isInstanceIdEnabled()&&(k.instanceid=this._keychain.getInstanceId()),void this._networking.fetchHereNow(f,g,{callback:h,data:this._networking.prepareParams(k),success:function(a){l["default"].callback(a,c,d)},fail:function(a){l["default"].error(a,d)}})):this._error("Missing Subscribe Key"):this._error("Missing Callback")}},{key:"whereNow",value:function(a,b){var c=a.callback||b,d=a.error||function(){},e=a.auth_key||this._keychain.getAuthKey(),f=this._jsonp_cb(),g=a.uuid||this._keychain.getUUID(),h={auth:e};return c?this._keychain.getSubscribeKey()?(0!==f&&(h.callback=f),this._config.isInstanceIdEnabled()&&(h.instanceid=this._keychain.getInstanceId()),void this._networking.fetchWhereNow(g,{callback:f,data:this._networking.prepareParams(h),success:function(a){l["default"].callback(a,c,d)},fail:function(a){l["default"].error(a,d)}})):this._error("Missing Subscribe Key"):this._error("Missing Callback")}},{key:"heartbeat",value:function(a){var b=a.callback||function(){},c=a.error||function(){},d=this._jsonp_cb(),e={uuid:this._keychain.getUUID(),auth:this._keychain.getAuthKey()},f=JSON.stringify(this._state.getPresenceState());f.length>2&&(e.state=JSON.stringify(this._state.getPresenceState())),this._config.getPresenceTimeout()>0&&this._config.getPresenceTimeout()<320&&(e.heartbeat=this._config.getPresenceTimeout()),0!==d&&(e.callback=d);var g=n["default"].encode(this._state.generate_channel_list(!0).join(",")),h=this._state.generate_channel_group_list(!0).join(",");g||(g=","),h&&(e["channel-group"]=h),this._config.isInstanceIdEnabled()&&(e.instanceid=this._keychain.getInstanceId()),this._config.isRequestIdEnabled()&&(e.requestid=n["default"].generateUUID()),this._networking.performHeartbeat(g,{callback:d,data:this._networking.prepareParams(e),success:function(a){l["default"].callback(a,b,c)},fail:function(a){l["default"].error(a,c)}})}},{key:"performState",value:function(a,b){var c=a.callback||b||function(){},d=a.error||function(){},e=a.auth_key||this._keychain.getAuthKey(),f=this._jsonp_cb(),g=a.state,h=a.uuid||this._keychain.getUUID(),i=a.channel,j=a.channel_group,k=this._networking.prepareParams({auth:e});return this._keychain.getSubscribeKey()?h?i||j?(0!==f&&(k.callback=f),"undefined"!=typeof i&&this._state.getChannel(i)&&this._state.getChannel(i).subscribed&&g&&this._state.addToPresenceState(i,g),"undefined"!=typeof j&&this._state.getChannelGroup(j)&&this._state.getChannelGroup(j).subscribed&&(g&&this._state.addToPresenceState(j,g),k["channel-group"]=j,i||(i=",")),k.state=JSON.stringify(g),this._config.isInstanceIdEnabled()&&(k.instanceid=this._keychain.getInstanceId()),void this._networking.performState(g,i,h,{callback:f,data:this._networking.prepareParams(k),success:function(a){l["default"].callback(a,c,d)},fail:function(a){l["default"].error(a,d)}})):this._error("Missing Channel"):this._error("Missing UUID"):this._error("Missing Subscribe Key")}}]),a}();b["default"]=o},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol?"symbol":typeof a},g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c(8),i=(d(h),c(9)),j=(d(i),c(14)),k=d(j),l=function(){function a(b){var c=b.networking,d=b.keychain,f=b.jsonp_cb,g=b.error,h=b.decrypt;e(this,a),this._networking=c,this._keychain=d,this._jsonp_cb=f,this._error=g,this._decrypt=h}return g(a,[{key:"fetchHistory",value:function(a,b){var c=this,d=a.callback||b,e=a.count||a.limit||100,f=a.reverse||"false",g=a.error||function(){},h=a.auth_key||this._keychain.getAuthKey(),i=a.cipher_key,j=a.channel,l=a.channel_group,m=a.start,n=a.end,o=a.include_token,p=a.string_message_token||!1,q=this._jsonp_cb();if(!j&&!l)return this._error("Missing Channel");if(!d)return this._error("Missing Callback");if(!this._keychain.getSubscribeKey())return this._error("Missing Subscribe Key");var r={stringtoken:"true",count:e,reverse:f,auth:h};l&&(r["channel-group"]=l,j||(j=",")),q&&(r.callback=q),m&&(r.start=m),n&&(r.end=n),o&&(r.include_token="true"),p&&(r.string_message_token="true"),this._networking.fetchHistory(j,{callback:q,data:this._networking.prepareParams(r),success:function(a){c._handleHistoryResponse(a,g,d,o,i)},fail:function(a){k["default"].error(a,g)}})}},{key:"_handleHistoryResponse",value:function(a,b,c,d,e){if("object"===("undefined"==typeof a?"undefined":f(a))&&a.error)return void b({message:a.message,payload:a.payload});for(var g=a[0],h=[],i=0;i<g.length;i++)if(d){var j=this._decrypt(g[i].message,e),k=g[i].timetoken;try{h.push({message:JSON.parse(j),timetoken:k})}catch(l){h.push({message:j,timetoken:k})}}else{var m=this._decrypt(g[i],e);try{h.push(JSON.parse(m))}catch(l){h.push(m)}}c([h,a[1],a[2]])}}]),a}();b["default"]=l},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(8),h=(d(g),c(9)),i=(d(h),c(12)),j=(d(i),c(14)),k=d(j),l=function(){function a(b){var c=b.networking,d=b.keychain,f=b.jsonp_cb,g=b.error,h=b.config;e(this,a),this._networking=c,this._keychain=d,this._jsonp_cb=f,this._error=g,this._config=h}return f(a,[{key:"provisionDevice",value:function(a){var b=a.op,c=a.gw_type,d=a.device_id,e=a.channel,f=a.callback||function(){},g=a.auth_key||this._keychain.getAuthKey(),h=a.error||function(){},i=this._jsonp_cb();if(!d)return this._error("Missing Device ID (device_id)");if(!c)return this._error("Missing GW Type (gw_type: gcm or apns)");if(!b)return this._error("Missing GW Operation (op: add or remove)");if(!e)return this._error("Missing gw destination Channel (channel)");if(!this._keychain.getPublishKey())return this._error("Missing Publish Key");if(!this._keychain.getSubscribeKey())return this._error("Missing Subscribe Key");var j={uuid:this._keychain.getUUID(),auth:g,type:c};"add"===b?j.add=e:"remove"===b&&(j.remove=e),this._config.isInstanceIdEnabled()&&(j.instanceid=this._keychain.getInstanceId()),
this._networking.provisionDeviceForPush(d,{callback:i,data:j,success:function(a){k["default"].callback(a,f,h)},fail:function(a){k["default"].error(a,h)}})}}]),a}();b["default"]=l},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(8),h=(d(g),c(12)),i=(d(h),c(9)),j=(d(i),c(14)),k=d(j),l=c(10),m=d(l),n=function(){function a(b){var c=b.networking,d=b.config,f=b.keychain,g=b.jsonp_cb,h=b.error,i=b.hmac_SHA256;e(this,a),this._networking=c,this._keychain=f,this._config=d,this._jsonp_cb=g,this._error=h,this._hmac_SHA256=i}return f(a,[{key:"performGrant",value:function(a,b){var c=a.callback||b,d=a.error||function(){},e=a.channel||a.channels,f=a.channel_group,g=this._jsonp_cb(),h=a.ttl,i=a.read?"1":"0",j=a.write?"1":"0",l=a.manage?"1":"0",n=a.auth_key||a.auth_keys;if(!c)return this._error("Missing Callback");if(!this._keychain.getSubscribeKey())return this._error("Missing Subscribe Key");if(!this._keychain.getPublishKey())return this._error("Missing Publish Key");if(!this._keychain.getSecretKey())return this._error("Missing Secret Key");var o=Math.floor((new Date).getTime()/1e3),p=this._keychain.getSubscribeKey()+"\n"+this._keychain.getPublishKey()+"\ngrant\n",q={w:j,r:i,timestamp:o};a.manage&&(q.m=l),m["default"].isArray(e)&&(e=e.join(",")),m["default"].isArray(n)&&(n=n.join(",")),"undefined"!=typeof e&&null!==e&&e.length>0&&(q.channel=e),"undefined"!=typeof f&&null!==f&&f.length>0&&(q["channel-group"]=f),0!==g&&(q.callback=g),(h||0===h)&&(q.ttl=h),n&&(q.auth=n),q=this._networking.prepareParams(q),n||delete q.auth,p+=m["default"]._get_pam_sign_input_from_params(q);var r=this._hmac_SHA256(p,this._keychain.getSecretKey());r=r.replace(/\+/g,"-"),r=r.replace(/\//g,"_"),q.signature=r,this._networking.performGrant({callback:g,data:q,success:function(a){k["default"].callback(a,c,d)},fail:function(a){k["default"].error(a,d)}})}},{key:"performAudit",value:function(a,b){var c=a.callback||b,d=a.error||function(){},e=a.channel,f=a.channel_group,g=a.auth_key,h=this._jsonp_cb();if(!c)return this._error("Missing Callback");if(!this._keychain.getSubscribeKey())return this._error("Missing Subscribe Key");if(!this._keychain.getPublishKey())return this._error("Missing Publish Key");if(!this._keychain.getSecretKey())return this._error("Missing Secret Key");var i=Math.floor((new Date).getTime()/1e3),j=this._keychain.getSubscribeKey()+"\n"+this._keychain.getPublishKey()+"\naudit\n",l={timestamp:i};0!==h&&(l.callback=h),"undefined"!=typeof e&&null!==e&&e.length>0&&(l.channel=e),"undefined"!=typeof f&&null!==f&&f.length>0&&(l["channel-group"]=f),g&&(l.auth=g),l=this._networking.prepareParams(l),g||delete l.auth,j+=m["default"]._get_pam_sign_input_from_params(l);var n=this._hmac_SHA256(j,this._keychain.getSecretKey());n=n.replace(/\+/g,"-"),n=n.replace(/\//g,"_"),l.signature=n,this._networking.performAudit({callback:h,data:l,success:function(a){k["default"].callback(a,c,d)},fail:function(a){k["default"].error(a,d)}})}}]),a}();b["default"]=n},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(8),h=(d(g),c(9)),i=(d(h),c(14)),j=d(i),k=function(){function a(b){var c=b.networking,d=b.keychain,f=b.jsonp_cb,g=b.error;e(this,a),this._networking=c,this._keychain=d,this._jsonp_cb=f,this._error=g}return f(a,[{key:"performReplay",value:function(a,b){var c=a.stop,d=a.start,e=a.end,f=a.reverse,g=a.limit,h=a.source,i=b||a.callback||function(){},k=a.auth_key||this._keychain.getAuthKey(),l=a.destination,m=a.error||function(){},n=this._jsonp_cb(),o={};return h?l?this._keychain.getPublishKey()?this._keychain.getSubscribeKey()?(0!==n&&(o.callback=n),c&&(o.stop="all"),f&&(o.reverse="true"),d&&(o.start=d),e&&(o.end=e),g&&(o.count=g),o.auth=k,void this._networking.fetchReplay(h,l,{callback:n,success:function(a){j["default"].callback(a,i,m)},fail:function(){i([0,"Disconnected"])},data:this._networking.prepareParams(o)})):this._error("Missing Subscribe Key"):this._error("Missing Publish Key"):this._error("Missing Destination Channel"):this._error("Missing Source Channel")}}]),a}();b["default"]=k},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(8),h=(d(g),c(9)),i=(d(h),c(12)),j=(d(i),c(14)),k=d(j),l=c(10),m=d(l),n=function(){function a(b){var c=b.networking,d=b.keychain,f=b.config,g=b.jsonp_cb,h=b.error;e(this,a),this._networking=c,this._keychain=d,this._config=f,this._jsonp_cb=g,this._error=h}return f(a,[{key:"channelGroup",value:function(a,b){var c=a.channel_group,d=a.callback||b,e=a.channels||a.channel,f="",g={},h=a.mode||"add",i=a.error||this._error,j=this._jsonp_cb();if(c){var l=c.split(":");f=l.length>1?l[1]:l[0]}e&&(m["default"].isArray(e)&&(e=e.join(",")),g[h]=e),g.auth||(g.auth=a.auth_key||this._keychain.getAuthKey()),j&&(g.callback=j),this._networking.performChannelGroupOperation(f,h,{callback:j,data:this._networking.prepareParams(g),success:function(a){k["default"].callback(a,d,i)},fail:function(a){k["default"].error(a,i)}})}},{key:"listChannels",value:function(a,b){return a.channel_group?void this.channelGroup(a,b):this._error("Missing Channel Group")}},{key:"removeGroup",value:function(a,b){var c="Use channel_group_remove_channel if you want to remove a channel from a group.";return a.channel_group?a.channel?this._error(c):(a.mode="remove",void this.channelGroup(a,b)):this._error("Missing Channel Group")}},{key:"listGroups",value:function(a,b){this.channelGroup(a,b)}},{key:"addChannel",value:function(a,b){return a.channel_group?a.channel||a.channels?void this.channelGroup(a,b):this._error("Missing Channel"):this._error("Missing Channel Group")}},{key:"removeChannel",value:function(a,b){return a.channel_group?a.channel||a.channels?(a.mode="remove",void this.channelGroup(a,b)):this._error("Missing Channel"):this._error("Missing Channel Group")}}]),a}();b["default"]=n}])});