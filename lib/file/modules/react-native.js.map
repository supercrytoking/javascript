{"version":3,"sources":["file/modules/react-native.js"],"names":["PubNubFile","config","File","data","name","mimeType","type","uri","Error","undefined","blob","Promise","resolve","reject","reader","FileReader","addEventListener","result","ArrayBuffer","error","readAsArrayBuffer","arrayBuffer","JSON","stringify","readAsBinaryString","text","Blob"],"mappings":"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","sourcesContent":["/** @flow */\n\nimport { IFile, FileClass } from '../';\n\ntype PubNubFileReactNativeConstructor =\n| File\n| {|\n    data: string,\n    name: string,\n    mimeType: string,\n  |}\n| {|\n    data: ArrayBuffer,\n    name: string,\n    mimeType: string,\n  |}\n| {|\n    uri: string,\n    name: string,\n    mimeType: string,\n  |};\n\nconst PubNubFile: FileClass = class PubNubFile implements IFile {\n  static supportsFile = typeof File !== 'undefined';\n  static supportsBlob = typeof Blob !== 'undefined';\n  static supportsArrayBuffer = typeof ArrayBuffer !== 'undefined';\n  static supportsBuffer = false;\n  static supportsStream = false;\n  static supportsString = true;\n  static supportsEncryptFile = false;\n  static supportsFileUri = true;\n\n  static create(config: PubNubFileReactNativeConstructor) {\n    return new this(config);\n  }\n\n  data: any;\n  name: string;\n  mimeType: string;\n\n  constructor(config: PubNubFileReactNativeConstructor) {\n    if (config instanceof File) {\n      this.data = config;\n\n      this.name = this.data.name;\n      this.mimeType = this.data.type;\n    } else if (config.uri) {\n      // uri upload for react native\n      this.data = {\n        uri: config.uri,\n        name: config.name,\n        type: config.mimeType\n      };\n\n      this.name = config.name;\n\n      if (config.mimeType) {\n        this.mimeType = config.mimeType;\n      }\n    } else if (config.data) {\n      this.data = config.data;\n      this.name = config.name;\n\n      if (config.mimeType) {\n        this.mimeType = config.mimeType;\n      }\n    } else {\n      throw new Error(\"Couldn't construct a file out of supplied options. URI or file data required.\");\n    }\n\n    if (this.data === undefined) {\n      throw new Error(\"Couldn't construct a file out of supplied options.\");\n    }\n\n    if (this.name === undefined) {\n      throw new Error(\"Couldn't guess filename out of the options. Please provide one.\");\n    }\n  }\n\n  async toBuffer() {\n    throw new Error('This feature is only supported in Node.js environments.');\n  }\n\n  async toStream() {\n    throw new Error('This feature is only supported in Node.js environments.');\n  }\n\n  async toBlob() {\n    if (this.data && this.data.uri) {\n      throw new Error('This file contains a file URI and does not contain the file contents.');\n    } else if (this.data instanceof File) {\n      return this.data;\n    } else {\n      // data must be a fetch response\n      return this.data.blob();\n    }\n  }\n\n  async toArrayBuffer() {\n    if (this.data && this.data.uri) {\n      throw new Error('This file contains a file URI and does not contain the file contents.');\n    } else if (this.data instanceof File) {\n      return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n\n        reader.addEventListener('load', () => {\n          if (reader.result instanceof ArrayBuffer) {\n            return resolve(reader.result);\n          }\n        });\n\n        reader.addEventListener('error', () => {\n          reject(reader.error);\n        });\n\n        reader.readAsArrayBuffer(this.data);\n      });\n    } else {\n      // data must be a fetch response\n      let result;\n\n      try {\n        result = await this.data.arrayBuffer();\n      } catch (e) {\n        throw new Error(`Unable to support toArrayBuffer in ReactNative environment: ${e}`);\n      }\n\n      return result;\n    }\n  }\n\n  async toString() {\n    if (this.data && this.data.uri) {\n      return JSON.stringify(this.data);\n    } else if (this.data instanceof File) {\n      return new Promise((resolve, reject) => {\n        const reader = new FileReader();\n\n        reader.addEventListener('load', () => {\n          if (typeof reader.result === 'string') {\n            return resolve(reader.result);\n          }\n        });\n\n        reader.addEventListener('error', () => {\n          reject(reader.error);\n        });\n\n        reader.readAsBinaryString(this.data);\n      });\n    } else {\n      // data must be a fetch response\n      return this.data.text();\n    }\n  }\n\n  async toFile() {\n    if (this.data.uri) {\n      throw new Error('This file contains a file URI and does not contain the file contents.');\n    } else if (this.data instanceof File) {\n      return this.data;\n    } else {\n      // data must be a fetch response\n      return this.data.blob();\n    }\n  }\n\n  async toFileUri() {\n    if (this.data && this.data.uri) {\n      return this.data;\n    } else {\n      throw new Error('This file does not contain a file URI');\n    }\n  }\n};\n\nexport default PubNubFile;\n"],"file":"react-native.js"}