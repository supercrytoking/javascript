(function(){
function u(){return function(){}}
window.JSON&&window.JSON.stringify||function(){function A(h){e.lastIndex=0;return e.test(h)?'"'+h.replace(e,function(v){var n=m[v];return typeof n==="string"?n:"\\u"+("0000"+v.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+h+'"'}function w(h,v){var n,x,y,V,B=i,C,j=v[h];if(j&&typeof j==="object"&&typeof j.toJSON==="function")j=j.toJSON(h);if(typeof J==="function")j=J.call(v,h,j);switch(typeof j){case "string":return A(j);case "number":return isFinite(j)?String(j):"null";case "boolean":case "null":return String(j);
case "object":if(!j)return"null";i+=G;C=[];if(Object.prototype.toString.apply(j)==="[object Array]"){V=j.length;for(n=0;n<V;n+=1)C[n]=w(n,j)||"null";y=C.length===0?"[]":i?"[\n"+i+C.join(",\n"+i)+"\n"+B+"]":"["+C.join(",")+"]";i=B;return y}if(J&&typeof J==="object"){V=J.length;for(n=0;n<V;n+=1){x=J[n];if(typeof x==="string")if(y=w(x,j))C.push(A(x)+(i?": ":":")+y)}}else for(x in j)if(Object.hasOwnProperty.call(j,x))if(y=w(x,j))C.push(A(x)+(i?": ":":")+y);y=C.length===0?"{}":i?"{\n"+i+C.join(",\n"+i)+
"\n"+B+"}":"{"+C.join(",")+"}";i=B;return y}}window.JSON||(window.JSON={});if(typeof String.prototype.toJSON!=="function")String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i,G,m={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},J;if(typeof JSON.stringify!=="function")JSON.stringify=
function(h,v,n){var x;G=i="";if(typeof n==="number")for(x=0;x<n;x+=1)G+=" ";else if(typeof n==="string")G=n;if((J=v)&&typeof v!=="function"&&(typeof v!=="object"||typeof v.length!=="number"))throw Error("JSON.stringify");return w("",{"":h})};if(typeof JSON.parse!=="function")JSON.parse=function(h){return eval("("+h+")")}}();
WebSocket=function(A,w){var e=this;A=e.url=A||"";e.protocol=w||"Sec-WebSocket-Protocol";var i=A.split("/");i={ssl:i[0]==="wss:",origin:i[2],publish_key:i[3],subscribe_key:i[4],channel:i[5]};e.CONNECTING=0;e.OPEN=1;e.CLOSING=2;e.CLOSED=3;e.CLOSE_NORMAL=1E3;e.CLOSE_GOING_AWAY=1001;e.CLOSE_PROTOCOL_ERROR=1002;e.CLOSE_UNSUPPORTED=1003;e.CLOSE_TOO_LARGE=1004;e.CLOSE_NO_STATUS=1005;e.CLOSE_ABNORMAL=1006;e.onclose=e.onerror=e.onmessage=e.onopen=e.onsend=u();e.binaryType="";e.extensions="";e.bufferedAmount=
0;e.trasnmitting=false;e.buffer=[];e.readyState=e.CONNECTING;if(!A){e.readyState=e.CLOSED;e.onclose({code:e.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:true});return e}e.e=PUBNUB.init(i);e.e.j=i;e.j=i;e.e.subscribe({restore:false,channel:i.channel,disconnect:e.onerror,reconnect:e.onopen,error:function(){e.onclose({code:e.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:false})},callback:function(G){e.onmessage({data:G})},connect:function(){e.readyState=e.OPEN;e.onopen()}})};
WebSocket.prototype.send=function(A){var w=this;w.e.publish({channel:w.e.j.channel,message:A,callback:function(e){w.onsend({data:e})}})};
window.PUBNUB||function(){function A(a){function b(){}function d(){}function f(c){h(oa(r),function(g){(g=r[g])&&c(g)})}function o(){var c;c="onLine"in navigator?navigator.onLine:1;c||K();setTimeout(o,H)}function q(){W.time(function(c){c||K();setTimeout(q,pa)})}function K(){L&&L(1)}var r={},X=0,Y=0,L=0,N=0,M=0,R=0,ha=+a.windowing||10,za=(+a.timeout||310)*H,pa=(+a.keepalive||60)*H,ia=a.publish_key||"",s=a.subscribe_key||"",qa=a.ssl?"s":"",$=a.uuid||da.get(s+"uuid")||"",S="http"+qa+"://"+(a.origin||
"pubsub.pubnub.com"),W={history:function(c,g){g=c.callback||g;var k=c.count||c.limit||100,l=c.reverse||"false",p=c.error||u(),E=c.channel,O=c.start,aa=c.end,z={},I=Z();if(!E)return m("Missing Channel");if(!g)return m("Missing Callback");if(!s)return m("Missing Subscribe Key");z.stringtoken="true";z.count=k;z.reverse=l;if(O)z.start=O;if(aa)z.end=aa;P({a:I,data:z,c:function(ea){g(ea)},b:p,url:[S,"v2","history","sub-key",s,"channel",ba(E)]})},replay:function(c){var g=g||c.callback||u(),k=c.source,l=
c.destination,p=c.stop,E=c.start,O=c.end,aa=c.reverse;c=c.limit;var z=Z(),I={};if(!k)return m("Missing Source Channel");if(!l)return m("Missing Destination Channel");if(!ia)return m("Missing Publish Key");if(!s)return m("Missing Subscribe Key");if(z!="0")I.callback=z;if(p)I.stop="all";if(aa)I.reverse="true";if(E)I.start=E;if(O)I.end=O;if(c)I.count=c;P({a:z,c:function(ea){g(ea)},b:function(){g([0,"Disconnected"])},url:[S,"v1","replay",ia,s,k,l],data:I})},time:function(c){var g=Z();P({a:g,timeout:H*
5,url:[S,"time",g],c:function(k){c(k[0])},b:function(){c(0)}})},uuid:function(c){var g="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(k){var l=Math.random()*16|0;return(k=="x"?l:l&3|8).toString(16)});c&&c(g);return g},publish:function(c,g){g=g||c.callback||u();var k=c.message,l=c.channel,p=Z();if(!k)return m("Missing Message");if(!l)return m("Missing Channel");if(!ia)return m("Missing Publish Key");if(!s)return m("Missing Subscribe Key");k=JSON.stringify(k);k=[S,"publish",ia,s,0,
ba(l),p,ba(k)];P({a:p,c:function(E){g(E)},b:function(){g([0,"Disconnected"])},url:k,data:{uuid:$}})},unsubscribe:function(c){c=c.channel;R=0;N=1;c=v((c.join?c.join(","):""+c).split(","),function(g){return g+","+g+ja}).join(",");h(c.split(","),function(g){fa&&d(g,0);r[g]=0});fa&&b()},subscribe:function(c,g){function k(D){if(D)setTimeout(l,H);else{ra=ka(S);setTimeout(function(){W.time(k)},H)}f(function(t){if(D&&t.d){t.d=0;return t.m(t.name)}if(!D&&!t.d){t.d=1;t.l(t.name)}})}function l(){var D=Z(),t=
oa(r).join(",");if(t)L=P({timeout:ea,a:D,b:function(){W.time(k)},data:{uuid:$},url:[ra,"subscribe",s,ba(t),D,R],c:function(F){if(!F)return setTimeout(l,sa);f(function(T){if(!T.f){T.f=1;T.k(T.name)}});R=!R&&N&&da.get(s)||F[1];da.set(s,F[1]);var la=function(){var T=(F.length>2?F[2]:"").split(",");return function(){var ca=T.shift()||"";return[(r[ca]||{}).a||X,(ca||Y).split(ja)[0]]}}();h(F[0],function(T){var ca=la();r[ca[1]].h&&ca[0](T,F,ca[1])});setTimeout(l,sa)}})}var p=c.channel;g=(g=g||c.callback)||
c.message;var E=c.connect||u(),O=c.reconnect||u(),aa=c.disconnect||u(),z=c.presence||0,I=c.noheresync||0,ea=c.timeout||za,sa=c.windowing||ha,Aa=c.restore,ra=ka(S);if(Aa)N=1;if(!p)return m("Missing Channel");if(!g)return m("Missing Callback");if(!s)return m("Missing Subscribe Key");h((p.join?p.join(","):""+p).split(","),function(D){var t=r[D]||{};r[Y=D]={name:D,f:t.f,d:t.d,h:1,a:X=g,k:E,l:aa,m:O};if(z){W.subscribe({channel:D+ja,callback:z});t.h||I||W.here_now({channel:D,callback:function(F){h("uuids"in
F?F.uuids:[],function(la){z({action:"join",uuid:la,timestamp:e(),occupancy:F.occupancy||1},F,D)})}})}});b=function(){K();clearTimeout(M);M=setTimeout(l,100)};if(!fa)return ta.push(b);b()},here_now:function(c,g){g=c.callback||g;var k=c.error||u(),l=c.channel,p=Z(),E={};if(!l)return m("Missing Channel");if(!g)return m("Missing Callback");if(!s)return m("Missing Subscribe Key");if(p!="0")E.callback=p;P({a:p,data:E,c:function(O){g(O)},b:k,url:[S,"v2","presence","sub_key",s,"channel",ba(l)]})},xdr:P,ready:ma,
db:da,each:h,map:v,grep:n,css:C,$:G,create:j,bind:y,supplant:x,head:V,search:J,attr:B,now:e,unique:w,events:ga,updater:i,init:A};$||($=W.uuid());da.set(s+"uuid",$);d=function(c,g){var k={uuid:$},l=ka(S),p=Z();if(!(c.indexOf(ja)>0)){if(p!="0")k.callback=p;P({i:g||qa,timeout:2E3,a:p,data:k,url:[l,"v2","presence","sub_key",s,"channel",ba(c),"leave"]})}};y("beforeunload",window,function(){f(function(c){d(c.name,1)});return true});setTimeout(o,H);setTimeout(q,pa);y("offline",window,K);y("offline",document,
K);return W}function w(){return"x"+ ++Ba+""+ +new Date}function e(){return+new Date}function i(a,b){function d(){if(o+b>e()){clearTimeout(f);f=setTimeout(d,b)}else{o=e();a()}}var f,o=0;return d}function G(a){return document.getElementById(a)}function m(a){console.error(a)}function J(a,b){var d=[];h(a.split(/\s+/),function(f){h((b||document).getElementsByTagName(f),function(o){d.push(o)})});return d}function h(a,b){if(a&&b)if(typeof a[0]!="undefined")for(var d=0,f=a.length;d<f;)b.call(a[d],a[d],d++);
else for(d in a)a.hasOwnProperty&&a.hasOwnProperty(d)&&b.call(a[d],d,a[d])}function v(a,b){var d=[];h(a||[],function(f,o){d.push(b(f,o))});return d}function n(a,b){var d=[];h(a||[],function(f){b(f)&&d.push(f)});return d}function x(a,b){return a.replace(Ca,function(d,f){return b[f]||d})}function y(a,b,d){h(a.split(","),function(f){function o(q){if(!q)q=window.event;if(!d(q)){q.cancelBubble=true;q.returnValue=false;q.preventDefault&&q.preventDefault();q.stopPropagation&&q.stopPropagation()}}if(b.addEventListener)b.addEventListener(f,
o,false);else if(b.attachEvent)b.attachEvent("on"+f,o);else b["on"+f]=o})}function V(){return J("head")[0]}function B(a,b,d){if(d)a.setAttribute(b,d);else return a&&a.getAttribute&&a.getAttribute(b)}function C(a,b){for(var d in b)if(b.hasOwnProperty(d))try{a.style[d]=b[d]+("|width|height|top|left|".indexOf(d)>0&&typeof b[d]=="number"?"px":"")}catch(f){}}function j(a){return document.createElement(a)}function Z(){return na||Q()?0:w()}function ba(a){return v(encodeURIComponent(a).split(""),function(b){return"-_.!~*'()".indexOf(b)<
0?b:"%"+b.charCodeAt(0).toString(16).toUpperCase()}).join("")}function P(a){function b(L,N){if(!q){q=1;L||X(N);d.onerror=null;clearTimeout(K);setTimeout(function(){L&&r();var M=G(o),R=M&&M.parentNode;R&&R.removeChild(M)},H)}}if(na||Q())return Da(a);var d=j("script"),f=a.a,o=w(),q=0,K=setTimeout(function(){b(1)},a.timeout||ua),r=a.b||u(),X=a.c||u();window[f]=function(L){b(0,L)};a.i||(d[va]=va);d.onerror=function(){b(1)};d.src=a.url.join(wa);if(a.data){f=[];d.src+="?";for(var Y in a.data)f.push(Y+"="+
a.data[Y]);d.src+=f.join(xa)}B(d,"id",o);V().appendChild(d);return b}function Da(a){function b(ha){if(!q){q=1;clearTimeout(X);if(f){f.onerror=f.onload=null;f.abort&&f.abort();f=null}ha&&Y()}}function d(){if(!K){K=1;clearTimeout(X);try{o=JSON.parse(f.responseText)}catch(ha){return b(1)}L(o)}}var f,o,q=0,K=0,r=a.timeout||ua,X=setTimeout(function(){b(1)},r),Y=a.b||u(),L=a.c||u();try{f=Q()||window.XDomainRequest&&new XDomainRequest||new XMLHttpRequest;f.onerror=f.onabort=function(){b(1)};f.onload=f.onloadend=
d;f.timeout=r;var N=a.url.join(wa);if(a.data){r=[];var M;N+="?";for(M in a.data)r.push(M+"="+a.data[M]);N+=r.join(xa)}f.open("GET",N,typeof(a.i==="undefined"));f.send()}catch(R){b(0);na=0;return P(a)}return b}function oa(a){var b=[];h(a,function(d,f){f.h&&b.push(d)});return b.sort()}function ma(){PUBNUB.time(e);PUBNUB.time(function(){setTimeout(function(){if(!fa){fa=1;h(ta,function(a){a()})}},H)})}function Q(){if(!ya.get)return 0;var a={id:Q.id++,send:u(),abort:function(){a.id={}},open:function(b,
d){Q[a.id]=a;ya.get(a.id,d)}};return a}var Ba=1,Ca=/{([\w\-]+)}/g,va="async",wa="/",xa="&",ua=1E4,H=1E3,ja="-pnpres",na=navigator.userAgent.indexOf("MSIE 6")==-1;window.console||(window.console=window.console||{});console.log||(console.log=console.error=(window.opera||{}).postError||u());var da=function(){var a=window.localStorage;return{get:function(b){try{if(a)return a.getItem(b);if(document.cookie.indexOf(b)==-1)return null;return((document.cookie||"").match(RegExp(b+"=([^;]+)"))||[])[1]||null}catch(d){}},
set:function(b,d){try{if(a)return a.setItem(b,d)&&0;document.cookie=b+"="+d+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(f){}}}}(),ka=function(){var a=Math.floor(Math.random()*20);return function(b){return b.indexOf("pubsub")>0&&b.replace("pubsub","ps"+(++a<20?a:a=1))||b}}(),ga={list:{},unbind:function(a){ga.g[a]=[]},bind:function(a,b){(ga.g[a]=ga.g[a]||[]).push(b)},fire:function(a,b){h(ga.g[a]||[],function(d){d(b)})}},U=G("pubnub")||{},fa=0,ta=[];PUBNUB=A({publish_key:B(U,"pub-key"),subscribe_key:B(U,
"sub-key"),ssl:!document.location.href.indexOf("https")||B(U,"ssl")=="on",origin:B(U,"origin"),uuid:B(U,"uuid")});C(U,{position:"absolute",top:-H});if("opera"in window||B(U,"flash"))U.innerHTML="<object id=pubnubs data=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=movie value=https://pubnub.a.ssl.fastly.net/pubnub.swf><param name=allowscriptaccess value=always></object>";var ya=G("pubnubs")||{};y("load",window,function(){setTimeout(ma,0)});PUBNUB.rdx=function(a,b){if(!b)return Q[a].onerror();
Q[a].responseText=unescape(b);Q[a].onload()};Q.id=H;window.jQuery&&(window.jQuery.PUBNUB=PUBNUB);typeof module!=="undefined"&&(module.exports=PUBNUB)&&ma()}();
})();
