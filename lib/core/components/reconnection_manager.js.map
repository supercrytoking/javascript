{"version":3,"sources":["core/components/reconnection_manager.js"],"names":[],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;AAYE,wBAAwD;AAAA,QAA1C,aAA0C,QAA1C,aAA0C;;AAAA;;AACtD,SAAK,cAAL,GAAsB,aAAtB;AACD;;;;mCAEc,oB,EAAgC;AAC7C,WAAK,qBAAL,GAA6B,oBAA7B;AACD;;;mCAEc;AACb,WAAK,UAAL,GAAkB,YAAY,KAAK,gBAAL,CAAsB,IAAtB,CAA2B,IAA3B,CAAZ,EAA8C,IAA9C,CAAlB;AACD;;;uCAEkB;AAAA;;AACjB,WAAK,cAAL,CAAoB,KAApB,CAA0B,UAAC,MAAD,EAAgC;AACxD,YAAI,CAAC,OAAO,KAAZ,EAAmB;AACjB,wBAAc,MAAK,UAAnB;AACA,gBAAK,qBAAL;AACD;AACF,OALD;AAMD","file":"core/components/reconnection_manager.js","sourcesContent":["import TimeEndpoints from '../endpoints/time';\nimport { StatusAnnouncement } from '../flow_interfaces';\n\ntype ReconnectionManagerArgs = {\n  timeEndpoints: TimeEndpoints\n}\n\nexport default class {\n\n  _reconnectionCallback: Function;\n  _timeEndpoints: TimeEndpoints;\n  _timeTimer: number;\n\n  constructor({ timeEndpoints }: ReconnectionManagerArgs) {\n    this._timeEndpoints = timeEndpoints;\n  }\n\n  onReconnection(reconnectionCallback: Function) {\n    this._reconnectionCallback = reconnectionCallback;\n  }\n\n  startPolling() {\n    this._timeTimer = setInterval(this._performTimeLoop.bind(this), 3000);\n  }\n\n  _performTimeLoop() {\n    this._timeEndpoints.fetch((status: StatusAnnouncement) => {\n      if (!status.error) {\n        clearInterval(this._timeTimer);\n        this._reconnectionCallback();\n      }\n    });\n  }\n\n}\n"],"sourceRoot":"/source/"}