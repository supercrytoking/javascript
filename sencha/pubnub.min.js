// Version: 3.5.3.1
(function(){
function m(){return function(){}}var p=1,v=!1,D=[],L="-pnpres",M=10,aa=310,ba=60,N=1E3,ca="/",da="&",ea=/{([\w\-]+)}/g;function fa(){return"x"+ ++p+""+ +new Date}function O(){return+new Date}var U=function(){var a=Math.floor(20*Math.random());return function(c,d){return 0<c.indexOf("pubsub.")&&c.replace("pubsub","ps"+(d?P().split("-")[0]:20>++a?a:a=1))||c}}();function ga(a,c){var d=a.join(ca),b=[];if(!c)return d;V(c,function(a,c){b.push(a+"="+W(c))});return d+="?"+b.join(da)}
function ha(a,c){function d(){f+c>O()?(clearTimeout(b),b=setTimeout(d,c)):(f=O(),a())}var b,f=0;return d}function ia(a,c){var d=[];V(a||[],function(b){c(b)&&d.push(b)});return d}function ja(a,c){return a.replace(ea,function(a,b){return c[b]||a})}function P(a){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});a&&a(c);return c}
function V(a,c){if(a&&c)if("undefined"!=typeof a[0])for(var d=0,b=a.length;d<b;)c.call(a[d],a[d],d++);else for(d in a)a.hasOwnProperty&&a.hasOwnProperty(d)&&c.call(a[d],d,a[d])}function Z(a,c){var d=[];V(a||[],function(b,a){d.push(c(b,a))});return d}function W(a){return Z(encodeURIComponent(a).split(""),function(a){return 0>"-_.!~*'()".indexOf(a)?a:"%"+a.charCodeAt(0).toString(16).toUpperCase()}).join("")}function $(a){var c=[];V(a,function(a,b){b.i&&c.push(a)});return c.sort()}
function ka(){setTimeout(function(){v||(v=1,V(D,function(a){a()}))},N)}
function la(a){function c(){}function d(a){a&&(r.g=0);!r.g&&r.length&&(r.g=1,y(r.shift()))}function b(a){var b=0;V($(z),function(g){if(g=z[g])b++,(a||m())(g)});return b}function f(){Q()||s(1);setTimeout(f,N)}function w(){x.time(function(a){a||s(1);setTimeout(w,H)})}function s(a){A&&A(a);A=null}var R=+a.windowing||M,I=(+a.timeout||aa)*N,H=(+a.keepalive||ba)*N,E=a.noleave||0,t=a.publish_key||"",h=a.subscribe_key||"",g=a.auth_key||"",k=a.ssl?"s":"",e="http"+k+"://"+(a.origin||"pubsub.pubnub.com"),J=
U(e),u=U(e),r=[],X=0,Y=0,A=0,S=0,F=0,z={},y=a.xdr,l=a.error||m(),Q=a._is_online||function(){return 1},G=a.jsonp_cb||function(){return 0},K=a.db||{get:m(),set:m()},B=a.uuid||K&&K.get(h+"uuid")||"",x={LEAVE:function(a,b){var c={uuid:B,auth:g},d=U(e),C=G();0<a.indexOf(L)||E||("0"!=C&&(c.callback=C),y({j:b||k,timeout:2E3,a:C,data:c,url:[d,"v2","presence","sub_key",h,"channel",W(a),"leave"]}))},history:function(a,b){b=a.callback||b;var c=a.count||a.limit||100,d=a.reverse||"false",e=a.error||m(),k=a.channel,
f=a.start,u=a.end,q={},n=G();if(!k)return l("Missing Channel");if(!b)return l("Missing Callback");if(!h)return l("Missing Subscribe Key");q.stringtoken="true";q.count=c;q.reverse=d;q.auth=g;n&&(q.callback=n);f&&(q.start=f);u&&(q.end=u);y({a:n,data:q,c:function(a){b(a)},b:e,url:[J,"v2","history","sub-key",h,"channel",W(k)]})},replay:function(a){var b=b||a.callback||m(),c=a.source,d=a.destination,e=a.stop,k=a.start,f=a.end,u=a.reverse;a=a.limit;var q=G(),n={};if(!c)return l("Missing Source Channel");
if(!d)return l("Missing Destination Channel");if(!t)return l("Missing Publish Key");if(!h)return l("Missing Subscribe Key");"0"!=q&&(n.callback=q);e&&(n.stop="all");u&&(n.reverse="true");k&&(n.start=k);f&&(n.end=f);a&&(n.count=a);n.auth=g;y({a:q,c:function(a){b(a)},b:function(){b([0,"Disconnected"])},url:[J,"v1","replay",t,h,c,d],data:n})},auth:function(a){g=a;c()},time:function(a){var b=G();y({a:b,data:{uuid:B,auth:g},timeout:5*N,url:[J,"time",b],c:function(b){a(b[0])},b:function(){a(0)}})},publish:function(a,
b){b=b||a.callback||m();var c=a.message,e=a.channel,k=G();if(!c)return l("Missing Message");if(!e)return l("Missing Channel");if(!t)return l("Missing Publish Key");if(!h)return l("Missing Subscribe Key");c=JSON.stringify(c);e=[J,"publish",t,h,0,W(e),k,W(c)];r.push({a:k,timeout:5*N,url:e,data:{uuid:B,auth:g},c:function(a){b(a);d(1)},b:function(){b([0,"Failed",c]);d(1)}});d()},unsubscribe:function(a){a=a.channel;F=0;S=1;a=Z((a.join?a.join(","):""+a).split(","),function(a){return a+","+a+L}).join(",");
V(a.split(","),function(a){v&&x.LEAVE(a,0);z[a]=0});c()},subscribe:function(a,d){function k(a){a?setTimeout(c,N):(J=U(e,1),u=U(e,1),setTimeout(function(){x.time(k)},N));b(function(b){if(a&&b.d)return b.d=0,b.l(b.name);a||b.d||(b.d=1,b.disconnect(b.name))})}function f(){var a=G(),d=$(z).join(",");d&&(s(),A=y({timeout:ma,a:a,b:function(){A=null;x.time(k)},data:{uuid:B,auth:g},url:[u,"subscribe",h,W(d),a,F],c:function(a){A=null;if(!a||"object"==typeof a&&"error"in a&&!a.error)return q(a),setTimeout(c,
T);F=!F&&S&&K.get(h)||a[1];b(function(a){a.f||(a.f=1,a.k(a.name))});E&&(F=1E4,E=0);K.set(h,a[1]);var g=function(){var b=(2<a.length?a[2]:Z(z,function(b){return Z(Array(a[0].length).join(",").split(","),function(){return b})}).join(",")).split(",");return function(){var a=b.shift()||Y;return[(z[a]||{}).a||X,a.split(L)[0]]}}();V(a[0],function(b){var c=g();c[0](b,a,c[1])});setTimeout(f,T)}}))}var C=a.channel;d=(d=d||a.callback)||a.message;var r=a.connect||m(),w=a.reconnect||m(),t=a.disconnect||m(),q=
a.error||m(),n=a.presence||0,H=a.noheresync||0,E=a.backfill||0,Q=a.timetoken||0,ma=a.timeout||I,T=a.windowing||R;S=a.restore;F=Q;if(!C)return l("Missing Channel");if(!d)return l("Missing Callback");if(!h)return l("Missing Subscribe Key");V((C.join?C.join(","):""+C).split(","),function(a){var b=z[a]||{};z[Y=a]={name:a,f:b.f,d:b.d,i:1,a:X=d,k:r,disconnect:t,l:w};n&&(x.subscribe({channel:a+L,callback:n}),b.i||H||x.here_now({channel:a,callback:function(b){V("uuids"in b?b.uuids:[],function(c){n({action:"join",
uuid:c,timestamp:O(),occupancy:b.occupancy||1},b,a)})}}))});c=function(){s();setTimeout(f,T)};if(!v)return D.push(c);c()},here_now:function(a,b){b=a.callback||b;var c=a.error||m(),d=a.channel,e=G(),k={uuid:B,auth:g};if(!d)return l("Missing Channel");if(!b)return l("Missing Callback");if(!h)return l("Missing Subscribe Key");"0"!=e&&(k.callback=e);y({a:e,data:k,c:function(a){b(a,d)},b:c,url:[J,"v2","presence","sub_key",h,"channel",W(d)]})},xdr:y,ready:ka,db:K,uuid:P,map:Z,each:V,"each-channel":b,grep:ia,
offline:function(){s(1)},supplant:ja,now:O,unique:fa,updater:ha};B||(B=x.uuid());K.set(h+"uuid",B);setTimeout(f,N);setTimeout(w,H);x.time(m());return x}
(function(){function a(b){function c(a){f||(f=1,clearTimeout(r),e&&(e.onerror=e.onload=null,e.abort&&e.abort(),e=null),a&&t())}function d(){if(!u){u=1;clearTimeout(r);try{response=JSON.parse(e.responseText)}catch(a){return c(1)}A(response)}}var e,f=0,u=0,r=setTimeout(function(){c(1)},E),w=b.data||{},t=b.b||m(),A=b.c||m(),s="undefined"===typeof b.j;try{e="undefined"!==typeof XDomainRequest&&new XDomainRequest||new XMLHttpRequest,e.onerror=e.onabort=function(){c(1)},e.onload=e.onloadend=d,s&&(e.timeout=
E),w.pnsdk=H,url=ga(b.url,w),e.open("GET",url,s),e.send()}catch(F){return c(0),a(b)}return c}function c(a,b,c){V(a.split(","),function(a){function d(a){a||(a=window.event);c(a)||(a.cancelBubble=!0,a.returnValue=!1,a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation())}b.addEventListener?b.addEventListener(a,d,!1):b.attachEvent?b.attachEvent("on"+a,d):b["on"+a]=d})}function d(a){console.error(a)}function b(a,b,c){if(c)a.setAttribute(b,c);else return a&&a.getAttribute&&a.getAttribute(b)}
function f(a){return document.getElementById(a)}function w(a,b){var c=[];V(a.split(/\s+/),function(a){V((b||document).getElementsByTagName(a),function(a){c.push(a)})});return c}function s(a,b){for(var c in b)if(b.hasOwnProperty(c))try{a.style[c]=b[c]+(0<"|width|height|top|left|".indexOf(c)&&"number"==typeof b[c]?"px":"")}catch(d){}}function R(a){return document.createElement(a)}function I(h){h.db=t;h.xdr=a;h.error=d;var g=la(h);g.init=I;g.$=f;g.attr=b;g.search=w;g.bind=c;g.css=s;g.create=R;c("beforeunload",
window,function(){g["each-channel"](function(a){g.LEAVE(a.name,1)});return!0});if(h.notest)return g;c("offline",window,g._reset_offline);c("offline",document,g._reset_offline);g.ready();return g}var H="PubNub-JS-Sencha/3.5.3.1",E=31E4,t=function(){var a="undefined"!=typeof localStorage&&localStorage;return{get:function(b){try{return a?a.getItem(b):-1==document.cookie.indexOf(b)?null:((document.cookie||"").match(RegExp(b+"=([^;]+)"))||[])[1]||null}catch(c){}},set:function(b,c){try{if(a)return a.setItem(b,
c)&&0;document.cookie=b+"="+c+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(d){}}}}();"undefined"!==typeof module&&(module.n=I)||"undefined"!==typeof exports&&(exports.m=I)||(PUBNUB=I)})();
(function(){var a=PUBNUB.ws=function(c,d){if(!(this instanceof a))return new a(c,d);var b=this;c=b.url=c||"";b.protocol=d||"Sec-WebSocket-Protocol";var f=c.split("/"),f={ssl:"wss:"===f[0],origin:f[2],publish_key:f[3],subscribe_key:f[4],channel:f[5]};b.CONNECTING=0;b.OPEN=1;b.CLOSING=2;b.CLOSED=3;b.CLOSE_NORMAL=1E3;b.CLOSE_GOING_AWAY=1001;b.CLOSE_PROTOCOL_ERROR=1002;b.CLOSE_UNSUPPORTED=1003;b.CLOSE_TOO_LARGE=1004;b.CLOSE_NO_STATUS=1005;b.CLOSE_ABNORMAL=1006;b.onclose=b.onerror=b.onmessage=b.onopen=
b.onsend=m();b.binaryType="";b.extensions="";b.bufferedAmount=0;b.trasnmitting=!1;b.buffer=[];b.readyState=b.CONNECTING;if(!c)return b.readyState=b.CLOSED,b.onclose({code:b.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!0}),b;b.e=PUBNUB.init(f);b.e.h=f;b.h=f;b.e.subscribe({restore:!1,channel:f.channel,disconnect:b.onerror,reconnect:b.onopen,error:function(){b.onclose({code:b.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!1})},callback:function(a){b.onmessage({data:a})},connect:function(){b.readyState=
b.OPEN;b.onopen()}})};a.prototype.send=function(a){var d=this;d.e.publish({channel:d.e.h.channel,message:a,callback:function(a){d.onsend({data:a})}})}})();
})();
