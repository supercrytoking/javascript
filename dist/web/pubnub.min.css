!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.PUBNUB=n():e.PUBNUB=n()}(this,function(){return function(e){function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n,t){"use strict";function r(e){var n,t,r=0,i=0,a=!0,o=e.timeout||f.DEF_TIMEOUT,c=e.data||{},u=e.fail||function(){},s=e.success||function(){},l=function(e,i){r||(r=1,clearTimeout(t),n&&(n.onerror=n.onload=null,n.abort&&n.abort(),n=null),e&&u(i))},h=function(){if(!i){var e;i=1,clearTimeout(t);try{e=JSON.parse(n.responseText)}catch(r){return l(1)}s(e)}};t=f.timeout(function(){l(1)},o);try{n="undefined"!=typeof XDomainRequest&&new XDomainRequest||new XMLHttpRequest,n.onerror=n.onabort=function(){l(1,n.responseText||{error:"Network Connection Error"})},n.onload=n.onloadend=h,c.pnsdk=d;var p=f.build_url(e.url,c);n.open("GET",p,a),a&&(n.timeout=o),n.send()}catch(g){l(1,{error:"XHR Failed",stacktrace:g})}return l}function i(e,n){var t=h.HmacSHA256(e,n);return t.toString(h.enc.Base64)}function a(){if(!("onLine"in navigator))return 1;try{return navigator.onLine}catch(e){return!0}}function o(e){return"sendBeacon"in navigator?navigator.sendBeacon(e):!1}function c(e){console.error(e)}function u(e){e.db=p,e.xdr=r,e.error=e.error||c,e.hmac_SHA256=i,e.crypto_obj=l(),e._is_online=a,e.sendBeacon=o,e.params={pnsdk:d};var n=function(e){return u(e)},t=f.PN_API(e);for(var s in t)t.hasOwnProperty(s)&&(n[s]=t[s]);return n.init=n,n.crypto_obj=l(),n.PNmessage=f.PNmessage,window.addEventListener("beforeunload",function(){return n["each-channel"](function(e){n.LEAVE(e.name,0)}),!0}),n.ready(),window.addEventListener("offline",n.offline),n}var s=t(1),f=t(2),l=t(38),h=t(39),d="PubNub-JS-consumer/"+s.version,p=function(){var e="undefined"!=typeof localStorage&&localStorage;return{get:function(n){try{return e?e.getItem(n):-1===document.cookie.indexOf(n)?null:((document.cookie||"").match(RegExp(n+"=([^;]+)"))||[])[1]||null}catch(t){return}},set:function(n,t){try{if(e)return e.setItem(n,t)&&0;document.cookie=n+"="+t+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(r){return}}}}();u.PNmessage=f.PNmessage,e.exports=u},function(e,n){e.exports={name:"pubnub",preferGlobal:!1,version:"4.0.0-beta1",author:"PubNub <support@pubnub.com>",description:"Publish & Subscribe Real-time Messaging with PubNub",contributors:[{name:"Stephen Blum",email:"stephen@pubnub.com"}],bin:{},scripts:{test:"grunt test --force"},main:"./node.js/pubnub.js",browser:"./modern/dist/pubnub.js",repository:{type:"git",url:"git://github.com/pubnub/javascript.git"},keywords:["cloud","publish","subscribe","websockets","comet","bosh","xmpp","real-time","messaging"],dependencies:{agentkeepalive:"~0.2",lodash:"^4.1.0",uuid:"^2.0.1"},noAnalyze:!1,devDependencies:{"babel-core":"^6.6.5","babel-eslint":"5.0.0","babel-plugin-transform-class-properties":"^6.6.0","babel-plugin-transform-flow-strip-types":"^6.6.5","babel-preset-es2015":"^6.6.0","babel-register":"^6.6.5",chai:"3.5.0",eslint:"2.2.0","eslint-config-airbnb":"6.0.2","eslint-plugin-flowtype":"2.1.0","eslint-plugin-mocha":"2.0.0","eslint-plugin-react":"4.1.0","flow-bin":"^0.22.1",gulp:"^3.9.1","gulp-babel":"^6.1.2","gulp-clean":"^0.3.2","gulp-exec":"^2.1.2","gulp-flowtype":"^0.4.9","gulp-mocha":"^2.2.0","gulp-rename":"^1.2.2","gulp-webpack":"^1.5.0","imports-loader":"0.6.5",isparta:"4.0.0","json-loader":"0.5.4",karma:"0.13.21","karma-chai":"0.1.0","karma-mocha":"^0.2.2","karma-phantomjs-launcher":"1.0.0","karma-spec-reporter":"0.0.24","load-grunt-tasks":"^3.4.1",mocha:"2.4.5","node-uuid":"1.4.7","phantomjs-prebuilt":"2.1.4",proxyquire:"1.7.4","run-sequence":"^1.1.5",sinon:"^1.17.3","uglify-js":"^2.6.2",underscore:"1.7.0",webpack:"^1.12.14","webpack-dev-server":"1.14.1"},bundleDependencies:[],license:"MIT",engine:{node:">=0.8"}}},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){return"x"+ ++H+ +new Date}function a(){G||(G=1,T.each(R,function(e){e()}))}function o(e){var n=e||{apns:{}};return n.getPubnubMessage=function(){var e={};if(Object.keys(n.apns).length){e.pn_apns={aps:{alert:n.apns.alert,badge:n.apns.badge}};for(var t in n.apns)e.pn_apns[t]=n.apns[t];var r=["badge","alert"];for(var t in r)delete e.pn_apns[r[t]]}n.gcm&&(e.pn_gcm={data:n.gcm});for(var t in n)e[t]=n[t];var i=["apns","gcm","publish","channel","callback","error"];for(var t in i)delete e[i[t]];return e},n.publish=function(){var e=n.getPubnubMessage();n.pubnub&&n.channel&&n.pubnub.publish({message:e,channel:n.channel,callback:n.callback,error:n.error})},n}function c(e){function n(e,n){return A.encrypt(e,n||E.getCipherKey())||e}function t(e,n){return A.decrypt(e,n||E.getCipherKey())||A.decrypt(e,E.getCipherKey())||e}function r(){return clearTimeout(_e),!U.getHeartbeatInterval()||U.getHeartbeatInterval()>=500||U.getHeartbeatInterval()<1||!F.generate_channel_list(!0).length&&!F.generate_channel_group_list(!0).length?void(be=!1):(be=!0,void xe.presence_heartbeat({callback:function(e){_e=T.timeout(r,U.getHeartbeatInterval()*J)},error:function(e){K&&K("Presence Heartbeat unable to reach Pubnub servers."+JSON.stringify(e)),_e=T.timeout(r,U.getHeartbeatInterval()*J)}}))}function o(){!be&&r()}function c(e){if(ve){if(!se.length)return}else{if(e&&(se.sending=0),se.sending||!se.length)return;se.sending=1}w(se.shift())}function s(e){var n=0;return T.each(F.generate_channel_group_list(),function(t){var r=F.getChannelGroup(t);r&&(n++,(e||function(){})(r))}),n}function l(e){var n=0;return T.each(F.generate_channel_list(),function(t){var r=F.getChannel(t);r&&(n++,(e||function(){})(r))}),n}function d(){ke()||_(1,{error:"Offline. Please check your network settings."}),j&&clearTimeout(j),j=T.timeout(d,J)}function g(){ae&&xe.time(function(e){k(function(){},e),e||_(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."}),H&&clearTimeout(H),H=T.timeout(g,ie)})}function _(e,n){de&&de(e,n),de=null,clearTimeout(j),clearTimeout(H)}function v(e){var n=T.rnow()-fe;return n-e/1e4}function k(e,n){function t(n){if(n){var t=n/1e4,i=(T.rnow()-r)/2;fe=T.rnow()-(t+i),e&&e(fe)}}var r=T.rnow();n&&t(n)||xe.time(t)}var w=e.xdr,x=e.db||{get:function(){},set:function(){}},K=e.error||function(){},O=e.hmac_SHA256,A=e.crypto_obj||{encrypt:function(e,n){return e},decrypt:function(e,n){return e}},E=(new p["default"]).setInstanceId(f["default"].v4()).setAuthKey(e.auth_key||"").setSecretKey(e.secret_key||"").setSubscribeKey(e.subscribe_key).setPublishKey(e.publish_key).setCipherKey(e.cipher_key);E.setUUID(e.uuid||!e.unique_uuid&&x.get(E.getSubscribeKey()+"uuid")||f["default"].v4()),x.set(E.getSubscribeKey()+"uuid",E.getUUID());var U=(new y["default"]).setRequestIdConfig(e.use_request_id||!1).setPresenceTimeout(T.validateHeartbeat(e.heartbeat||e.pnexpires||0,K)).setInstanceIdConfig(e.instance_id||!1);U.setHeartbeatInterval(e.heartbeat_interval||U.getPresenceTimeout()/2-1);var j,H,F=new b["default"],X=new h["default"](e.xdr,E,e.ssl,e.origin).setCoreParams(e.params||{}),V=new S["default"]({keychain:E,config:U,networking:X}),Q=new C["default"]({keychain:E,config:U,networking:X,error:K}),$=new P["default"]({keychain:E,config:U,networking:X,error:K,state:F}),Y=new I["default"]({keychain:E,networking:X,error:K,decrypt:t}),Z=new M["default"]({keychain:E,config:U,networking:X,error:K,hmac_SHA256:O}),ee=new B["default"]({keychain:E,networking:X,error:K}),ne=new D["default"]({keychain:E,networking:X,config:U,error:K}),te=+e.windowing||z,re=(+e.timeout||L)*J,ie=(+e.keepalive||q)*J,ae=e.timecheck||0,oe=e.noleave||0,ce=e.ssl?"s":"",ue=function(){},se=[],fe=0,le=0,he=0,de=0,pe=e.restore||0,ge=0,ye=!1,_e=null,be=!1,ve=e.no_wait_for_pending,me=e["compatible_3.5"]||!1,ke=e._is_online||function(){return 1},Se=e.shutdown,we="undefined"!=typeof e.use_send_beacon?e.use_send_beacon:!0,Pe=we?e.sendBeacon:null;2===U.getPresenceTimeout()&&U.setHeartbeatInterval(1);var xe={history:function(e,n){Y.fetchHistory(e,n)},time:function(e){V.fetchTime(e)},here_now:function(e,n){$.hereNow(e,n)},where_now:function(e,n){$.whereNow(e,n)},presence_heartbeat:function(e){$.heartbeat(e)},state:function(e,n){$.performState(e,n)},grant:function(e,n){Z.performGrant(e,n)},audit:function(e,n){Z.performAudit(e,n)},mobile_gw_provision:function(e){Q.provisionDevice(e)},replay:function(e,n){ee.performReplay(e,n)},channel_group:function(e,n){ne.channelGroup(e,n)},channel_group_list_groups:function(e,n){ne.listGroups(e,n)},channel_group_remove_group:function(e,n){ne.removeGroup(e,n)},channel_group_list_channels:function(e,n){ne.listChannels(e,n)},channel_group_add_channel:function(e,n){ne.addChannel(e,n)},channel_group_remove_channel:function(e,n){ne.removeChannel(e,n)},LEAVE:function(e,n,t,r,i){var a,o,c={uuid:E.getUUID(),auth:t||E.getAuthKey()},u=X.nextOrigin(!1),r=r||function(){},s=i||function(){};if(e.indexOf(N)>0)return!0;if(me&&!ce)return!1;if(oe)return!1;if(U.isInstanceIdEnabled()&&(c.instanceid=E.getInstanceId()),a=[u,"v2","presence","sub_key",E.getSubscribeKey(),"channel",T.encode(e),"leave"],o=X.prepareParams(c),Pe){var f=T.buildURL(a,o);if(Pe(f))return r&&r({status:200,action:"leave",message:"OK",service:"Presence"}),!0}return w({blocking:n||ce,data:o,success:function(e){m["default"].callback(e,r,s)},fail:function(e){m["default"].error(e,s)},url:a}),!0},LEAVE_GROUP:function(e,n,t,r,i){var a,o,c={uuid:E.getUUID(),auth:t||E.getAuthKey()},u=X.nextOrigin(!1),r=r||function(){},s=i||function(){};if(e.indexOf(N)>0)return!0;if(me&&!ce)return!1;if(oe)return!1;if(e&&e.length>0&&(c["channel-group"]=e),U.isInstanceIdEnabled()&&(c.instanceid=E.getInstanceId()),a=[u,"v2","presence","sub_key",E.getSubscribeKey(),"channel",T.encode(","),"leave"],o=X.prepareParams(c),Pe){var f=T.buildURL(a,o);if(Pe(f))return r&&r({status:200,action:"leave",message:"OK",service:"Presence"}),!0}return w({blocking:n||ce,data:o,success:function(e){m["default"].callback(e,r,s)},fail:function(e){m["default"].error(e,s)},url:a}),!0},set_resumed:function(e){ye=e},get_cipher_key:function(){return E.getCipherKey()},set_cipher_key:function(e){E.setCipherKey(e)},raw_encrypt:function(e,t){return n(e,t)},raw_decrypt:function(e,n){return t(e,n)},get_heartbeat:function(){return U.getPresenceTimeout()},set_heartbeat:function(e,n){U.setPresenceTimeout(T.validateHeartbeat(e,U.getPresenceTimeout(),K)),U.setHeartbeatInterval(n||U.getPresenceTimeout()/2-1),2==U.getPresenceTimeout()&&U.setHeartbeatInterval(1),ue(),r()},get_heartbeat_interval:function(){return U.getHeartbeatInterval()},set_heartbeat_interval:function(e){U.setHeartbeatInterval(e),r()},get_version:function(){return W},getGcmMessageObject:function(e){return{data:e}},getApnsMessageObject:function(e){var n={aps:{badge:1,alert:""}};for(var t in e)t[n]=e[t];return n},_add_param:function(e,n){X.addCoreParam(e,n)},auth:function(e){E.setAuthKey(e),ue()},publish:function(e,t){var r=e.message;if(!r)return K("Missing Message");var i,t=t||e.callback||r.callback||e.success||function(){},a=e.channel||r.channel,o=e.auth_key||E.getAuthKey(),u=e.cipher_key,s=e.error||r.error||function(){},f=e.post||!1,l="store_in_history"in e?e.store_in_history:!0,h="push",d={uuid:E.getUUID(),auth:o};return e.prepend&&(h="unshift"),a?E.getPublishKey()?E.getSubscribeKey()?(r.getPubnubMessage&&(r=r.getPubnubMessage()),r=JSON.stringify(n(r,u)),i=[X.getStandardOrigin(),"publish",E.getPublishKey(),E.getSubscribeKey(),0,T.encode(a),0,T.encode(r)],l||(d.store="0"),U.isInstanceIdEnabled()&&(d.instanceid=E.getInstanceId()),se[h]({url:i,data:X.prepareParams(d),fail:function(e){m["default"].error(e,s),c(1)},success:function(e){m["default"].callback(e,t,s),c(1)},mode:f?"POST":"GET"}),void c()):K("Missing Subscribe Key"):K("Missing Publish Key"):K("Missing Channel")},unsubscribe:function(e,n){var t=e.channel,r=e.channel_group,i=e.auth_key||E.getAuthKey(),n=n||e.callback||function(){},a=e.error||function(){};if(ge=0,pe=1,!t&&!r)return K("Missing Channel or Channel Group");if(!E.getSubscribeKey())return K("Missing Subscribe Key");if(t){var o=T.isArray(t)?t:(""+t).split(","),c=[],u=[];if(T.each(o,function(e){F.getChannel(e)&&c.push(e)}),0==c.length)return void n({action:"leave"});T.each(c,function(e){u.push(e+N)}),T.each(c.concat(u),function(e){F.containsChannel(e)&&F.addChannel(e,0),F.isInPresenceState(e)&&F.removeFromPresenceState(e)});var s=!0;G&&(s=xe.LEAVE(c.join(","),0,i,n,a)),s||n({action:"leave"})}if(r){var f=T.isArray(r)?r:(""+r).split(","),l=[],h=[];if(T.each(f,function(e){F.getChannelGroup(e)&&l.push(e)}),0==l.length)return void n({action:"leave"});T.each(l,function(e){h.push(e+N)}),T.each(l.concat(h),function(e){F.containsChannelGroup(e)&&F.addChannelGroup(e,0),F.isInPresenceState(e)&&F.removeFromPresenceState(e)});var s=!0;G&&(s=xe.LEAVE_GROUP(l.join(","),0,i,n,a)),s||n({action:"leave"})}ue()},subscribe:function(e,n){function r(e){e?T.timeout(ue,I):(X.shiftStandardOrigin(!0),X.shiftSubscribeOrigin(!0),T.timeout(function(){xe.time(r)},J)),l(function(n){return e&&n.disconnected?(n.disconnected=0,n.reconnect(n.name)):void(e||n.disconnected||(n.disconnected=1,n.disconnect(n.name)))}),s(function(n){return e&&n.disconnected?(n.disconnected=0,n.reconnect(n.name)):void(e||n.disconnected||(n.disconnected=1,n.disconnect(n.name)))})}function i(){var e=F.generate_channel_list().join(","),n=F.generate_channel_group_list().join(",");if(e||n){e||(e=","),_();var a=X.prepareParams({uuid:E.getUUID(),auth:E.getAuthKey()});n&&(a["channel-group"]=n);var c=JSON.stringify(F.getPresenceState());c.length>2&&(a.state=JSON.stringify(F.getPresenceState())),U.getPresenceTimeout()&&(a.heartbeat=U.getPresenceTimeout()),U.isInstanceIdEnabled()&&(a.instanceid=E.getInstanceId()),o(),de=w({timeout:P,fail:function(e){e&&e.error&&e.service?(m["default"].error(e,p),r(!1)):xe.time(function(n){!n&&m["default"].error(e,p),r(n)})},data:X.prepareParams(a),url:[X.getSubscribeOrigin(),"subscribe",E.getSubscribeKey(),T.encode(e),0,ge],success:function(e){if(!e||"object"==("undefined"==typeof e?"undefined":u(e))&&"error"in e&&e.error)return p(e),T.timeout(ue,J);if(g(e[1]),ge=!ge&&pe&&x.get(E.getSubscribeKey())||e[1],l(function(e){e.connected||(e.connected=1,e.connect(e.name))}),s(function(e){e.connected||(e.connected=1,e.connect(e.name))}),ye&&!pe)return ge=0,ye=!1,x.set(E.getSubscribeKey(),0),void T.timeout(i,I);k&&(ge=1e4,k=0),x.set(E.getSubscribeKey(),e[1]);var n=function(){var n="",t="";e.length>3?(n=e[3],t=e[2]):n=e.length>2?e[2]:T.map(F.generate_channel_list(),function(n){return T.map(Array(e[0].length).join(",").split(","),function(){return n})}).join(",");var r=n.split(","),i=t?t.split(","):[];return function(){var e=r.shift()||he,n=i.shift(),t={};n?(e&&e.indexOf("-pnpres")>=0&&n.indexOf("-pnpres")<0&&(n+="-pnpres"),t=F.getChannelGroup(n)||F.getChannel(n)||{callback:function(){}}):t=F.getChannel(e);var a=[t.callback||le,e.split(N)[0]];return n&&a.push(n.split(N)[0]),a}}(),r=v(+e[1]);T.each(e[0],function(i){var a=n(),o=t(i,F.getChannel(a[1])?F.getChannel(a[1]).cipher_key:null);a[0]&&a[0](o,e,a[2]||a[1],r,a[1])}),T.timeout(i,I)}})}}var a=e.channel,c=e.channel_group,n=n||e.callback,n=n||e.message,f=e.connect||function(){},h=e.reconnect||function(){},d=e.disconnect||function(){},p=e.error||p||function(){},g=e.idle||function(){},y=e.presence||0,b=e.noheresync||0,k=e.backfill||0,S=e.timetoken||0,P=e.timeout||re,I=e.windowing||te,C=e.state,O=e.heartbeat||e.pnexpires,M=e.heartbeat_interval,A=e.restore||pe;return E.setAuthKey(e.auth_key||E.getAuthKey()),pe=A,ge=S,a||c?n?E.getSubscribeKey()?((O||0===O||M||0===M)&&xe.set_heartbeat(O,M),a&&T.each((a.join?a.join(","):""+a).split(","),function(t){var r=F.getChannel(t)||{};F.addChannel(he=t,{name:t,connected:r.connected,disconnected:r.disconnected,subscribed:1,callback:le=n,cipher_key:e.cipher_key,connect:f,disconnect:d,reconnect:h}),C&&(t in C?F.addToPresenceState(t,C[t]):F.addToPresenceState(t,C)),y&&(xe.subscribe({channel:t+N,callback:y,restore:A}),r.subscribed||b||xe.here_now({channel:t,data:X.prepareParams({uuid:E.getUUID(),auth:E.getAuthKey()}),callback:function(e){T.each("uuids"in e?e.uuids:[],function(n){y({action:"join",uuid:n,timestamp:Math.floor(T.rnow()/1e3),occupancy:e.occupancy||1},e,t)})}}))}),c&&T.each((c.join?c.join(","):""+c).split(","),function(t){var r=F.getChannelGroup(t)||{};F.addChannelGroup(t,{name:t,connected:r.connected,disconnected:r.disconnected,subscribed:1,callback:le=n,cipher_key:e.cipher_key,connect:f,disconnect:d,reconnect:h}),y&&(xe.subscribe({channel_group:t+N,callback:y,restore:A,auth_key:E.getAuthKey()}),r.subscribed||b||xe.here_now({channel_group:t,data:X.prepareParams({uuid:E.getUUID(),auth:E.getAuthKey()}),callback:function(e){T.each("uuids"in e?e.uuids:[],function(n){y({action:"join",uuid:n,timestamp:Math.floor(T.rnow()/1e3),occupancy:e.occupancy||1},e,t)})}}))}),ue=function(){_(),T.timeout(i,I)},G?void ue():R.push(ue)):K("Missing Subscribe Key"):K("Missing Callback"):K("Missing Channel")},revoke:function(e,n){e.read=!1,e.write=!1,xe.grant(e,n)},set_uuid:function(e){E.setUUID(e),ue()},get_uuid:function(){return E.getUUID()},isArray:function(e){return T.isArray(e)},get_subscribed_channels:function(){return F.generate_channel_list(!0)},stop_timers:function(){clearTimeout(j),clearTimeout(H),clearTimeout(_e)},shutdown:function(){xe.stop_timers(),Se&&Se()},xdr:w,ready:a,db:x,uuid:T.generateUUID,map:T.map,each:T.each,"each-channel":l,grep:T.grep,offline:function(){_(1,{message:"Offline. Please check your network settings."})},supplant:T.supplant,now:T.rnow,unique:i,updater:T.updater};return j=T.timeout(d,J),H=T.timeout(g,ie),_e=T.timeout(o,(U.getHeartbeatInterval()-3)*J),k(),xe}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},s=t(3),f=r(s),l=t(5),h=r(l),d=t(6),p=r(d),g=t(9),y=r(g),_=t(10),b=r(_),v=t(11),m=r(v),k=t(31),S=r(k),w=t(32),P=r(w),x=t(33),I=r(x),K=t(34),C=r(K),O=t(35),M=r(O),A=t(36),B=r(A),E=t(37),D=r(E),U=t(1),j=t(8),T=t(7),H=1,G=!1,R=[],N="-pnpres",z=10,F=15e3,L=310,q=60,J=1e3,W=U.version;e.exports={PN_API:c,unique:i,PNmessage:o,DEF_TIMEOUT:F,timeout:T.timeout,build_url:T.buildURL,each:T.each,uuid:T.generateUUID,URLBIT:j.URLBIT,grep:T.grep,supplant:T.supplant,now:T.rnow,updater:T.updater,map:T.map}},function(e,n,t){function r(e,n,t){var r=n&&t||0,i=0;for(n=n||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>i&&(n[r+i++]=s[e])});16>i;)n[r+i++]=0;return n}function i(e,n){var t=n||0,r=u;return r[e[t++]]+r[e[t++]]+r[e[t++]]+r[e[t++]]+"-"+r[e[t++]]+r[e[t++]]+"-"+r[e[t++]]+r[e[t++]]+"-"+r[e[t++]]+r[e[t++]]+"-"+r[e[t++]]+r[e[t++]]+r[e[t++]]+r[e[t++]]+r[e[t++]]+r[e[t++]]}function a(e,n,t){var r=n&&t||0,a=n||[];e=e||{};var o=void 0!==e.clockseq?e.clockseq:d,c=void 0!==e.msecs?e.msecs:(new Date).getTime(),u=void 0!==e.nsecs?e.nsecs:g+1,s=c-p+(u-g)/1e4;if(0>s&&void 0===e.clockseq&&(o=o+1&16383),(0>s||c>p)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");p=c,g=u,d=o,c+=122192928e5;var f=(1e4*(268435455&c)+u)%4294967296;a[r++]=f>>>24&255,a[r++]=f>>>16&255,a[r++]=f>>>8&255,a[r++]=255&f;var l=c/4294967296*1e4&268435455;a[r++]=l>>>8&255,a[r++]=255&l,a[r++]=l>>>24&15|16,a[r++]=l>>>16&255,a[r++]=o>>>8|128,a[r++]=255&o;for(var y=e.node||h,_=0;6>_;_++)a[r+_]=y[_];return n?n:i(a)}function o(e,n,t){var r=n&&t||0;"string"==typeof e&&(n="binary"==e?new Array(16):null,e=null),e=e||{};var a=e.random||(e.rng||c)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,n)for(var o=0;16>o;o++)n[r+o]=a[o];return n||i(a)}for(var c=t(4),u=[],s={},f=0;256>f;f++)u[f]=(f+256).toString(16).substr(1),s[u[f]]=f;var l=c(),h=[1|l[0],l[1],l[2],l[3],l[4],l[5]],d=16383&(l[6]<<8|l[7]),p=0,g=0,y=o;y.v1=a,y.v4=o,y.parse=r,y.unparse=i,e.exports=y},function(e,n){(function(n){var t;if(n.crypto&&crypto.getRandomValues){var r=new Uint8Array(16);t=function(){return crypto.getRandomValues(r),r}}if(!t){var i=new Array(16);t=function(){for(var e,n=0;16>n;n++)0===(3&n)&&(e=4294967296*Math.random()),i[n]=e>>>((3&n)<<3)&255;return i}}e.exports=t}).call(n,function(){return this}())},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),o=t(6),c=(r(o),t(7)),u=function(){function e(n,t){var r=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],a=arguments.length<=3||void 0===arguments[3]?"pubsub.pubnub.com":arguments[3];i(this,e),this._xdr=n,this._keychain=t,this._maxSubDomain=20,this._currentSubDomain=Math.floor(Math.random()*this._maxSubDomain),this._providedFQDN=(r?"https://":"http://")+a,this._coreParams={},this.shiftStandardOrigin(!1),this.shiftSubscribeOrigin(!1)}return a(e,[{key:"setCoreParams",value:function(e){return this._coreParams=e,this}},{key:"addCoreParam",value:function(e,n){this._coreParams[e]=n}},{key:"prepareParams",value:function(e){return e||(e={}),c.each(this._coreParams,function(n,t){n in e||(e[n]=t)}),e}},{key:"nextOrigin",value:function(e){if(-1===this._providedFQDN.indexOf("pubsub."))return this._providedFQDN;var n=void 0;return e?n=c.generateUUID().split("-")[0]:(this._currentSubDomain=this._currentSubDomain+1,this._currentSubDomain>=this._maxSubDomain&&(this._currentSubDomain=1),n=this._currentSubDomain.toString()),this._providedFQDN.replace("pubsub","ps"+n)}},{key:"shiftStandardOrigin",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];return this._standardOrigin=this.nextOrigin(e),this._standardOrigin}},{key:"shiftSubscribeOrigin",value:function(){var e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];return this._subscribeOrigin=this.nextOrigin(e),this._subscribeOrigin}},{key:"fetchHistory",value:function(e,n){var t=n.data,r=n.success,i=n.fail,a=[this.getStandardOrigin(),"v2","history","sub-key",this._keychain.getSubscribeKey(),"channel",c.encode(e)];this._xdr({data:t,success:r,fail:i,url:a})}},{key:"performChannelGroupOperation",value:function(e,n,t){var r=t.data,i=t.success,a=t.fail,o=[this.getStandardOrigin(),"v1","channel-registration","sub-key",this._keychain.getSubscribeKey(),"channel-group"];e&&"*"!==e&&o.push(e),"remove"===n&&o.push("remove"),this._xdr({data:r,success:i,fail:a,url:o})}},{key:"provisionDeviceForPush",value:function(e,n){var t=n.data,r=n.success,i=n.fail,a=[this.getStandardOrigin(),"v1","push","sub-key",this._keychain.getSubscribeKey(),"devices",e];this._xdr({data:t,success:r,fail:i,url:a})}},{key:"performGrant",value:function(e){var n=e.data,t=e.success,r=e.fail,i=[this.getStandardOrigin(),"v1","auth","grant","sub-key",this._keychain.getSubscribeKey()];this._xdr({data:n,success:t,fail:r,url:i})}},{key:"performHeartbeat",value:function(e,n){var t=n.data,r=n.success,i=n.fail,a=[this.getStandardOrigin(),"v2","presence","sub-key",this._keychain.getSubscribeKey(),"channel",e,"heartbeat"];this._xdr({data:t,success:r,fail:i,url:a})}},{key:"performState",value:function(e,n,t,r){var i=r.data,a=r.success,o=r.fail,u=[this.getStandardOrigin(),"v2","presence","sub-key",this._keychain.getSubscribeKey(),"channel",n];e?u.push("uuid",t,"data"):u.push("uuid",c.encode(t)),this._xdr({data:i,success:a,fail:o,url:u})}},{key:"performAudit",value:function(e){var n=e.data,t=e.success,r=e.fail,i=[this.getStandardOrigin(),"v1","auth","audit","sub-key",this._keychain.getSubscribeKey()];this._xdr({data:n,success:t,fail:r,url:i})}},{key:"fetchReplay",value:function(e,n,t){var r=t.data,i=t.success,a=t.fail,o=[this.getStandardOrigin(),"v1","replay",this._keychain.getPublishKey(),this._keychain.getSubscribeKey(),e,n];this._xdr({data:r,success:i,fail:a,url:o})}},{key:"fetchTime",value:function(e){var n=e.data,t=e.success,r=e.fail,i=[this.getStandardOrigin(),"time",0];this._xdr({data:n,success:t,fail:r,url:i})}},{key:"fetchWhereNow",value:function(e,n){var t=n.data,r=n.success,i=n.fail,a=[this.getStandardOrigin(),"v2","presence","sub_key",this._keychain.getSubscribeKey(),"uuid",c.encode(e)];this._xdr({data:t,success:r,fail:i,url:a})}},{key:"fetchHereNow",value:function(e,n,t){var r=t.data,i=t.success,a=t.fail,o=[this.getStandardOrigin(),"v2","presence","sub_key",this._keychain.getSubscribeKey()];e&&(o.push("channel"),o.push(c.encode(e))),n&&!e&&(o.push("channel"),o.push(",")),this._xdr({data:r,success:i,fail:a,url:o})}},{key:"getOrigin",value:function(){return this._providedFQDN}},{key:"getStandardOrigin",value:function(){return this._standardOrigin}},{key:"getSubscribeOrigin",value:function(){return this._subscribeOrigin}}]),e}();n["default"]=u},function(e,n){"use strict";function t(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),i=function(){function e(){t(this,e)}return r(e,[{key:"setUUID",value:function(e){return this._UUID=e,this}},{key:"setCipherKey",value:function(e){return this._cipherKey=e,this}},{key:"setSubscribeKey",value:function(e){return this._subscribeKey=e,this}},{key:"setPublishKey",value:function(e){return this._publishKey=e,this}},{key:"setAuthKey",value:function(e){return this._authKey=e,this}},{key:"setInstanceId",value:function(e){return this._instanceId=e,this}},{key:"setSecretKey",value:function(e){return this._secretKey=e,this}},{key:"getCipherKey",value:function(){return this._cipherKey}},{key:"getSubscribeKey",value:function(){return this._subscribeKey}},{key:"getPublishKey",value:function(){return this._publishKey}},{key:"getAuthKey",value:function(){return this._authKey}},{key:"getInstanceId",value:function(){return this._instanceId}},{key:"getSecretKey",value:function(){return this._secretKey}},{key:"getUUID",value:function(){return this._UUID}}]),e}();n["default"]=i},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){return+new Date}function a(e){return!!e&&"string"!=typeof e&&(Array.isArray&&Array.isArray(e)||"number"==typeof e.length)}function o(e,n){if(e&&n)if(a(e))for(var t=0,r=e.length;r>t;)n.call(e[t],e[t],t++);else for(var t in e)e.hasOwnProperty&&e.hasOwnProperty(t)&&n.call(e[t],t,e[t])}function c(e){return encodeURIComponent(e)}function u(e,n){var t=e.join(w.URLBIT),r=[];return n?(o(n,function(e,n){var t="object"===("undefined"==typeof n?"undefined":m(n))?JSON.stringify(n):n;"undefined"!=typeof n&&null!==n&&c(t).length>0&&r.push(e+"="+c(t))}),t+="?"+r.join(w.PARAMSBIT)):t}function s(e,n){var t,r=0,a=function o(){r+n>i()?(clearTimeout(t),t=setTimeout(o,n)):(r=i(),e())};return a}function f(e,n){var t=[];return o(e||[],function(e){n(e)&&t.push(e)}),t}function l(e,n){return e.replace(P,function(e,t){return n[t]||e})}function h(e,n){return"undefined"!=typeof setTimeout?setTimeout(e,n):void 0}function d(e){var n=S["default"].v4();return e&&e(n),n}function p(e,n){var t=[];return o(e||[],function(e,r){t.push(n(e,r))}),t}function g(e){return encodeURIComponent(e).replace(/[!'()*~]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function y(e){var n=[];return o(e,function(e){n.push(e)}),n}function _(e){return y(e).sort()}function b(e){var n=_(e);return p(n,function(n){return n+"="+g(e[n])}).join("&")}function v(e,n,t){var r=!1;if("undefined"==typeof e)return n;if("number"==typeof e)r=!(e>w._minimumHeartbeatInterval||0===e);else{if("boolean"==typeof e)return e?w._defaultHeartbeatInterval:0;r=!0}if(r){if(t){var i="Presence Heartbeat value invalid. Valid range ( x >";i+=w._minimumHeartbeatInterval+" or x = 0). Current Value : ",i+=n||w._minimumHeartbeatInterval,t(i)}return n||w._minimumHeartbeatInterval}return e}var m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},k=t(3),S=r(k),w=t(8),P=/{([\w\-]+)}/g;e.exports={buildURL:u,encode:c,each:o,updater:s,rnow:i,isArray:a,map:p,pamEncode:g,generateUUID:d,timeout:h,supplant:l,grep:f,_get_pam_sign_input_from_params:b,_object_to_key_list_sorted:_,_object_to_key_list:y,validateHeartbeat:v}},function(e,n){e.exports={PARAMSBIT:"&",URLBIT:"/",defaultHeartbeatInterval:30,minimumHeartbeatInterval:5}},function(e,n){"use strict";function t(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),i=function(){function e(){t(this,e),this._instanceId=!1,this._requestId=!1}return r(e,[{key:"setInstanceIdConfig",value:function(e){return this._instanceId=e,this}},{key:"setRequestIdConfig",value:function(e){return this._requestId=e,this}},{key:"setHeartbeatInterval",value:function(e){return this._heartbeatInterval=e,this}},{key:"setPresenceTimeout",value:function(e){return this._presenceTimeout=e,this}},{key:"isInstanceIdEnabled",value:function(){return this._instanceId}},{key:"isRequestIdEnabled",value:function(){return this._requestId}},{key:"getHeartbeatInterval",value:function(){return this._heartbeatInterval}},{key:"getPresenceTimeout",value:function(){return this._presenceTimeout}}]),e}();n["default"]=i},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),o=t(7),c=r(o),u=function(){function e(){i(this,e),this._channelStorage={},this._channelGroupStorage={},this._presenceState={}}return a(e,[{key:"containsChannel",value:function(e){return e in this._channelStorage}},{key:"containsChannelGroup",value:function(e){return e in this._channelGroupStorage}},{key:"getChannel",value:function(e){return this._channelStorage[e]}},{key:"getChannelGroup",value:function(e){return this._channelGroupStorage[e]}},{key:"addChannel",value:function(e,n){this._channelStorage[e]=n}},{key:"addChannelGroup",value:function(e,n){this._channelGroupStorage[e]=n}},{key:"addToPresenceState",value:function(e,n){this._presenceState[e]=n}},{key:"isInPresenceState",value:function(e){return e in this._presenceState}},{key:"removeFromPresenceState",value:function(e){delete this._presenceState[e]}},{key:"getPresenceState",value:function(){return this._presenceState}},{key:"generate_channel_list",value:function(e){var n=[];return c["default"].each(this._channelStorage,function(t,r){e?t.search("-pnpres")<0&&r.subscribed&&n.push(t):r.subscribed&&n.push(t)}),n.sort()}},{key:"generate_channel_group_list",value:function(e){var n=[];return c["default"].each(this._channelGroupStorage,function(t,r){e?t.search("-pnpres")<0&&r.subscribed&&n.push(t):r.subscribed&&n.push(t)}),n.sort()}}]),e}();n["default"]=u},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){
return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),c=t(12),u=r(c),s=function(){function e(){i(this,e)}return o(e,null,[{key:"callback",value:function(e,n,t){if("object"===("undefined"==typeof e?"undefined":a(e))){if(e.error){var r=(0,u["default"])(e,["message","payload"]);return void(t&&t(r))}if(e.payload)return void(e.next_page?n&&n(e.payload,e.next_page):n&&n(e.payload))}n&&n(e)}},{key:"error",value:function(e,n){if("object"===("undefined"==typeof e?"undefined":a(e))&&e.error){var t=(0,u["default"])(e,["message","payload"]);if(n)return n(t)}else if(n)return n(e)}}]),e}();n["default"]=s},function(e,n,t){var r=t(13),i=t(25),a=t(27),o=a(function(e,n){return null==e?{}:i(e,r(n,1))});e.exports=o},function(e,n,t){function r(e,n,t,u){u||(u=[]);for(var s=-1,f=e.length;++s<f;){var l=e[s];n>0&&c(l)&&(t||o(l)||a(l))?n>1?r(l,n-1,t,u):i(u,l):t||(u[u.length]=l)}return u}var i=t(14),a=t(15),o=t(24),c=t(16);e.exports=r},function(e,n){function t(e,n){for(var t=-1,r=n.length,i=e.length;++t<r;)e[i+t]=n[t];return e}e.exports=t},function(e,n,t){function r(e){return i(e)&&c.call(e,"callee")&&(!s.call(e,"callee")||u.call(e)==a)}var i=t(16),a="[object Arguments]",o=Object.prototype,c=o.hasOwnProperty,u=o.toString,s=o.propertyIsEnumerable;e.exports=r},function(e,n,t){function r(e){return a(e)&&i(e)}var i=t(17),a=t(23);e.exports=r},function(e,n,t){function r(e){return null!=e&&o(i(e))&&!a(e)}var i=t(18),a=t(20),o=t(22);e.exports=r},function(e,n,t){var r=t(19),i=r("length");e.exports=i},function(e,n){function t(e){return function(n){return null==n?void 0:n[e]}}e.exports=t},function(e,n,t){function r(e){var n=i(e)?u.call(e):"";return n==a||n==o}var i=t(21),a="[object Function]",o="[object GeneratorFunction]",c=Object.prototype,u=c.toString;e.exports=r},function(e,n){function t(e){var n=typeof e;return!!e&&("object"==n||"function"==n)}e.exports=t},function(e,n){function t(e){return"number"==typeof e&&e>-1&&e%1==0&&r>=e}var r=9007199254740991;e.exports=t},function(e,n){function t(e){return!!e&&"object"==typeof e}e.exports=t},function(e,n){var t=Array.isArray;e.exports=t},function(e,n,t){function r(e,n){return e=Object(e),i(n,function(n,t){return t in e&&(n[t]=e[t]),n},{})}var i=t(26);e.exports=r},function(e,n){function t(e,n,t,r){var i=-1,a=e.length;for(r&&a&&(t=e[++i]);++i<a;)t=n(t,e[i],i,e);return t}e.exports=t},function(e,n,t){function r(e,n){if("function"!=typeof e)throw new TypeError(o);return n=c(void 0===n?e.length-1:a(n),0),function(){for(var t=arguments,r=-1,a=c(t.length-n,0),o=Array(a);++r<a;)o[r]=t[n+r];switch(n){case 0:return e.call(this,o);case 1:return e.call(this,t[0],o);case 2:return e.call(this,t[0],t[1],o)}var u=Array(n+1);for(r=-1;++r<n;)u[r]=t[r];return u[n]=o,i(e,this,u)}}var i=t(28),a=t(29),o="Expected a function",c=Math.max;e.exports=r},function(e,n){function t(e,n,t){var r=t.length;switch(r){case 0:return e.call(n);case 1:return e.call(n,t[0]);case 2:return e.call(n,t[0],t[1]);case 3:return e.call(n,t[0],t[1],t[2])}return e.apply(n,t)}e.exports=t},function(e,n,t){function r(e){if(!e)return 0===e?e:0;if(e=i(e),e===a||e===-a){var n=0>e?-1:1;return n*o}var t=e%1;return e===e?t?e-t:e:0}var i=t(30),a=1/0,o=1.7976931348623157e308;e.exports=r},function(e,n,t){function r(e){if(a(e)){var n=i(e.valueOf)?e.valueOf():e;e=a(n)?n+"":n}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(c,"");var t=s.test(e);return t||f.test(e)?l(e.slice(2),t?2:8):u.test(e)?o:+e}var i=t(20),a=t(21),o=NaN,c=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,f=/^0o[0-7]+$/i,l=parseInt;e.exports=r},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),o=t(5),c=(r(o),t(9)),u=(r(c),t(6)),s=(r(u),function(){function e(n){var t=n.networking,r=n.config,a=n.keychain;i(this,e),this._networking=t,this._config=r,this._keychain=a}return a(e,[{key:"fetchTime",value:function(e){var n={uuid:this._keychain.getUUID(),auth:this._keychain.getAuthKey()};this._config.isInstanceIdEnabled()&&(n.instanceid=this._keychain.getInstanceId());var t=function(n){e(n[0])},r=function(){e(0)};this._networking.fetchTime({data:this._networking.prepareParams(n),success:t,fail:r})}}]),e}());n["default"]=s},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),o=t(5),c=(r(o),t(9)),u=(r(c),t(6)),s=(r(u),t(10)),f=(r(s),t(11)),l=r(f),h=t(7),d=r(h),p=function(){function e(n){var t=n.networking,r=n.config,a=n.keychain,o=n.state,c=n.error;i(this,e),this._networking=t,this._config=r,this._keychain=a,this._state=o,this._error=c}return a(e,[{key:"hereNow",value:function(e,n){var t=e.callback||n,r=e.error||function(){},i=e.auth_key||this._keychain.getAuthKey(),a=e.channel,o=e.channel_group,c="uuids"in e?e.uuids:!0,u=e.state,s={uuid:this._keychain.getUUID(),auth:i};return c||(s.disable_uuids=1),u&&(s.state=1),t?this._keychain.getSubscribeKey()?(o&&(s["channel-group"]=o),this._config.isInstanceIdEnabled()&&(s.instanceid=this._keychain.getInstanceId()),void this._networking.fetchHereNow(a,o,{data:this._networking.prepareParams(s),success:function(e){l["default"].callback(e,t,r)},fail:function(e){l["default"].error(e,r)}})):this._error("Missing Subscribe Key"):this._error("Missing Callback")}},{key:"whereNow",value:function(e,n){var t=e.callback||n,r=e.error||function(){},i=e.auth_key||this._keychain.getAuthKey(),a=e.uuid||this._keychain.getUUID(),o={auth:i};return t?this._keychain.getSubscribeKey()?(this._config.isInstanceIdEnabled()&&(o.instanceid=this._keychain.getInstanceId()),void this._networking.fetchWhereNow(a,{data:this._networking.prepareParams(o),success:function(e){l["default"].callback(e,t,r)},fail:function(e){l["default"].error(e,r)}})):this._error("Missing Subscribe Key"):this._error("Missing Callback")}},{key:"heartbeat",value:function(e){var n=e.callback||function(){},t=e.error||function(){},r={uuid:this._keychain.getUUID(),auth:this._keychain.getAuthKey()},i=JSON.stringify(this._state.getPresenceState());i.length>2&&(r.state=JSON.stringify(this._state.getPresenceState())),this._config.getPresenceTimeout()>0&&this._config.getPresenceTimeout()<320&&(r.heartbeat=this._config.getPresenceTimeout());var a=d["default"].encode(this._state.generate_channel_list(!0).join(",")),o=this._state.generate_channel_group_list(!0).join(",");a||(a=","),o&&(r["channel-group"]=o),this._config.isInstanceIdEnabled()&&(r.instanceid=this._keychain.getInstanceId()),this._config.isRequestIdEnabled()&&(r.requestid=d["default"].generateUUID()),this._networking.performHeartbeat(a,{data:this._networking.prepareParams(r),success:function(e){l["default"].callback(e,n,t)},fail:function(e){l["default"].error(e,t)}})}},{key:"performState",value:function(e,n){var t=e.callback||n||function(){},r=e.error||function(){},i=e.auth_key||this._keychain.getAuthKey(),a=e.state,o=e.uuid||this._keychain.getUUID(),c=e.channel,u=e.channel_group,s=this._networking.prepareParams({auth:i});return this._keychain.getSubscribeKey()?o?c||u?("undefined"!=typeof c&&this._state.getChannel(c)&&this._state.getChannel(c).subscribed&&a&&this._state.addToPresenceState(c,a),"undefined"!=typeof u&&this._state.getChannelGroup(u)&&this._state.getChannelGroup(u).subscribed&&(a&&this._state.addToPresenceState(u,a),s["channel-group"]=u,c||(c=",")),s.state=JSON.stringify(a),this._config.isInstanceIdEnabled()&&(s.instanceid=this._keychain.getInstanceId()),void this._networking.performState(a,c,o,{data:this._networking.prepareParams(s),success:function(e){l["default"].callback(e,t,r)},fail:function(e){l["default"].error(e,r)}})):this._error("Missing Channel"):this._error("Missing UUID"):this._error("Missing Subscribe Key")}}]),e}();n["default"]=p},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),c=t(5),u=(r(c),t(6)),s=(r(u),t(11)),f=r(s),l=function(){function e(n){var t=n.networking,r=n.keychain,a=n.error,o=n.decrypt;i(this,e),this._networking=t,this._keychain=r,this._error=a,this._decrypt=o}return o(e,[{key:"fetchHistory",value:function(e,n){var t=this,r=e.callback||n,i=e.count||e.limit||100,a=e.reverse||"false",o=e.error||function(){},c=e.auth_key||this._keychain.getAuthKey(),u=e.cipher_key,s=e.channel,l=e.channel_group,h=e.start,d=e.end,p=e.include_token,g=e.string_message_token||!1;if(!s&&!l)return this._error("Missing Channel");if(!r)return this._error("Missing Callback");if(!this._keychain.getSubscribeKey())return this._error("Missing Subscribe Key");var y={stringtoken:"true",count:i,reverse:a,auth:c};l&&(y["channel-group"]=l,s||(s=",")),h&&(y.start=h),d&&(y.end=d),p&&(y.include_token="true"),g&&(y.string_message_token="true"),this._networking.fetchHistory(s,{data:this._networking.prepareParams(y),success:function(e){t._handleHistoryResponse(e,o,r,p,u)},fail:function(e){f["default"].error(e,o)}})}},{key:"_handleHistoryResponse",value:function(e,n,t,r,i){if("object"===("undefined"==typeof e?"undefined":a(e))&&e.error)return void n({message:e.message,payload:e.payload});for(var o=e[0],c=[],u=0;u<o.length;u++)if(r){var s=this._decrypt(o[u].message,i),f=o[u].timetoken;try{c.push({message:JSON.parse(s),timetoken:f})}catch(l){c.push({message:s,timetoken:f})}}else{var h=this._decrypt(o[u],i);try{c.push(JSON.parse(h))}catch(l){c.push(h)}}t([c,e[1],e[2]])}}]),e}();n["default"]=l},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),o=t(5),c=(r(o),t(6)),u=(r(c),t(9)),s=(r(u),t(11)),f=r(s),l=function(){function e(n){var t=n.networking,r=n.keychain,a=n.error,o=n.config;i(this,e),this._networking=t,this._keychain=r,this._error=a,this._config=o}return a(e,[{key:"provisionDevice",value:function(e){var n=e.op,t=e.gw_type,r=e.device_id,i=e.channel,a=e.callback||function(){},o=e.auth_key||this._keychain.getAuthKey(),c=e.error||function(){};if(!r)return this._error("Missing Device ID (device_id)");if(!t)return this._error("Missing GW Type (gw_type: gcm or apns)");if(!n)return this._error("Missing GW Operation (op: add or remove)");if(!i)return this._error("Missing gw destination Channel (channel)");if(!this._keychain.getPublishKey())return this._error("Missing Publish Key");if(!this._keychain.getSubscribeKey())return this._error("Missing Subscribe Key");var u={uuid:this._keychain.getUUID(),auth:o,type:t};"add"===n?u.add=i:"remove"===n&&(u.remove=i),this._config.isInstanceIdEnabled()&&(u.instanceid=this._keychain.getInstanceId()),this._networking.provisionDeviceForPush(r,{data:u,success:function(e){f["default"].callback(e,a,c)},fail:function(e){f["default"].error(e,c)}})}}]),e}();n["default"]=l},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),o=t(5),c=(r(o),t(9)),u=(r(c),t(6)),s=(r(u),t(11)),f=r(s),l=t(7),h=r(l),d=function(){function e(n){var t=n.networking,r=n.config,a=n.keychain,o=n.error,c=n.hmac_SHA256;i(this,e),this._networking=t,this._keychain=a,this._config=r,this._error=o,this._hmac_SHA256=c}return a(e,[{key:"performGrant",value:function(e,n){var t=e.callback||n,r=e.error||function(){},i=e.channel||e.channels,a=e.channel_group,o=e.ttl,c=e.read?"1":"0",u=e.write?"1":"0",s=e.manage?"1":"0",l=e.auth_key||e.auth_keys;if(!t)return this._error("Missing Callback");if(!this._keychain.getSubscribeKey())return this._error("Missing Subscribe Key");if(!this._keychain.getPublishKey())return this._error("Missing Publish Key");if(!this._keychain.getSecretKey())return this._error("Missing Secret Key");var d=Math.floor((new Date).getTime()/1e3),p=this._keychain.getSubscribeKey()+"\n"+this._keychain.getPublishKey()+"\ngrant\n",g={w:u,r:c,timestamp:d};e.manage&&(g.m=s),h["default"].isArray(i)&&(i=i.join(",")),h["default"].isArray(l)&&(l=l.join(",")),"undefined"!=typeof i&&null!==i&&i.length>0&&(g.channel=i),"undefined"!=typeof a&&null!==a&&a.length>0&&(g["channel-group"]=a),(o||0===o)&&(g.ttl=o),l&&(g.auth=l),g=this._networking.prepareParams(g),l||delete g.auth,p+=h["default"]._get_pam_sign_input_from_params(g);var y=this._hmac_SHA256(p,this._keychain.getSecretKey());y=y.replace(/\+/g,"-"),y=y.replace(/\//g,"_"),g.signature=y,this._networking.performGrant({data:g,success:function(e){f["default"].callback(e,t,r)},fail:function(e){f["default"].error(e,r)}})}},{key:"performAudit",value:function(e,n){var t=e.callback||n,r=e.error||function(){},i=e.channel,a=e.channel_group,o=e.auth_key;if(!t)return this._error("Missing Callback");if(!this._keychain.getSubscribeKey())return this._error("Missing Subscribe Key");if(!this._keychain.getPublishKey())return this._error("Missing Publish Key");if(!this._keychain.getSecretKey())return this._error("Missing Secret Key");var c=Math.floor((new Date).getTime()/1e3),u=this._keychain.getSubscribeKey()+"\n"+this._keychain.getPublishKey()+"\naudit\n",s={timestamp:c};"undefined"!=typeof i&&null!==i&&i.length>0&&(s.channel=i),"undefined"!=typeof a&&null!==a&&a.length>0&&(s["channel-group"]=a),o&&(s.auth=o),s=this._networking.prepareParams(s),o||delete s.auth,u+=h["default"]._get_pam_sign_input_from_params(s);var l=this._hmac_SHA256(u,this._keychain.getSecretKey());l=l.replace(/\+/g,"-"),l=l.replace(/\//g,"_"),s.signature=l,this._networking.performAudit({data:s,success:function(e){f["default"].callback(e,t,r)},fail:function(e){f["default"].error(e,r)}})}}]),e}();n["default"]=d},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),o=t(5),c=(r(o),t(6)),u=(r(c),t(11)),s=r(u),f=function(){function e(n){var t=n.networking,r=n.keychain,a=n.error;i(this,e),this._networking=t,this._keychain=r,this._error=a}return a(e,[{key:"performReplay",value:function(e,n){var t=e.stop,r=e.start,i=e.end,a=e.reverse,o=e.limit,c=e.source,u=n||e.callback||function(){},f=e.auth_key||this._keychain.getAuthKey(),l=e.destination,h=e.error||function(){},d={};return c?l?this._keychain.getPublishKey()?this._keychain.getSubscribeKey()?(t&&(d.stop="all"),a&&(d.reverse="true"),r&&(d.start=r),i&&(d.end=i),o&&(d.count=o),d.auth=f,void this._networking.fetchReplay(c,l,{success:function(e){s["default"].callback(e,u,h)},fail:function(){u([0,"Disconnected"])},data:this._networking.prepareParams(d)})):this._error("Missing Subscribe Key"):this._error("Missing Publish Key"):this._error("Missing Destination Channel"):this._error("Missing Source Channel")}}]),e}();n["default"]=f},function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),o=t(5),c=(r(o),t(6)),u=(r(c),t(9)),s=(r(u),t(11)),f=r(s),l=t(7),h=r(l),d=function(){function e(n){var t=n.networking,r=n.keychain,a=n.config,o=n.error;i(this,e),this._networking=t,this._keychain=r,this._config=a,this._error=o}return a(e,[{key:"channelGroup",value:function(e,n){var t=e.channel_group,r=e.callback||n,i=e.channels||e.channel,a="",o={},c=e.mode||"add",u=e.error||this._error;if(t){var s=t.split(":");a=s.length>1?s[1]:s[0]}i&&(h["default"].isArray(i)&&(i=i.join(",")),o[c]=i),o.auth||(o.auth=e.auth_key||this._keychain.getAuthKey()),this._networking.performChannelGroupOperation(a,c,{data:this._networking.prepareParams(o),success:function(e){f["default"].callback(e,r,u)},fail:function(e){f["default"].error(e,u)}})}},{key:"listChannels",value:function(e,n){return e.channel_group?void this.channelGroup(e,n):this._error("Missing Channel Group")}},{key:"removeGroup",value:function(e,n){var t="Use channel_group_remove_channel if you want to remove a channel from a group.";return e.channel_group?e.channel?this._error(t):(e.mode="remove",void this.channelGroup(e,n)):this._error("Missing Channel Group")}},{key:"listGroups",value:function(e,n){this.channelGroup(e,n)}},{key:"addChannel",value:function(e,n){return e.channel_group?e.channel||e.channels?void this.channelGroup(e,n):this._error("Missing Channel"):this._error("Missing Channel Group")}},{key:"removeChannel",value:function(e,n){return e.channel_group?e.channel||e.channels?(e.mode="remove",void this.channelGroup(e,n)):this._error("Missing Channel"):this._error("Missing Channel Group")}}]),e}();n["default"]=d},function(e,n,t){function r(){function e(e){return i.SHA256(e).toString(i.enc.Hex)}function n(e){return e=e||{},e.hasOwnProperty("encryptKey")||(e.encryptKey=l.encryptKey),e.hasOwnProperty("keyEncoding")||(e.keyEncoding=l.keyEncoding),e.hasOwnProperty("keyLength")||(e.keyLength=l.keyLength),e.hasOwnProperty("mode")||(e.mode=l.mode),-1==u.indexOf(e.keyEncoding.toLowerCase())&&(e.keyEncoding=l.keyEncoding),-1==s.indexOf(parseInt(e.keyLength,10))&&(e.keyLength=l.keyLength),-1==f.indexOf(e.mode.toLowerCase())&&(e.mode=l.mode),e}function t(e,n){return"base64"===n.keyEncoding?i.enc.Base64.parse(e):"hex"===n.keyEncoding?i.enc.Hex.parse(e):e}function r(n,r){return n=t(n,r),r.encryptKey?i.enc.Utf8.parse(e(n).slice(0,32)):n}function a(e){return"ecb"===e.mode?i.mode.ECB:i.mode.CBC}function o(e){return"cbc"===e.mode?i.enc.Utf8.parse(c):null}var c="0123456789012345",u=["hex","utf8","base64","binary"],s=[128,256],f=["ecb","cbc"],l={encryptKey:!0,keyEncoding:"utf8",keyLength:256,mode:"cbc"};return{encrypt:function(e,t,c){if(!t)return e;c=n(c);var u=o(c),s=a(c),f=r(t,c),l=JSON.stringify(e),h=i.AES.encrypt(l,f,{iv:u,mode:s}).ciphertext,d=h.toString(i.enc.Base64);return d||e},decrypt:function(e,t,c){if(!t)return e;c=n(c);var u=o(c),s=a(c),f=r(t,c);try{var l=i.enc.Base64.parse(e),h=i.AES.decrypt({ciphertext:l},f,{iv:u,mode:s}).toString(i.enc.Utf8),d=JSON.parse(h);return d}catch(p){return}}}}var i=t(39);e.exports=r},function(e,n){var t=t||function(e,n){var t={},r=t.lib={},i=function(){},a=r.Base={extend:function(e){i.prototype=this;var n=new i;return e&&n.mixIn(e),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var n in e)e.hasOwnProperty(n)&&(this[n]=e[n]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=t!=n?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var n=this.words,t=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var i=0;e>i;i++)n[r+i>>>2]|=(t[i>>>2]>>>24-8*(i%4)&255)<<24-8*((r+i)%4);else if(65535<t.length)for(i=0;e>i;i+=4)n[r+i>>>2]=t[i>>>2];else n.push.apply(n,t);return this.sigBytes+=e,this},clamp:function(){var n=this.words,t=this.sigBytes;n[t>>>2]&=4294967295<<32-8*(t%4),n.length=e.ceil(t/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(n){for(var t=[],r=0;n>r;r+=4)t.push(4294967296*e.random()|0);return new o.init(t,n)}}),c=t.enc={},u=c.Hex={stringify:function(e){var n=e.words;e=e.sigBytes;for(var t=[],r=0;e>r;r++){var i=n[r>>>2]>>>24-8*(r%4)&255;t.push((i>>>4).toString(16)),t.push((15&i).toString(16))}return t.join("")},parse:function(e){for(var n=e.length,t=[],r=0;n>r;r+=2)t[r>>>3]|=parseInt(e.substr(r,2),16)<<24-4*(r%8);return new o.init(t,n/2)}},s=c.Latin1={stringify:function(e){var n=e.words;e=e.sigBytes;for(var t=[],r=0;e>r;r++)t.push(String.fromCharCode(n[r>>>2]>>>24-8*(r%4)&255));return t.join("")},parse:function(e){for(var n=e.length,t=[],r=0;n>r;r++)t[r>>>2]|=(255&e.charCodeAt(r))<<24-8*(r%4);return new o.init(t,n)}},f=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(s.stringify(e)))}catch(n){throw Error("Malformed UTF-8 data")}},parse:function(e){return s.parse(unescape(encodeURIComponent(e)))}},l=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(n){var t=this._data,r=t.words,i=t.sigBytes,a=this.blockSize,c=i/(4*a),c=n?e.ceil(c):e.max((0|c)-this._minBufferSize,0);if(n=c*a,i=e.min(4*n,i),n){for(var u=0;n>u;u+=a)this._doProcessBlock(r,u);u=r.splice(0,n),t.sigBytes-=i}return new o.init(u,i)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});r.Hasher=l.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(n,t){return new e.init(t).finalize(n)}},_createHmacHelper:function(e){return function(n,t){return new h.HMAC.init(e,t).finalize(n)}}});var h=t.algo={};return t}(Math);!function(e){for(var n=t,r=n.lib,i=r.WordArray,a=r.Hasher,r=n.algo,o=[],c=[],u=function(e){return 4294967296*(e-(0|e))|0},s=2,f=0;64>f;){var l;e:{l=s;for(var h=e.sqrt(l),d=2;h>=d;d++)if(!(l%d)){l=!1;break e}l=!0}l&&(8>f&&(o[f]=u(e.pow(s,.5))),c[f]=u(e.pow(s,1/3)),f++),s++}var p=[],r=r.SHA256=a.extend({_doReset:function(){this._hash=new i.init(o.slice(0))},_doProcessBlock:function(e,n){for(var t=this._hash.words,r=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],f=t[6],l=t[7],h=0;64>h;h++){if(16>h)p[h]=0|e[n+h];else{var d=p[h-15],g=p[h-2];p[h]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+p[h-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+p[h-16]}d=l+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&s^~u&f)+c[h]+p[h],g=((r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22))+(r&i^r&a^i&a),l=f,f=s,s=u,u=o+d|0,o=a,a=i,i=r,r=d+g|0}t[0]=t[0]+r|0,t[1]=t[1]+i|0,t[2]=t[2]+a|0,t[3]=t[3]+o|0,t[4]=t[4]+u|0,t[5]=t[5]+s|0,t[6]=t[6]+f|0,t[7]=t[7]+l|0},_doFinalize:function(){var n=this._data,t=n.words,r=8*this._nDataBytes,i=8*n.sigBytes;return t[i>>>5]|=128<<24-i%32,t[(i+64>>>9<<4)+14]=e.floor(r/4294967296),t[(i+64>>>9<<4)+15]=r,n.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});n.SHA256=a._createHelper(r),n.HmacSHA256=a._createHmacHelper(r)}(Math),function(){var e=t,n=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));var r=e.blockSize,i=4*r;t.sigBytes>i&&(t=e.finalize(t)),t.clamp();for(var a=this._oKey=t.clone(),o=this._iKey=t.clone(),c=a.words,u=o.words,s=0;r>s;s++)c[s]^=1549556828,u[s]^=909522486;a.sigBytes=o.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var n=this._hasher;return e=n.finalize(e),n.reset(),n.finalize(this._oKey.clone().concat(e))}})}(),function(){var e=t,n=e.lib.WordArray;e.enc.Base64={stringify:function(e){var n=e.words,t=e.sigBytes,r=this._map;e.clamp(),e=[];for(var i=0;t>i;i+=3)for(var a=(n[i>>>2]>>>24-8*(i%4)&255)<<16|(n[i+1>>>2]>>>24-8*((i+1)%4)&255)<<8|n[i+2>>>2]>>>24-8*((i+2)%4)&255,o=0;4>o&&t>i+.75*o;o++)e.push(r.charAt(a>>>6*(3-o)&63));if(n=r.charAt(64))for(;e.length%4;)e.push(n);return e.join("")},parse:function(e){var t=e.length,r=this._map,i=r.charAt(64);i&&(i=e.indexOf(i),-1!=i&&(t=i));for(var i=[],a=0,o=0;t>o;o++)if(o%4){var c=r.indexOf(e.charAt(o-1))<<2*(o%4),u=r.indexOf(e.charAt(o))>>>6-2*(o%4);i[a>>>2]|=(c|u)<<24-8*(a%4),a++}return n.create(i,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function n(e,n,t,r,i,a,o){return e=e+(n&t|~n&r)+i+o,(e<<a|e>>>32-a)+n}function r(e,n,t,r,i,a,o){return e=e+(n&r|t&~r)+i+o,(e<<a|e>>>32-a)+n}function i(e,n,t,r,i,a,o){return e=e+(n^t^r)+i+o,(e<<a|e>>>32-a)+n}function a(e,n,t,r,i,a,o){return e=e+(t^(n|~r))+i+o,(e<<a|e>>>32-a)+n}for(var o=t,c=o.lib,u=c.WordArray,s=c.Hasher,c=o.algo,f=[],l=0;64>l;l++)f[l]=4294967296*e.abs(e.sin(l+1))|0;c=c.MD5=s.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var o=0;16>o;o++){var c=t+o,u=e[c];e[c]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}var o=this._hash.words,c=e[t+0],u=e[t+1],s=e[t+2],l=e[t+3],h=e[t+4],d=e[t+5],p=e[t+6],g=e[t+7],y=e[t+8],_=e[t+9],b=e[t+10],v=e[t+11],m=e[t+12],k=e[t+13],S=e[t+14],w=e[t+15],P=o[0],x=o[1],I=o[2],K=o[3],P=n(P,x,I,K,c,7,f[0]),K=n(K,P,x,I,u,12,f[1]),I=n(I,K,P,x,s,17,f[2]),x=n(x,I,K,P,l,22,f[3]),P=n(P,x,I,K,h,7,f[4]),K=n(K,P,x,I,d,12,f[5]),I=n(I,K,P,x,p,17,f[6]),x=n(x,I,K,P,g,22,f[7]),P=n(P,x,I,K,y,7,f[8]),K=n(K,P,x,I,_,12,f[9]),I=n(I,K,P,x,b,17,f[10]),x=n(x,I,K,P,v,22,f[11]),P=n(P,x,I,K,m,7,f[12]),K=n(K,P,x,I,k,12,f[13]),I=n(I,K,P,x,S,17,f[14]),x=n(x,I,K,P,w,22,f[15]),P=r(P,x,I,K,u,5,f[16]),K=r(K,P,x,I,p,9,f[17]),I=r(I,K,P,x,v,14,f[18]),x=r(x,I,K,P,c,20,f[19]),P=r(P,x,I,K,d,5,f[20]),K=r(K,P,x,I,b,9,f[21]),I=r(I,K,P,x,w,14,f[22]),x=r(x,I,K,P,h,20,f[23]),P=r(P,x,I,K,_,5,f[24]),K=r(K,P,x,I,S,9,f[25]),I=r(I,K,P,x,l,14,f[26]),x=r(x,I,K,P,y,20,f[27]),P=r(P,x,I,K,k,5,f[28]),K=r(K,P,x,I,s,9,f[29]),I=r(I,K,P,x,g,14,f[30]),x=r(x,I,K,P,m,20,f[31]),P=i(P,x,I,K,d,4,f[32]),K=i(K,P,x,I,y,11,f[33]),I=i(I,K,P,x,v,16,f[34]),x=i(x,I,K,P,S,23,f[35]),P=i(P,x,I,K,u,4,f[36]),K=i(K,P,x,I,h,11,f[37]),I=i(I,K,P,x,g,16,f[38]),x=i(x,I,K,P,b,23,f[39]),P=i(P,x,I,K,k,4,f[40]),K=i(K,P,x,I,c,11,f[41]),I=i(I,K,P,x,l,16,f[42]),x=i(x,I,K,P,p,23,f[43]),P=i(P,x,I,K,_,4,f[44]),K=i(K,P,x,I,m,11,f[45]),I=i(I,K,P,x,w,16,f[46]),x=i(x,I,K,P,s,23,f[47]),P=a(P,x,I,K,c,6,f[48]),K=a(K,P,x,I,g,10,f[49]),I=a(I,K,P,x,S,15,f[50]),x=a(x,I,K,P,d,21,f[51]),P=a(P,x,I,K,m,6,f[52]),K=a(K,P,x,I,l,10,f[53]),I=a(I,K,P,x,b,15,f[54]),x=a(x,I,K,P,u,21,f[55]),P=a(P,x,I,K,y,6,f[56]),K=a(K,P,x,I,w,10,f[57]),I=a(I,K,P,x,p,15,f[58]),x=a(x,I,K,P,k,21,f[59]),P=a(P,x,I,K,h,6,f[60]),K=a(K,P,x,I,v,10,f[61]),I=a(I,K,P,x,s,15,f[62]),x=a(x,I,K,P,_,21,f[63]);o[0]=o[0]+P|0,o[1]=o[1]+x|0,o[2]=o[2]+I|0,o[3]=o[3]+K|0},_doFinalize:function(){var n=this._data,t=n.words,r=8*this._nDataBytes,i=8*n.sigBytes;t[i>>>5]|=128<<24-i%32;var a=e.floor(r/4294967296);for(t[(i+64>>>9<<4)+15]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8),t[(i+64>>>9<<4)+14]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),n.sigBytes=4*(t.length+1),this._process(),n=this._hash,t=n.words,r=0;4>r;r++)i=t[r],t[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return n},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}}),o.MD5=s._createHelper(c),o.HmacMD5=s._createHmacHelper(c)}(Math),function(){var e=t,n=e.lib,r=n.Base,i=n.WordArray,n=e.algo,a=n.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:n.MD5,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,n){for(var t=this.cfg,r=t.hasher.create(),a=i.create(),o=a.words,c=t.keySize,t=t.iterations;o.length<c;){u&&r.update(u);var u=r.update(e).finalize(n);r.reset();for(var s=1;t>s;s++)u=r.finalize(u),r.reset();a.concat(u)}return a.sigBytes=4*c,a}});e.EvpKDF=function(e,n,t){return a.create(t).compute(e,n)}}(),t.lib.Cipher||function(e){var n=t,r=n.lib,i=r.Base,a=r.WordArray,o=r.BufferedBlockAlgorithm,c=n.enc.Base64,u=n.algo.EvpKDF,s=r.Cipher=o.extend({cfg:i.extend(),createEncryptor:function(e,n){return this.create(this._ENC_XFORM_MODE,e,n)},createDecryptor:function(e,n){return this.create(this._DEC_XFORM_MODE,e,n)},init:function(e,n,t){this.cfg=this.cfg.extend(t),this._xformMode=e,this._key=n,this.reset()},reset:function(){o.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(n,t,r){return("string"==typeof t?g:p).encrypt(e,n,t,r)},decrypt:function(n,t,r){return("string"==typeof t?g:p).decrypt(e,n,t,r)}}}});r.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var f=n.mode={},l=function(n,t,r){var i=this._iv;i?this._iv=e:i=this._prevBlock;for(var a=0;r>a;a++)n[t+a]^=i[a]},h=(r.BlockCipherMode=i.extend({createEncryptor:function(e,n){return this.Encryptor.create(e,n)},createDecryptor:function(e,n){return this.Decryptor.create(e,n)},init:function(e,n){this._cipher=e,this._iv=n}})).extend();h.Encryptor=h.extend({processBlock:function(e,n){var t=this._cipher,r=t.blockSize;l.call(this,e,n,r),t.encryptBlock(e,n),this._prevBlock=e.slice(n,n+r)}}),h.Decryptor=h.extend({processBlock:function(e,n){var t=this._cipher,r=t.blockSize,i=e.slice(n,n+r);t.decryptBlock(e,n),l.call(this,e,n,r),this._prevBlock=i}}),f=f.CBC=h,h=(n.pad={}).Pkcs7={pad:function(e,n){for(var t=4*n,t=t-e.sigBytes%t,r=t<<24|t<<16|t<<8|t,i=[],o=0;t>o;o+=4)i.push(r);t=a.create(i,t),e.concat(t)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},r.BlockCipher=s.extend({cfg:s.cfg.extend({mode:f,padding:h}),reset:function(){s.reset.call(this);var e=this.cfg,n=e.iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var t=e.createEncryptor;else t=e.createDecryptor,this._minBufferSize=1;this._mode=t.call(e,this,n&&n.words)},_doProcessBlock:function(e,n){this._mode.processBlock(e,n)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var n=this._process(!0)}else n=this._process(!0),e.unpad(n);return n},blockSize:4
});var d=r.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(n.format={}).OpenSSL={stringify:function(e){var n=e.ciphertext;return e=e.salt,(e?a.create([1398893684,1701076831]).concat(e).concat(n):n).toString(c)},parse:function(e){e=c.parse(e);var n=e.words;if(1398893684==n[0]&&1701076831==n[1]){var t=a.create(n.slice(2,4));n.splice(0,4),e.sigBytes-=16}return d.create({ciphertext:e,salt:t})}},p=r.SerializableCipher=i.extend({cfg:i.extend({format:f}),encrypt:function(e,n,t,r){r=this.cfg.extend(r);var i=e.createEncryptor(t,r);return n=i.finalize(n),i=i.cfg,d.create({ciphertext:n,key:t,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:r.format})},decrypt:function(e,n,t,r){return r=this.cfg.extend(r),n=this._parse(n,r.format),e.createDecryptor(t,r).finalize(n.ciphertext)},_parse:function(e,n){return"string"==typeof e?n.parse(e,this):e}}),n=(n.kdf={}).OpenSSL={execute:function(e,n,t,r){return r||(r=a.random(8)),e=u.create({keySize:n+t}).compute(e,r),t=a.create(e.words.slice(n),4*t),e.sigBytes=4*n,d.create({key:e,iv:t,salt:r})}},g=r.PasswordBasedCipher=p.extend({cfg:p.cfg.extend({kdf:n}),encrypt:function(e,n,t,r){return r=this.cfg.extend(r),t=r.kdf.execute(t,e.keySize,e.ivSize),r.iv=t.iv,e=p.encrypt.call(this,e,n,t.key,r),e.mixIn(t),e},decrypt:function(e,n,t,r){return r=this.cfg.extend(r),n=this._parse(n,r.format),t=r.kdf.execute(t,e.keySize,e.ivSize,n.salt),r.iv=t.iv,p.decrypt.call(this,e,n,t.key,r)}})}(),function(){for(var e=t,n=e.lib.BlockCipher,r=e.algo,i=[],a=[],o=[],c=[],u=[],s=[],f=[],l=[],h=[],d=[],p=[],g=0;256>g;g++)p[g]=128>g?g<<1:g<<1^283;for(var y=0,_=0,g=0;256>g;g++){var b=_^_<<1^_<<2^_<<3^_<<4,b=b>>>8^255&b^99;i[y]=b,a[b]=y;var v=p[y],m=p[v],k=p[m],S=257*p[b]^16843008*b;o[y]=S<<24|S>>>8,c[y]=S<<16|S>>>16,u[y]=S<<8|S>>>24,s[y]=S,S=16843009*k^65537*m^257*v^16843008*y,f[b]=S<<24|S>>>8,l[b]=S<<16|S>>>16,h[b]=S<<8|S>>>24,d[b]=S,y?(y=v^p[p[p[k^v]]],_^=p[p[_]]):y=_=1}var w=[0,1,2,4,8,16,32,64,128,27,54],r=r.AES=n.extend({_doReset:function(){for(var e=this._key,n=e.words,t=e.sigBytes/4,e=4*((this._nRounds=t+6)+1),r=this._keySchedule=[],a=0;e>a;a++)if(t>a)r[a]=n[a];else{var o=r[a-1];a%t?t>6&&4==a%t&&(o=i[o>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o]):(o=o<<8|o>>>24,o=i[o>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o],o^=w[a/t|0]<<24),r[a]=r[a-t]^o}for(n=this._invKeySchedule=[],t=0;e>t;t++)a=e-t,o=t%4?r[a]:r[a-4],n[t]=4>t||4>=a?o:f[i[o>>>24]]^l[i[o>>>16&255]]^h[i[o>>>8&255]]^d[i[255&o]]},encryptBlock:function(e,n){this._doCryptBlock(e,n,this._keySchedule,o,c,u,s,i)},decryptBlock:function(e,n){var t=e[n+1];e[n+1]=e[n+3],e[n+3]=t,this._doCryptBlock(e,n,this._invKeySchedule,f,l,h,d,a),t=e[n+1],e[n+1]=e[n+3],e[n+3]=t},_doCryptBlock:function(e,n,t,r,i,a,o,c){for(var u=this._nRounds,s=e[n]^t[0],f=e[n+1]^t[1],l=e[n+2]^t[2],h=e[n+3]^t[3],d=4,p=1;u>p;p++)var g=r[s>>>24]^i[f>>>16&255]^a[l>>>8&255]^o[255&h]^t[d++],y=r[f>>>24]^i[l>>>16&255]^a[h>>>8&255]^o[255&s]^t[d++],_=r[l>>>24]^i[h>>>16&255]^a[s>>>8&255]^o[255&f]^t[d++],h=r[h>>>24]^i[s>>>16&255]^a[f>>>8&255]^o[255&l]^t[d++],s=g,f=y,l=_;g=(c[s>>>24]<<24|c[f>>>16&255]<<16|c[l>>>8&255]<<8|c[255&h])^t[d++],y=(c[f>>>24]<<24|c[l>>>16&255]<<16|c[h>>>8&255]<<8|c[255&s])^t[d++],_=(c[l>>>24]<<24|c[h>>>16&255]<<16|c[s>>>8&255]<<8|c[255&f])^t[d++],h=(c[h>>>24]<<24|c[s>>>16&255]<<16|c[f>>>8&255]<<8|c[255&l])^t[d++],e[n]=g,e[n+1]=y,e[n+2]=_,e[n+3]=h},keySize:8});e.AES=n._createHelper(r)}(),t.mode.ECB=function(){var e=t.lib.BlockCipherMode.extend();return e.Encryptor=e.extend({processBlock:function(e,n){this._cipher.encryptBlock(e,n)}}),e.Decryptor=e.extend({processBlock:function(e,n){this._cipher.decryptBlock(e,n)}}),e}(),e.exports=t}])});