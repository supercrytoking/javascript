{"version":3,"sources":["core/endpoints/objects/member/get.js"],"names":["endpoint","getOperation","operationConstants","PNGetMembersOperation","validateParams","_","params","channel","getURL","config","subscribeKey","utils","encodeString","getRequestTimeout","getTransactionTimeout","isAuthSupported","getAuthToken","tokenManager","getToken","prepareParams","_modules","queryParams","include","customFields","push","customUUIDFields","UUIDFields","join","totalCount","count","page","next","start","prev","end","filter","limit","sort","Object","entries","map","key","value","handleResponse","response","status","data"],"mappings":"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","sourcesContent":["/** @flow */\n\nimport type { EndpointConfig } from '../../endpoint';\nimport operationConstants from '../../../constants/operations';\nimport type { Member, PaginatedResultParams } from './member';\nimport utils from '../../../utils';\n\nexport type GetMembersParams = {\n  channel: string,\n} & PaginatedResultParams;\n\nexport type GetMembersResult = {|\n  status: 200,\n  data: Member[],\n  totalCount?: number,\n  prev?: string,\n  next?: string,\n|};\n\nconst endpoint: EndpointConfig<GetMembersParams, GetMembersResult> = {\n  getOperation: () => operationConstants.PNGetMembersOperation,\n\n  validateParams: (_, params) => {\n    if (!params?.channel) {\n      return 'UUID cannot be empty';\n    }\n  },\n\n  getURL: ({ config }, params) => `/v2/objects/${config.subscribeKey}/channels/${utils.encodeString(params.channel)}/uuids`,\n\n  getRequestTimeout: ({ config }) => config.getTransactionTimeout(),\n\n  isAuthSupported: () => true,\n\n  getAuthToken: ({ tokenManager }) => tokenManager.getToken('member'),\n\n  prepareParams: (_modules, params) => {\n    const queryParams = {};\n\n    if (params?.include) {\n      queryParams.include = [];\n\n      if (params.include?.customFields) {\n        queryParams.include.push('custom');\n      }\n\n      if (params.include?.customUUIDFields) {\n        queryParams.include.push('uuid.custom');\n      }\n\n      if (params.include?.UUIDFields ?? true) {\n        queryParams.include.push('uuid');\n      }\n\n      queryParams.include = queryParams.include.join(',');\n    }\n\n    if (params?.include?.totalCount) {\n      queryParams.count = params.include?.totalCount;\n    }\n\n    if (params?.page?.next) {\n      queryParams.start = params.page?.next;\n    }\n\n    if (params?.page?.prev) {\n      queryParams.end = params.page?.prev;\n    }\n\n    if (params?.filter) {\n      queryParams.filter = params.filter;\n    }\n\n    queryParams.limit = params?.limit ?? 100;\n\n    if (params?.sort) {\n      queryParams.sort = Object.entries(params.sort ?? {}).map(([key, value]) => {\n        if (value === 'asc' || value === 'desc') {\n          return `${key}:${value}`;\n        } else {\n          return key;\n        }\n      });\n    }\n\n    return queryParams;\n  },\n\n  handleResponse: (_, response): GetMembersResult => ({\n    status: response.status,\n    data: response.data,\n    totalCount: response.totalCount,\n    prev: response.prev,\n    next: response.next,\n  }),\n};\n\nexport default endpoint;\n"],"file":"get.js"}